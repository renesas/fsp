<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Starting Development</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed"); 
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");	
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
     }); 
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v5.8.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">
 
    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text"> 
      </span>
      <span class="right">
          &nbsp; 
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_s_t_a_r_t__d_e_v.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() { 
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body. 
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works 
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len)); 
            }
          } 
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }    
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element. 
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;  
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Starting Development </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#starting-development-introduction">Starting Development Introduction</a></li>
<li class="level1"><a href="#e2studio-user-guide">e&sup2; studio User Guide</a><ul><li class="level2"><a href="#what-is-e2studio">What is e&sup2; studio?</a></li>
<li class="level2"><a href="#e2studio-prerequisites">e&sup2; studio Prerequisites</a><ul><li class="level3"><a href="#obtaining-a-ra-mcu-kit">Obtaining an RA MCU Kit</a></li>
<li class="level3"><a href="#pc-requirements">PC Requirements</a></li>
<li class="level3"><a href="#installing-e2studio-and-fsp">Installing e&sup2; studio, platform installer and the FSP package</a></li>
<li class="level3"><a href="#choosing-a-toolchain">Choosing a Toolchain</a></li>
<li class="level3"><a href="#licensing">Licensing</a></li>
</ul>
</li>
<li class="level2"><a href="#what-is-a-project">What is a Project?</a></li>
<li class="level2"><a href="#creating-a-project">Creating a Project</a><ul><li class="level3"><a href="#creating-a-new-project">Creating a New Project</a></li>
<li class="level3"><a href="#selecting-a-board-and-toolchain">Selecting a Board and Toolchain</a></li>
<li class="level3"><a href="#selecting-flat-or-trustzone-project">Selecting Flat or Arm TrustZone Project</a></li>
<li class="level3"><a href="#selecting-a-project-template">Selecting a Project Template</a></li>
</ul>
</li>
<li class="level2"><a href="#configuring-a-project">Configuring a Project</a><ul><li class="level3"><a href="#summary-tab">Summary Tab</a></li>
<li class="level3"><a href="#configuring-the-bsp">Configuring the BSP</a></li>
<li class="level3"><a href="#configuring-clocks">Configuring Clocks</a></li>
<li class="level3"><a href="#configuring-pins">Configuring Pins</a></li>
<li class="level3"><a href="#configuring-interrupts">Configuring Interrupts from the Stacks Tab</a><ul><li class="level4"><a href="#interrupts">Creating Interrupts from the Interrupts Tab</a></li>
</ul>
</li>
<li class="level3"><a href="#viewing-event-links">Viewing Event Links</a></li>
</ul>
</li>
<li class="level2"><a href="#adding-threads-and-drivers">Adding Threads and Drivers</a><ul><li class="level3"><a href="#adding-and-configuring-hal-drivers">Adding and Configuring HAL Drivers</a></li>
<li class="level3"><a href="#adding-drivers-to-a-thread-and-configuring-the-drivers">Adding Drivers to a Thread and Configuring the Drivers</a></li>
<li class="level3"><a href="#configuring-threads">Configuring Threads</a></li>
</ul>
</li>
<li class="level2"><a href="#reviewing-and-adding-components">Reviewing and Adding Components</a></li>
<li class="level2"><a href="#writing-the-application">Writing the Application</a><ul><li class="level3"><a href="#coding-features">Coding Features</a><ul><li class="level4"><a href="#welcome-window">Welcome Window</a></li>
<li class="level4"><a href="#cheat-sheets">Cheat Sheets</a></li>
<li class="level4"><a href="#developer-assistance">Developer Assistance</a></li>
<li class="level4"><a href="#information-icon">Information Icon</a></li>
<li class="level4"><a href="#ide-help">IDE Help</a></li>
</ul>
</li>
<li class="level3"><a href="#hal-modules-in-fsp">HAL Modules in FSP: A Practical Description</a><ul><li class="level4"><a href="#introduction-to-hal-modules">Introduction to HAL Modules</a></li>
<li class="level4"><a href="#hal-drvier-api-function-call-formats">HAL Driver API Function Call Formats</a></li>
<li class="level4"><a href="#hal-driver-api-call-reference-information">HAL Driver API Call Reference Information</a></li>
</ul>
</li>
<li class="level3"><a href="#rtos-independent-applications">RTOS-Independent Applications</a></li>
<li class="level3"><a href="#rtos-applications">RTOS Applications</a></li>
<li class="level3"><a href="#additional-resources-for-application-development">Additional Resources for Application Development</a><ul><li class="level4"><a href="#example-projects">Example Projects</a></li>
<li class="level4"><a href="#quick-labs">Quick Labs</a></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><a href="#debugging-the-project">Debugging the Project</a></li>
<li class="level2"><a href="#modifying-toolchain-settings">Modifying Toolchain Settings</a></li>
<li class="level2"><a href="#creating-ra-project-with-arm-compiler-6-in-e2-studio">Creating RA project with Arm Compiler 6 in e&sup2; studio</a></li>
<li class="level2"><a href="#importing-an-existing-project-into-e2-studio">Importing an Existing Project into e&sup2; studio</a></li>
<li class="level2"><a href="#using-semihosting-in-a-project">Using Semihosting in a Project</a></li>
</ul>
</li>
<li class="level1"><a href="#tutorial-your-first-ra-mcu-project-blinky">Tutorial: Your First RA MCU Project - Blinky</a><ul><li class="level2"><a href="#tutorial-blinky">Tutorial Blinky</a></li>
<li class="level2"><a href="#what-does-blinky-do">What Does Blinky Do?</a></li>
<li class="level2"><a href="#prerequisites">Prerequisites</a></li>
<li class="level2"><a href="#create-a-new-project-for-blinky">Create a New Project for Blinky</a><ul><li class="level3"><a href="#details-about-the-blinky-configuration">Details about the Blinky Configuration</a></li>
<li class="level3"><a href="#configuring-the-blinky-clocks">Configuring the Blinky Clocks</a></li>
<li class="level3"><a href="#configuring-the-blinky-pins">Configuring the Blinky Pins</a></li>
<li class="level3"><a href="#configuring-the-parameters-for-blinky-components">Configuring the Parameters for Blinky Components</a></li>
<li class="level3"><a href="#where-is-main">Where is main()?</a></li>
<li class="level3"><a href="#blinky-example-code">Blinky Example Code</a></li>
</ul>
</li>
<li class="level2"><a href="#build-the-blinky-project">Build the Blinky Project</a></li>
<li class="level2"><a href="#debug-the-blinky-project">Debug the Blinky Project</a><ul><li class="level3"><a href="#debug-prerequisites">Debug prerequisites</a></li>
<li class="level3"><a href="#debug-steps">Debug steps</a></li>
<li class="level3"><a href="#details-about-the-debug-process">Details about the Debug Process</a></li>
</ul>
</li>
<li class="level2"><a href="#run-the-blinky-project">Run the Blinky Project</a></li>
</ul>
</li>
<li class="level1"><a href="#tutorial-using-hal-drivers-programming-the-wdt">Tutorial: Using HAL Drivers - Programming the WDT</a><ul><li class="level2"><a href="#application-wdt">Application WDT</a></li>
<li class="level2"><a href="#creating-a-wdt-application-using-the-ra-fsp-and-e2-studio">Creating a WDT Application Using the RA MCU FSP and e&sup2; studio</a><ul><li class="level3"><a href="#using-the-fsp-and-e2-studio">Using FSP and e&sup2; studio</a></li>
<li class="level3"><a href="#the-wdt-application">The WDT Application</a></li>
<li class="level3"><a href="#wdt-application-flow">WDT Application flow</a></li>
</ul>
</li>
<li class="level2"><a href="#creating-the-project-with-e2-studio">Creating the Project with e&sup2; studio</a></li>
<li class="level2"><a href="#configuring-the-project-with-e2-studio">Configuring the Project with e&sup2; studio</a><ul><li class="level3"><a href="#bsp-tab">BSP Tab</a></li>
<li class="level3"><a href="#clocks-tab">Clocks Tab</a></li>
<li class="level3"><a href="#interrupts-tab">Interrupts Tab</a></li>
<li class="level3"><a href="#event-links-tab">Event Links Tab</a></li>
<li class="level3"><a href="#pins-tab">Pins Tab</a></li>
<li class="level3"><a href="#stacks-tab">Stacks Tab</a></li>
<li class="level3"><a href="#components-tab">Components Tab</a></li>
</ul>
</li>
<li class="level2"><a href="#wdt-generated-project-files">WDT Generated Project Files</a><ul><li class="level3"><a href="#wdt-hal-data-h">WDT hal_data.h</a></li>
<li class="level3"><a href="#wdt-hal-data-c">WDT hal_data.c</a></li>
<li class="level3"><a href="#wdt-main-c">WDT main.c</a></li>
<li class="level3"><a href="#wdt-hal-entry-c">WDT hal_entry.c</a></li>
</ul>
</li>
<li class="level2"><a href="#building-and-testing-the-project">Building and Testing the Project</a></li>
</ul>
</li>
<li class="level1"><a href="#primer-trustzone-project-development">Primer: Arm TrustZone Project Development</a><ul><li class="level2"><a href="#target-device">Target Device</a></li>
<li class="level2"><a href="#renesas-implementation-of-arm-trustzone-technology">Renesas Implementation of Arm TrustZone Technology</a><ul><li class="level3"><a href="#calling-from-non-secure-to-secure">Calling from Non-Secure to Secure</a></li>
<li class="level3"><a href="#calling-from-secure-to-non-secure">Calling from Secure to Non-Secure</a></li>
</ul>
</li>
<li class="level2"><a href="#workflow">Workflow</a><ul><li class="level3"><a href="#secure-project">Secure Project</a></li>
<li class="level3"><a href="#non-secure-project">Non-Secure Project</a></li>
<li class="level3"><a href="#flat-project">Flat Project</a></li>
</ul>
</li>
<li class="level2"><a href="#ra-project-generator-pg">RA Project Generator (PG)</a><ul><li class="level3"><a href="#secure-project-set-up">Secure Project Set Up</a></li>
<li class="level3"><a href="#rtos-support-in-tz-project">RTOS Support in TrustZone Project</a></li>
<li class="level3"><a href="#peripheral-security-attribution">Peripheral Security Attribution</a></li>
<li class="level3"><a href="#non-secure">Non-Secure</a></li>
<li class="level3"><a href="#flat-project-type">Flat Project Type</a></li>
<li class="level3"><a href="#secure-connection-to-non-secure-project">Secure Connection to Non-Secure Project</a><ul><li class="level4"><a href="#secure-project-combined">Secure Project (Combined)</a></li>
<li class="level4"><a href="#secure-bundle-split">Secure Bundle (Split)</a></li>
</ul>
</li>
<li class="level3"><a href="#debug-configurations">Debug Configurations</a><ul><li class="level4"><a href="#non-secure-with-secure-project-combined">Non-Secure with Secure Project (Combined)</a></li>
<li class="level4"><a href="#non-secure-with-secure-bundle-split">Non-Secure with Secure Bundle (Split)</a></li>
<li class="level4"><a href="#flat-debug">Flat Debug</a></li>
</ul>
</li>
</ul>
</li>
<li class="level2"><a href="#secure-projects">Secure Projects</a><ul><li class="level3"><a href="#secure-clock">Secure Clock</a></li>
<li class="level3"><a href="#setting-drivers-as-nsc">Setting Drivers as NSC</a></li>
<li class="level3"><a href="#guard-functions">Guard Functions</a></li>
</ul>
</li>
<li class="level2"><a href="#non-secure-projects">Non-Secure projects</a><ul><li class="level3"><a href="#clock-set-up">Clock Set Up</a></li>
<li class="level3"><a href="#selecting-nsc-drivers">Selecting NSC Drivers</a></li>
<li class="level3"><a href="#locked-resources">Locked Resources</a></li>
<li class="level3"><a href="#locked-channels">Locked Channels</a></li>
</ul>
</li>
<li class="level2"><a href="#idau-registers">IDAU registers</a><ul><li class="level3"><a href="#sci-boot-mode">SCI Boot Mode</a></li>
<li class="level3"><a href="#dlm-states">DLM States</a></li>
<li class="level3"><a href="#alt-dlm-states">Devices with Alternate DLM States</a></li>
<li class="level3"><a href="#non-dlm-devices">Devices without DLM</a></li>
</ul>
</li>
<li class="level2"><a href="#debug">Debug</a><ul><li class="level3"><a href="#non-secure-debug">Non-Secure Debug</a></li>
</ul>
</li>
<li class="level2"><a href="#debugger-support">Debugger support</a></li>
<li class="level2"><a href="#third-party-ides">Third-Party IDEs</a></li>
<li class="level2"><a href="#renesas-flash-programmer-rfp">Renesas Flash Programmer (RFP)</a></li>
<li class="level2"><a href="#glossary">Glossary</a><ul><li class="level3"><a href="#configurator-icon-glossary">Configurator Icon Glossary</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#RASC-MDK-IAR-user-guide">RASC User Guide for MDK and IAR</a><ul><li class="level2"><a href="#RASC">What is RASC?</a></li>
<li class="level2"><a href="#using-ra-smart-configurator-with-keil-mdk">Using RA Smart Configurator with Keil MDK</a><ul><li class="level3"><a href="#RASC-MDK-prerequisites">Prerequisites</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-keil-mdk-create-project">Create new RA project</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-keil-mdk-modify-project">Modify existing RA project</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-keil-mdk-build-project">Build and Debug RA project</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-keil-mdk-notes-restrictions">Notes and Restrictions</a></li>
</ul>
</li>
<li class="level2"><a href="#using-ra-smart-configurator-with-ewarm">Using RA Smart Configurator with IAR EWARM</a><ul><li class="level3"><a href="#RASC-EWARM-prerequisites">Prerequisites</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-ewarm-create-project">Create new RA project</a></li>
<li class="level3"><a href="#using-ra-smart-configurator-with-ewarm-notes-restrictions">Notes and Restrictions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="starting-development-introduction"></a>
Starting Development Introduction</h1>
<p>The wealth of resources available to learn about and use e&sup2; studio and FSP can be overwhelming on first inspection, so this section provides a Starting Development Guide with a list of the most important initial steps. Following these highly recommended first 11 steps will bring you up to speed on the development environment in record time. Even experienced developers can benefit from the use of this guide, to learn the terminology that might be unfamiliar or different from previous environments.</p>
<ol type="1">
<li>Read the section <a class="el" href="_s_t_a_r_t__d_e_v.html#what-is-e2studio">What is e&sup2; studio?</a>, up to but not including <a class="el" href="_s_t_a_r_t__d_e_v.html#e2studio-prerequisites">e&sup2; studio Prerequisites</a>. This will provide a description of the various windows and views to use e&sup2; studio to create a project, add modules and threads, configure module properties, add code, and debug a project. It also describes how to use key coding 'accelerators' like Developer Assist (to drag and drop parameter populated API function calls right into your code), a context aware Autocomplete (to easily find and select from suggested enumerations, functions, types, and many other coding elements), and many other similar productivity enhancers.</li>
<li>Read the <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html">FSP Architecture</a>, <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html#fsp-modules">FSP Modules</a> and <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html#fsp-stacks">FSP Stacks</a> sections. These provide the basic background on how FSP modules and stacks are used to construct your application. Understanding their definitions and the theory behind how they combine will make it easier to develop with FSP.</li>
<li>Read a few <a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> sections to see how to use API function calls, structures, enumerations, types and callbacks. These module guides provide the information you will use to implement your project code.</li>
<li>After you have a Kit and you have downloaded and installed e&sup2; studio and FSP, you can build and debug a simple project to test your installation, tool flow, and the kit. (If you do not have a Kit or have not yet installed the development software, use the links included in the <a class="el" href="_s_t_a_r_t__d_e_v.html#e2studio-prerequisites">e&sup2; studio Prerequisites</a> for more information.) The simple <a class="el" href="_s_t_a_r_t__d_e_v.html#tutorial-your-first-ra-mcu-project-blinky">Tutorial: Your First RA MCU Project - Blinky</a> will Blink an LED on and off. Follow the instructions for importing and running this project in section <a class="el" href="_s_t_a_r_t__d_e_v.html#create-a-new-project-for-blinky">Create a New Project for Blinky</a>. It will use some of the key steps for managing projects within e&sup2; studio and is a good way to learn the basics.</li>
<li>Once you have successfully run Blinky you have a good starting point for using FSP for more complex projects. The Using HAL Drivers Tutorial, available at <a class="el" href="_s_t_a_r_t__d_e_v.html#tutorial-using-hal-drivers-programming-the-wdt">Tutorial: Using HAL Drivers - Programming the WDT</a>, shows how to create a project from scratch, using FSP API functions. Do this next.</li>
<li>Several Hands-on Quick FSP Labs are available that cover key development topics with short 15-minute Do it Yourself (DiY) activities targeting the EK-RA6M3. Topics covered include code development accelerators like Developer Assistance, Autocomplete, Help, Visual Expressions and using Example Projects. The complete list of available Quick FSP Labs can be found here: <a href="https://en-support.renesas.com/knowledgeBase/category/31087/subcategory/31090">https://en-support.renesas.com/knowledgeBase/category/31087/subcategory/31090</a>. Doing a couple of these labs provides further details on using FSP, and is also good practice. Running these labs is highly recommended.</li>
<li>The balance of the <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html">FSP Architecture</a> sections (that is, those not called out in step 2 above) contain additional reference material that may be helpful in the future. Scan them so you know what they contain, in case you need them.</li>
<li>The balance of the e&sup2; studio User Guide, starting with the <a class="el" href="_s_t_a_r_t__d_e_v.html#what-is-a-project">What is a Project?</a> section up to, but not including, <a class="el" href="_s_t_a_r_t__d_e_v.html#writing-the-application">Writing the Application</a> section, provides a detailed description of each of the key steps, windows, and entries used to create, manage, configure, build and debug a project. Much of this may be familiar after running through the tutorials and Quick Labs. However, it is important to have a good grasp of what each of the configuration tabs are used for as that is where the bulk of the project preparation work takes place prior to writing code. Skim over this section as it may help with any questions in the future.</li>
<li>Read the <a class="el" href="_s_t_a_r_t__d_e_v.html#writing-the-application">Writing the Application</a> section to get a short introduction to the steps used when creating application code with FSP. It covers both RTOS-independent and RTOS-dependent applications. It also includes a short description for several of the code accelerators you should be familiar with by now. Using additional Quick FSP Labs is a good way to become familiar with the application development process and links to them are included in the appropriate places in this section. You can find the complete list of available Quick FSP Labs here: <a href="https://en-support.renesas.com/knowledgeBase/19308277">https://en-support.renesas.com/knowledgeBase/19308277</a>.</li>
<li>Scan the <a class="el" href="_s_t_a_r_t__d_e_v.html#debugging-the-project">Debugging the Project</a> section to see the steps required to download and start a debug session.</li>
<li>Explore the additional material available on the following web pages and bookmark the resources that look most valuable to you:<ol type="a">
<li>RA Landing Page: <a href="https://www.renesas.com/ra">https://www.renesas.com/ra</a></li>
<li>FSP Landing Page: <a href="https://www.renesas.com/fsp">https://www.renesas.com/fsp</a></li>
<li>Example Projects on GitHub: <a href="https://github.com/renesas/ra-fsp-examples">https://github.com/renesas/ra-fsp-examples</a></li>
<li>Quick FSP Labs Listing: <a href="https://en-support.renesas.com/knowledgeBase/19308277">https://en-support.renesas.com/knowledgeBase/19308277</a></li>
<li>RA and FSP Knowledge Base (with articles of interest on RA and FSP): <a href="https://en-support.renesas.com/knowledgeBase/category/31087">https://en-support.renesas.com/knowledgeBase/category/31087</a></li>
<li>RA and FSP Renesas Rulz site (Community posted and answered questions): <a href="https://community.renesas.com/mcu-mpu/ra/">https://community.renesas.com/mcu-mpu/ra/</a></li>
<li>FSP Releases: <a href="https://github.com/renesas/fsp/releases">https://github.com/renesas/fsp/releases</a></li>
<li>FSP Documentation: <a href="https://renesas.github.io/fsp">https://renesas.github.io/fsp</a></li>
<li>Online Technical Support: <a href="https://www.renesas.com/us/en/support/contact.html">https://www.renesas.com/us/en/support/contact.html</a></li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="e2studio-user-guide"></a>
e² studio User Guide</h1>
<h2><a class="anchor" id="what-is-e2studio"></a>
What is e² studio?</h2>
<p>Renesas e&sup2; studio is a development tool encompassing code development, build, and debug. e&sup2; studio is based on the open-source Eclipse IDE and the associated C/C++ Development Tooling (CDT).</p>
<p>When developing for RA MCUs, e&sup2; studio hosts the Renesas Flexible Software Package (FSP). FSP provides a wide range of time saving tools to simplify the selection, configuration, and management of modules and threads, to easily implement complex applications. The time saving tools available in e&sup2; studio and FSP include the following:</p>
<ul>
<li>A Graphical User Interface (GUI) (see <a class="el" href="_s_t_a_r_t__d_e_v.html#adding-threads-and-drivers">Adding Threads and Drivers</a>) with numerous wizards for configuring and auto-generating code</li>
<li>A context sensitive Autocomplete (see <a class="el" href="_s_t_a_r_t__d_e_v.html#tutorial-using-hal-drivers-programming-the-wdt">Tutorial: Using HAL Drivers - Programming the WDT</a>) feature that provides intelligent options for completing a programming element</li>
<li>A <a class="el" href="_s_t_a_r_t__d_e_v.html#developer-assistance">Developer Assistance</a> tool for selection of and drag and drop placement of API functions directly in application code</li>
<li>A <a class="el" href="_s_t_a_r_t__d_e_v.html#welcome-window">Welcome Window</a> with links to example projects, application notes and a variety of other self-help support resources</li>
<li>An <a class="el" href="_s_t_a_r_t__d_e_v.html#information-icon">Information Icon</a> from each module is provided in the graphic configuration viewer that links to specific design resources, including code 'cheat sheets' that provide useful starting points for common application implementations.</li>
</ul>
<div class="image">
<img src="sd-splash.png" alt="sd-splash.png"/>
<div class="caption">
e&sup2; studio Splash Screen</div></div>
<p> e&sup2; studio organizes project work based on Perspectives, Views, Windows, Panes, and Pages (sometimes called Tabs). A window is a section of the e&sup2; studio GUI that presents information on a key topic. Windows often use tabs to select sub-topics. For example, an editor window might have a tab available for each open file, so it is easy to switch back and forth between them. A window Pane is a section of a window. Within a window, multiple Panes can be opened and viewed simultaneously, as opposed to a tabbed window, where only individual content is displayed. A memory-display Window, for example, might have multiple Panes that allow the data to be displayed in different formats, simultaneously. A Perspective is a collection of Views and Windows typical for a specific stage of development. The default perspectives are a C/C++ Perspective, an FSP Configuration Perspective and a Debug Perspective. These provide specific Views, Windows, Tabs, and Panes tailored for the common tasks needed during the specific development stage.</p>
<div class="image">
<img src="sd-default-perspective.png" alt="sd-default-perspective.png"/>
<div class="caption">
Default Perspective</div></div>
<p> In addition to managing project development, selecting modules, configuring them and simplifying code development, e&sup2; studio also hosts the engine for automatically generating code based on module selections and configurations. The engine continually checks for dependencies and automatically adds any needed lower level modules to the module stack. It also identifies any lower level modules that require configuration (for example, an interrupt that needs to have a priority assigned). It also provides a guide for selecting between multiple choices or options to make it easy to complete a fully functional module stack.</p>
<p>The Generate Project Content function takes the selected and configured modules and automatically generates the complete and correct configuration code. The code is added to the folders visible in the <b>Project Explorer</b> window in e&sup2; studio. The <code>configuration.xml</code> file in the project folder holds all the generated configuration settings. This file can be opened in the GUI-based RA Configuration editor to make further edits and changes. Once a project has been generated, you can go back and reconfigure any of the modules and settings if required using this editor.</p>
<div class="image">
<img src="sd-e2studio-proj-config.jpg" alt="sd-e2studio-proj-config.jpg"/>
<div class="caption">
Project Explorer Window showing generated folders and configuration.xml file</div></div>
<h2><a class="anchor" id="e2studio-prerequisites"></a>
e² studio Prerequisites</h2>
<h3><a class="anchor" id="obtaining-a-ra-mcu-kit"></a>
Obtaining an RA MCU Kit</h3>
<p>To develop applications with FSP, start with one of the Renesas RA MCU Evaluation Kits. The Renesas RA MCU Evaluation Kits are designed to seamlessly integrate with e&sup2; studio.</p>
<p>Ordering information, Quick Start Guides, User Manuals, and other related documents for all RA MCU Evaluation Kits are available at <a href="https://www.renesas.com/ra">https://www.renesas.com/ra</a>.</p>
<h3><a class="anchor" id="pc-requirements"></a>
PC Requirements</h3>
<p>The following are the minimum PC requirements to use e&sup2; studio:</p>
<ul>
<li>Windows 10 with Intel i5 or i7, or AMD A10-7850K or FX</li>
<li>Memory: 8-GB DDR3 or DDR4 DRAM (16-GB DDR4/2400-MHz RAM is preferred)</li>
<li>Minimum 250-GB hard disk</li>
</ul>
<h3><a class="anchor" id="installing-e2studio-and-fsp"></a>
Installing e² studio, platform installer and the FSP package</h3>
<p>Detailed installation instructions for e&sup2; studio and FSP are available on the Renesas website <a href="https://www.renesas.com/fsp">https://www.renesas.com/fsp</a>. Review the release notes for e&sup2; studio to ensure that the e&sup2; studio version supports the selected FSP version. The starting version of the installer includes all features of the RA MCUs.</p>
<h3><a class="anchor" id="choosing-a-toolchain"></a>
Choosing a Toolchain</h3>
<p>e&sup2; studio can work with several toolchains and toolchain versions such as the GNU Arm compiler, Arm AC6, and LLVM Embedded Toolchain for Arm. Versions of the GNU Arm and LLVM compilers verified for use with FSP are included in the e&sup2; studio installer.</p>
<h3><a class="anchor" id="licensing"></a>
Licensing</h3>
<p>FSP licensing includes full source code, limited to Renesas hardware only.</p>
<h2><a class="anchor" id="what-is-a-project"></a>
What is a Project?</h2>
<p>In e&sup2; studio, all FSP applications are organized in RA MCU projects. Setting up an RA MCU project involves:</p>
<ol type="1">
<li><a class="el" href="_s_t_a_r_t__d_e_v.html#creating-a-project">Creating a Project</a></li>
<li><a class="el" href="_s_t_a_r_t__d_e_v.html#configuring-a-project">Configuring a Project</a></li>
</ol>
<p>These steps are described in detail in the next two sections. When you have existing projects already, after you launch e&sup2; studio and select a workspace, all projects previously saved in the selected workspace are loaded and displayed in the <b>Project Explorer</b> window. Each project has an associated configuration file named <code>configuration.xml</code>, which is located in the project's root directory.</p>
<div class="image">
<img src="sd-e2studio-proj-config.jpg" alt="sd-e2studio-proj-config.jpg"/>
<div class="caption">
e&sup2; studio Project Configuration file</div></div>
<p>Double-click on the <code>configuration.xml</code> file to open the RA MCU Project Editor. To edit the project configuration, make sure that the <b>FSP Configuration</b> perspective is selected in the upper right hand corner of the e&sup2; studio window. Once selected, you can use the editor to view or modify the configuration settings associated with this project.</p>
<div class="image">
<img src="sd-e2studio-ra-config.png" alt="sd-e2studio-ra-config.png"/>
<div class="caption">
e&sup2; studio FSP Configuration Perspective</div></div>
 <dl class="section note"><dt>Note</dt><dd>Whenever the RA project configuration (that is, the <code>configuration.xml</code> file) is saved, a verbose RA Project Report file (<code>ra_cfg.txt</code>) with all the project settings is generated. The format allows differences to be easily viewed using a text comparison tool. The generated file is located in the project root directory.</dd></dl>
<div class="image">
<img src="sd-ra-mcu-proj-rpt.jpg" alt="sd-ra-mcu-proj-rpt.jpg"/>
<div class="caption">
RA Project Report</div></div>
<p> The RA Project Editor has a number of tabs. The configuration steps and options for individual tabs are discussed in the following sections.</p>
<dl class="section note"><dt>Note</dt><dd>The tabs available in the RA Project Editor depend on the e&sup2; studio version and the layout may vary slightly, however the functionality should be easy to follow..</dd></dl>
<div class="image">
<img src="sd-proj-ed-tabs.png" alt="sd-proj-ed-tabs.png"/>
<div class="caption">
RA Project Editor tabs</div></div>
<ul>
<li>Click on the YouTube icon to visit the Renesas FSP playlist on YouTube</li>
<li>Click on the Support icon to visit RA support pages at Renesas.com</li>
<li>Click on the user manual (owl) icon to open the RA software package User's Manual</li>
</ul>
<h2><a class="anchor" id="creating-a-project"></a>
Creating a Project</h2>
<p>During project creation, you specify the type of project, give it a project name and location, and configure the project settings for version, target board, whether an RTOS is included, the toolchain version, and the beginning template. This section includes easy-to-follow step-by-step instructions for all of the project creation tasks. Once you have created the project, you can move to configuring the project hardware (clocks, pins, interrupts) and the parameters of all the modules that are part of your application.</p>
<h3><a class="anchor" id="creating-a-new-project"></a>
Creating a New Project</h3>
<p>For RA MCU applications, generate a new project using the following steps:</p>
<ol type="1">
<li><p class="startli">Click on <b>File &gt; New &gt; RA C/C++ Project &gt; Renesas RA</b>.</p>
<div class="image">
<img src="sd-new-ra-proj.png" alt="sd-new-ra-proj.png"/>
<div class="caption">
New RA MCU Project</div></div>
<p> Then click on the type of template for the type of project you are creating.</p>
<div class="image">
<img src="sd-new-proj-template.png" alt="sd-new-proj-template.png"/>
<div class="caption">
New Project Templates</div></div>
</li>
<li><p class="startli">Select a project name and location.</p>
<div class="image">
<img src="sd-ra-proj-1.png" alt="sd-ra-proj-1.png"/>
<div class="caption">
RA MCU Project Generator (Screen 1)</div></div>
</li>
<li>Click <b>Next</b>.</li>
</ol>
<h3><a class="anchor" id="selecting-a-board-and-toolchain"></a>
Selecting a Board and Toolchain</h3>
<p>In the <b>Project Configuration</b> window select the hardware and software environment:</p>
<ol type="1">
<li>Select the <b>FSP version</b>.</li>
<li>Select the <b>Board</b> for your application. You can select an existing RA MCU Evaluation Kit or select <b>Custom User Board</b> for any of the RA MCU devices with your own BSP definition.</li>
<li>Select the <b>Device</b>. The <b>Device</b> is automatically populated based on the <b>Board</b> selection. Only change the <b>Device</b> when using the <b>Custom User Board (Any Device)</b> board selection.</li>
<li>To add threads, select <b>RTOS</b>, or <b>No RTOS</b> if an RTOS is not being used.</li>
<li>The <b>Toolchain</b> selection defaults to <b>GCC Arm Embedded</b>.</li>
<li>Select the <b>Toolchain version</b>. This should default to the installed toolchain version.</li>
<li>Select the <b>Debugger</b>. The J-Link Arm Debugger is preselected.</li>
<li><p class="startli">Click <b>Next</b>.</p>
<div class="image">
<img src="sd-ra-proj-2.png" alt="sd-ra-proj-2.png"/>
<div class="caption">
RA MCU Project Generator (Screen 2)</div></div>
 <dl class="section note"><dt>Note</dt><dd>Click on the <b>Help</b> icon (?) for user guides, RA contents, and other documents.</dd></dl>
</li>
</ol>
<h3><a class="anchor" id="selecting-flat-or-trustzone-project"></a>
Selecting Flat or Arm TrustZone Project</h3>
<p>If you selected a device or tool based on an Arm® Cortex®-M33, you next select whether to use Arm® TrustZone® technology in your project. For normal, non-TrustZone projects, select "Flat".</p>
<div class="image">
<img src="sd-flat-non-trustzone.png" alt="sd-flat-non-trustzone.png"/>
<div class="caption">
Flat, Secure, or Non-Secure Project</div></div>
<p> For more information on Arm TrustZone technology, see <a class="el" href="_s_t_a_r_t__d_e_v.html#primer-trustzone-project-development">Primer: Arm TrustZone Project Development</a>.</p>
<h3><a class="anchor" id="selecting-a-project-template"></a>
Selecting a Project Template</h3>
<p>In the next window, select the buiild artifact and RTOS.</p>
<div class="image">
<img src="sd-ra-proj-2a.png" alt="sd-ra-proj-2a.png"/>
<div class="caption">
RA MCU Project Generator (Screen 3)</div></div>
<p> In the next window, select a project template from the list of available templates. By default, this screen shows the templates that are included in your current RA MCU pack. Once you have selected the appropriate template, click <b>Finish</b>.</p>
<dl class="section note"><dt>Note</dt><dd>If you want to develop your own application, select the basic template for your board, <b>Bare Metal - Minimal</b>.</dd></dl>
<div class="image">
<img src="sd-ra-proj-3.png" alt="sd-ra-proj-3.png"/>
<div class="caption">
RA MCU Project Generator (Screen 4)</div></div>
<p> When the project is created, e&sup2; studio displays a summary of the current project configuration in the RA MCU Project Editor.</p>
<div class="image">
<img src="sd-proj-ed-tabs.png" alt="sd-proj-ed-tabs.png"/>
<div class="caption">
RA MCU Project Editor and available editor tabs</div></div>
<p> On the bottom of the RA MCU Project Editor view, you can find the tabs for configuring multiple aspects of your project:</p>
<ul>
<li>With the <b>Summary</b> tab, you can see all they key characteristics of the project: board, device, toolchain, and more.</li>
<li>With the <b>BSP</b> tab, you can change board specific parameters from the initial project selection.</li>
<li>With the <b>Clocks</b> tab, you can configure the MCU clock settings for your project.</li>
<li>With the <b>Pins</b> tab, you can configure the electrical characteristics and functions of each port pin.</li>
<li>With the <b>Interrupts</b> tab, you can add new user events/interrupts.</li>
<li>With the <b>Event Links</b> tab, you can configure events used by the Event Link Controller.</li>
<li>With the <b>Stacks</b> tab, you can add and configure FSP modules. For each module selected in this tab, the <b>Properties</b> window provides access to the configuration parameters, interrupt priorities, and pin selections.</li>
<li>The <b>Components</b> tab provides an overview of the selected modules. Although you can also add drivers for specific FSP releases and application sample code here, this tab is normally only used for reference.</li>
</ul>
<p>The functions and use of each of these tabs is explained in detail in the next section.</p>
<h2><a class="anchor" id="configuring-a-project"></a>
Configuring a Project</h2>
<p>Each of the configurable elements in an FSP project can be edited using the appropriate tab in the RA Configuration editor window. Importantly, the initial configuration of the MCU after reset and before any user code is executed is set by the configuration settings in the <b>BSP</b>, <b>Clocks</b> and <b>Pins</b> tabs. When you select a project template during project creation, e&sup2; studio configures default values that are appropriate for the associated board. You can change those default values as needed. The following sections detail the process of configuring each of the project elements for each of the associated tabs.</p>
<h3><a class="anchor" id="summary-tab"></a>
Summary Tab</h3>
<div class="image">
<img src="sd-e2-summary-tab.png" alt="sd-e2-summary-tab.png"/>
<div class="caption">
Configuration Summary tab</div></div>
<p> The <b>Summary</b> tab, seen in the above figure, identifies all the key elements and components of a project. It shows the target board, the device, toolchain and FSP version. Additionally, it provides a list of all the selected software components and modules used by the project. This is a more convenient summary view when compared to the <b>Components</b> tab.</p>
<p>The summary tab also includes handy icons with links to the Renesas YouTube channel, the Renesas support page and to the RA FSP User Manual that was downloaded during the installation process.</p>
<h3><a class="anchor" id="configuring-the-bsp"></a>
Configuring the BSP</h3>
<p>The <b>BSP</b> tab shows the currently selected board (if any) and device. The Properties view is located in the lower left of the Project Configurations view as shown below.</p>
<dl class="section note"><dt>Note</dt><dd>If the Properties view is not visible, click <b>Window &gt; Show View &gt; Properties</b> in the top menu bar.</dd></dl>
<div class="image">
<img src="sd-e2-bsp-tab.png" alt="sd-e2-bsp-tab.png"/>
<div class="caption">
Configuration BSP tab</div></div>
<p> The <b>Properties</b> view shows the configurable options available for the BSP. These can be changed as required. The BSP is the FSP layer above the MCU hardware. e&sup2; studio checks the entry fields to flag invalid entries. For example, only valid numeric values can be entered for the stack size.</p>
<p>When you click the <b>Generate Project Content</b> button, the BSP configuration contents are written to <code>ra_cfg/fsp_cfg/bsp/bsp_cfg.h</code></p>
<p>This file is created if it does not already exist.</p>
<dl class="section warning"><dt>Warning</dt><dd>Do not edit this file as it is overwritten whenever the <b>Generate Project Content</b> button is clicked.</dd></dl>
<h3><a class="anchor" id="configuring-clocks"></a>
Configuring Clocks</h3>
<p>The <b>Clocks</b> tab presents a graphical view of the MCU's clock tree, allowing the various clock dividers and sources to be modified. If a clock setting is invalid, the offending clock value is highlighted in red. It is still possible to generate code with this setting, but correct operation cannot be guaranteed. In the figure below, the USB clock UCLK has been changed so the resulting clock frequency is 60 MHz instead of the required 48 MHz. This parameter is colored red.</p>
<div class="image">
<img src="sd-clocks-tab.png" alt="sd-clocks-tab.png"/>
<div class="caption">
Configuration Clocks tab</div></div>
<p> When you click the <b>Generate Project Content</b> button, the clock configuration contents are written to: <code>ra_gen/bsp_clock_cfg.h</code></p>
<p>This file will be created if it does not already exist.</p>
<dl class="section warning"><dt>Warning</dt><dd>Do not edit this file as it is overwritten whenever the <b>Generate Project Content</b> button is clicked.</dd></dl>
<h3><a class="anchor" id="configuring-pins"></a>
Configuring Pins</h3>
<p>The <b>Pins</b> tab provides flexible configuration of the MCU's pins. As many pins are able to provide multiple functions, they can be configured on a peripheral basis. For example, selecting a serial channel via the SCI peripheral offers multiple options for the location of the receive and transmit pins for that module and channel. Once a pin is configured, it is shown as green in the <b>Package</b> view.</p>
<dl class="section note"><dt>Note</dt><dd>If the <b>Package</b> view window is not open in e&sup2; studio, select <b>Window &gt; Show View &gt; Pin Configurator &gt; Package</b> from the top menu bar to open it.</dd></dl>
<p>The <b>Pins</b> tab simplifies the configuration of large packages with highly multiplexed pins by highlighting errors and presenting the options for each pin or for each peripheral. If you selected a project template for a specific board such as the EK-RA6M3, some peripherals connected on the board are preselected.</p>
<div class="image">
<img src="sd-pins-tab.jpg" alt="sd-pins-tab.jpg"/>
<div class="caption">
Pins Configuration</div></div>
<p> The pin configurator includes a built-in conflict checker, so if the same pin is allocated to another peripheral or I/O function the pin will be shown as red in the package view and also with white cross in a red square in the <b>Pin Selection</b> pane and <b>Pin Configuration</b> pane in the main <b>Pins</b> tab. The <b>Pin Conflicts</b> view provides a list of conflicts, so conflicts can be quickly identified and fixed.</p>
<p>In the example shown below, port P611 is already used by the CAC, and the attempt to connect this port to the Serial Communications Interface (SCI) results in a dangling connection error. To fix this error, select another port from the pin drop-down list or disable the CAC in the <b>Pin Selection</b> pane on the left side of the tab.</p>
<div class="image">
<img src="sd-e2-pin-config.png" alt="sd-e2-pin-config.png"/>
<div class="caption">
e&sup2; studio Pin configurator</div></div>
<p>The pin configurator also shows a package view and the selected electrical or functional characteristics of each pin.</p>
<div class="image">
<img src="sd-pin-config-pkg-view.png" alt="sd-pin-config-pkg-view.png"/>
<div class="caption">
e&sup2; studio Pin configurator package view</div></div>
<p> When you click the <b>Generate Project Content</b> button, the pin configuration contents are written to: <code>ra_gen\bsp_pin_cfg.h</code></p>
<p>This file will be created if it does not already exist.</p>
<dl class="section warning"><dt>Warning</dt><dd>Do not edit this file as it is overwritten whenever the <b>Generate Project Content</b> button is clicked.</dd></dl>
<p>To make it easy to share pinning information for your project, e&sup2; studio exports your pin configuration settings to a csv format and copies the csv file to <code>ra_gen/&lt;MCU package&gt;.csv</code>.</p>
<h3><a class="anchor" id="configuring-interrupts"></a>
Configuring Interrupts from the Stacks Tab</h3>
<p>You can use the <b>Properties</b> view in the <b>Stacks</b> tab to enable interrupts by setting the interrupt priority. Select the driver in the <b>Stacks</b> pane to view and edit its properties.</p>
<div class="image">
<img src="sd-config-interrupts-on-stack.png" alt="sd-config-interrupts-on-stack.png"/>
<div class="caption">
Configuring Interrupts in the Stacks tab</div></div>
 <h4><a class="anchor" id="interrupts"></a>
Creating Interrupts from the Interrupts Tab</h4>
<p>On the <b>Interrupts</b> tab, the user can bypass a peripheral interrupt set by FSP by setting a user-defined ISR. This can be done by adding a new event via the <b>New User Event</b> button.</p>
<div class="image">
<img src="sd-config-int-in-interrupt-tab.png" alt="sd-config-int-in-interrupt-tab.png"/>
<div class="caption">
Configuring interrupt in Interrupt Tab</div></div>
 <div class="image">
<img src="sd-adding-user-defined-event.png" alt="sd-adding-user-defined-event.png"/>
<div class="caption">
Adding user-defined event</div></div>
<p> Enter the name of ISR for the new user event.</p>
<div class="image">
<img src="sd-new-user-event-isr.jpg" alt="sd-new-user-event-isr.jpg"/>
<div class="caption">
User-defined event ISR</div></div>
 <div class="image">
<img src="sd-new-user-event.jpg" alt="sd-new-user-event.jpg"/>
<div class="caption">
Using a user-defined event</div></div>
 <h3><a class="anchor" id="viewing-event-links"></a>
Viewing Event Links</h3>
<p>The Event Links tab can be used to view the Event Link Controller events. The events are sorted by peripheral to make it easy to find and verify them.</p>
<div class="image">
<img src="sd-viewing-event-links.PNG" alt="sd-viewing-event-links.PNG"/>
<div class="caption">
Viewing Event Links</div></div>
<p> Like the Interrupts tab, user-defined event sources and destinations (producers and consumers) can be defined by clicking the relevant <b>New User Event</b> button. Once a consumer is linked to a producer the link will appear in the <b>Allocations</b> section at the bottom.</p>
<dl class="section note"><dt>Note</dt><dd>When selecting an ELC event to receive for a module (or when manually defining an event link), only the events that are made available by the modules configured in the project will be shown.</dd></dl>
<h2><a class="anchor" id="adding-threads-and-drivers"></a>
Adding Threads and Drivers</h2>
<p>Every RTOS-based RA Project includes at least one RTOS Thread and a stack of FSP modules running in that thread. The <b>Stacks</b> tab is a graphical user interface which helps you to add the right modules to a thread and configure the properties of both the threads and the modules associated with each thread. Once you have configured the thread, e&sup2; studio automatically generates the code reflecting your configuration choices.</p>
<p>For any driver, or, more generally, any module that you add to a thread, e&sup2; studio automatically resolves all dependencies with other modules and creates the appropriate stack. This stack is displayed in the Stacks pane, which e&sup2; studio populates with the selected modules and module options for the selected thread.</p>
<p>The default view of the <b>Stacks</b> tab includes a Common Thread called <b>HAL/Common</b>. This thread includes the driver for I/O control (IOPORT). The default stack is shown in the <b>HAL/Common Stacks</b> pane. The default modules added to the HAL/Common driver are special in that FSP only requires a single instance of each, which e&sup2; studio then includes in every user-defined thread by default.</p>
<p>In applications that do not use an RTOS or run outside of the RTOS, the HAL/Common thread becomes the default location where you can add additional drivers to your application.</p>
<p>For a detailed description on how to add and configure modules and stacks, see the following sections:</p>
<ul>
<li><a class="el" href="_s_t_a_r_t__d_e_v.html#adding-and-configuring-hal-drivers">Adding and Configuring HAL Drivers</a></li>
<li><a class="el" href="_s_t_a_r_t__d_e_v.html#adding-drivers-to-a-thread-and-configuring-the-drivers">Adding Drivers to a Thread and Configuring the Drivers</a></li>
</ul>
<p>Once you have added a module either to HAL/Common or to a new thread, you can access the driver's configuration options in the <b>Properties</b> view. If you added thread objects, you can access the objects configuration options in the <b>Properties</b> view in the same way.</p>
<p>You can find details about how to configure threads here: <a class="el" href="_s_t_a_r_t__d_e_v.html#configuring-threads">Configuring Threads</a></p>
<dl class="section note"><dt>Note</dt><dd>Driver and module selections and configuration options are defined in the FSP pack and can therefore change when the FSP version changes.</dd></dl>
<h3><a class="anchor" id="adding-and-configuring-hal-drivers"></a>
Adding and Configuring HAL Drivers</h3>
<p>For applications that run outside or without the RTOS, you can add additional HAL drivers to your application using the HAL/Common thread. To add drivers, follow these steps:</p>
<ol type="1">
<li><p class="startli">Click on the HAL/Common icon in the <b>Stacks</b> pane. The Modules pane changes to <b>HAL/Common Stacks</b>.</p>
<div class="image">
<img src="sd-proj-config-add-drivers.png" alt="sd-proj-config-add-drivers.png"/>
<div class="caption">
e&sup2; studio Project configurator - Adding drivers</div></div>
</li>
<li>Click <b>New Stack</b> to see a drop-down list of HAL level drivers available in FSP.</li>
<li><p class="startli">Select a driver from the menu <b>New Stack &gt; Driver</b>.</p>
<div class="image">
<img src="sd-select-driver.png" alt="sd-select-driver.png"/>
<div class="caption">
Select a driver</div></div>
</li>
<li>Select the driver module in the <b>HAL/Common Modules</b> pane and configure the driver properties in the <b>Properties</b> view.</li>
</ol>
<p>e&sup2; studio adds the following files when you click the <b>Generate Project Content</b> button:</p>
<ul>
<li>The selected driver module and its files to the <code>ra/fsp</code> directory</li>
<li>The <code>main()</code> function and configuration structures and header files for your application as shown in the table below.</li>
</ul>
<table class="doxtable">
<tr>
<th>File </th><th>Contents </th><th>Overwritten by Generate Project Content?  </th></tr>
<tr>
<td>ra_gen/main.c </td><td>Contains main() calling generated and user code. When called, the BSP already has Initialized the MCU. </td><td>Yes </td></tr>
<tr>
<td>ra_gen/hal_data.c </td><td>Configuration structures for HAL Driver only modules. </td><td>Yes </td></tr>
<tr>
<td>ra_gen/hal_data.h </td><td>Header file for HAL driver only modules. </td><td>Yes </td></tr>
<tr>
<td>src/hal_entry.c </td><td>User entry point for HAL Driver only code. Add your code here. </td><td>No </td></tr>
</table>
<p>The configuration header files for all included modules are created or overwritten in this folder: <code>ra_cfg/fsp_cfg</code></p>
<h3><a class="anchor" id="adding-drivers-to-a-thread-and-configuring-the-drivers"></a>
Adding Drivers to a Thread and Configuring the Drivers</h3>
<p>For an application that uses the RTOS, you can add one or more threads, and for each thread at least one module that runs in the thread. You can select modules from the Driver dropdown menu. To add modules to a thread, follow these steps:</p>
<ol type="1">
<li><p class="startli">In the <b>Threads</b> pane, click <b>New Thread</b> to add a Thread.</p>
<div class="image">
<img src="sd-add-new-rtos-thread.png" alt="sd-add-new-rtos-thread.png"/>
<div class="caption">
Adding a new RTOS Thread on the Stacks tab</div></div>
</li>
<li><p class="startli">In the <b>Properties</b> view, click on the <b>Name</b> and <b>Symbol</b> entries and enter a distinctive name and symbol for the new thread.</p>
<dl class="section note"><dt>Note</dt><dd>e&sup2; studio updates the name of the thread stacks pane to <b>My Thread Stacks</b>.</dd></dl>
</li>
<li><p class="startli">In the <b>My Thread Stacks</b> pane, click on <b>New</b> <b>Stack</b> to see a list of modules and drivers. HAL-level drivers can be added here.</p>
<div class="image">
<img src="sd-adding-modules-drivers-to-thread.png" alt="sd-adding-modules-drivers-to-thread.png"/>
<div class="caption">
Adding Modules and Drivers to a thread</div></div>
</li>
<li>Select a module or driver from the list.</li>
<li><p class="startli">Click on the added driver and configure the driver as required by the application by updating the configuration parameters in the <b>Properties</b> view. To see the selected module or driver and be able to edit its properties, make sure the Thread containing the driver is highlighted in the <b>Threads</b> pane.</p>
<div class="image">
<img src="sd-config-module-or-driver-props.png" alt="sd-config-module-or-driver-props.png"/>
<div class="caption">
Configuring Module or Driver properties</div></div>
</li>
<li>If needed, add another thread by clicking <b>New Thread</b> in the <b>Threads</b> pane.</li>
</ol>
<p>When you press the <b>Generate Project Content</b> button for the example above, e&sup2; studio creates the files as shown in the following table:</p>
<table class="doxtable">
<tr>
<th>File </th><th>Contents </th><th>Overwritten by Generate Project Content?  </th></tr>
<tr>
<td>ra_gen/main.c </td><td>Contains main() calling generated and user code. When called the BSP will have initialized the MCU. </td><td>Yes </td></tr>
<tr>
<td>ra_gen/my_thread.c </td><td>Generated thread "my_thread" and configuration structures for modules added to this thread. </td><td>Yes </td></tr>
<tr>
<td>ra_gen/my_thread.h </td><td>Header file for thread "my_thread" </td><td>Yes </td></tr>
<tr>
<td>ra_gen/hal_data.c </td><td>Configuration structures for HAL Driver only modules. </td><td>Yes </td></tr>
<tr>
<td>ra_gen/hal_data.h </td><td>Header file for HAL Driver only modules. </td><td>Yes </td></tr>
<tr>
<td>src/hal_entry.c </td><td>User entry point for HAL Driver only code. Add your code here. </td><td>No </td></tr>
<tr>
<td>src/my_thread_entry.c </td><td>User entry point for thread "my_thread". Add your code here. </td><td>No </td></tr>
</table>
<p>The configuration header files for all included modules and drivers are created or overwritten in the following folders: <code>ra_cfg/fsp_cfg/&lt;header files&gt;</code></p>
<h3><a class="anchor" id="configuring-threads"></a>
Configuring Threads</h3>
<p>If the application uses an RTOS, the <b>Stacks</b> tab can be used to simplify the creation of RTOS threads, semaphores, mutexes, and event flags.</p>
<p>The components of each thread can be configured from the <b>Properties</b> view as shown below.</p>
<div class="image">
<img src="sd-new-thread-properties.png" alt="sd-new-thread-properties.png"/>
<div class="caption">
New Thread Properties</div></div>
<p> The <b>Properties</b> view contains settings common for all Threads (<b>Common</b>) and settings for this particular thread (<b>Thread</b>).</p>
<p>For this thread instance, the thread's name and properties (such as priority level or stack size) can be easily configured. e&sup2; studio checks that the entries in the property field are valid. For example, it will verify that the field <b>Priority</b>, which requires an integer value, only contains numeric values between 0 and 9.</p>
<p>To add RTOS resources to a Thread, select a thread and click on <b>New Object</b> in the Thread Objects pane. The pane takes on the name of the selected thread, in this case <b>My Thread Objects</b>.</p>
<div class="image">
<img src="sd-configuring-thread-object-properties.png" alt="sd-configuring-thread-object-properties.png"/>
<div class="caption">
Configuring Thread Object Properties</div></div>
<p> Make sure to give each thread object a unique name and symbol by updating the <b>Name</b> and <b>Symbol</b> entries in the <b>Properties</b> view.</p>
<h2><a class="anchor" id="reviewing-and-adding-components"></a>
Reviewing and Adding Components</h2>
<p>The <b>Components</b> tab enables the individual modules required by the application to be included or excluded. Modules common to all RA MCU projects are preselected (for example: <b>BSP &gt; BSP &gt; Board-specific BSP</b> and <b>HAL Drivers &gt; all &gt; r_cgc</b>). All modules that are necessary for the modules selected in the <b>Stacks</b> tab are included automatically. You can include or exclude additional modules by ticking the box next to the required component.</p>
<div class="image">
<img src="sd-components-tab.png" alt="sd-components-tab.png"/>
<div class="caption">
Components Tab</div></div>
<p> Clicking the <b>Generate Project Content</b> button copies the .c and .h files for each selected component into the following folders:</p>
<ul>
<li><code>ra/fsp/inc/api</code></li>
<li><code>ra/fsp/inc/instances</code></li>
<li><code>ra/fsp/src/bsp</code></li>
<li><code>ra/fsp/src/&lt;Driver_Name&gt;</code></li>
</ul>
<p>e&sup2; studio also creates configuration files in the <code>ra_cfg/fsp_cfg</code> folder with configuration options set in the <b>Stacks</b> tab.</p>
<h2><a class="anchor" id="writing-the-application"></a>
Writing the Application</h2>
<p>Once you have added Modules and drivers and set their configuration parameters in the <b>Stacks</b> tab, you can add the application code that calls the Modules and drivers.</p>
<dl class="section note"><dt>Note</dt><dd>To check your configuration, build the project once without errors before adding any of your own application code.</dd></dl>
<h3><a class="anchor" id="coding-features"></a>
Coding Features</h3>
<p>e&sup2; studio provides several efficiency improving features that help write code. Review these features prior to digging into the code development step-by-step sections that follow.</p>
<h4>Autocomplete</h4>
<p>Autocomplete is a context aware coding accelerator that suggests possible completions for partially typed-in code elements. If you can 'guess' the first part of a macro, for example, the Autocomplete function can suggest options for completing the rest of the macro.</p>
<p>In the following example, a macro related to a BSP_IO setting needs to be found. After typing <code>BSP_IO_</code> in a source code file, pressing <code>Ctrl + Space</code> opens the Autocomplete list. This list shows a selection of context aware options for completing the macro. Scroll through the window to find the desired macro (in this case <code>BSP_IO_LEVEL_HIGH</code>) and click on it to add it to your code.</p>
<div class="image">
<img src="sd-autocomplete-example.png" alt="sd-autocomplete-example.png"/>
<div class="caption">
Autocomplete example</div></div>
<p> Other code elements can use autocomplete too. Some of the more common uses for Autocomplete include Enumerations, Types, and API functions - but try it in any situation you think the tool may have enough context to determine what you might be looking for.</p>
<p>For a hands-on experience using Autocomplete use the Quick FSP Labs for <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating Blinky from Scratch</a> and <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating an RTC Blinky from Scratch</a>. These 15-minute Do it Yourself labs take you through the step-by-step process of using Autocomplete, Developer Assistance, and the Help system.</p>
<h4><a class="anchor" id="welcome-window"></a>
Welcome Window</h4>
<p>The e&sup2; studio Welcome window displays useful information and common links to assist in development. Check out these resources to see what is available. They are updated with each release, so check back to see what has been added after a new release.</p>
<div class="image">
<img src="sd-welcome-window.png" alt="sd-welcome-window.png"/>
<div class="caption">
Welcome window</div></div>
 <h4><a class="anchor" id="cheat-sheets"></a>
Cheat Sheets</h4>
<p>Cheat sheets are macro driven illustrations of some common tasks. They show, step-by-step, what commands and menus are used. These will be populated with more examples on each release. Cheat Sheets are available from the <b>Help</b> menu.</p>
<div class="image">
<img src="sd-cheat-sheets.png" alt="sd-cheat-sheets.png"/>
<div class="caption">
Cheat Sheets</div></div>
 <h4><a class="anchor" id="developer-assistance"></a>
Developer Assistance</h4>
<p>FSP Developer Assistance provides developers with module and Application Programming Interface (API) reference documentation in e&sup2; studio. After configuring the threads and software stacks for an FSP project with the RA Configuration editor, Developer Assistance quickly helps you get started writing C/C++ application code for the project using the configured stack modules.</p>
<ol type="1">
<li><p class="startli">Expand the project explorer to view Developer Assistance</p>
<div class="image">
<img src="sd-dev-assist.png" alt="sd-dev-assist.png"/>
<div class="caption">
Developer Assistance</div></div>
</li>
<li><p class="startli">Expand a stack module to show its APIs</p>
<div class="image">
<img src="sd-dev-assist-apis.png" alt="sd-dev-assist-apis.png"/>
<div class="caption">
Developer Assistance APIs</div></div>
</li>
<li>Dragging and dropping an API from Develop Assistance to a source file helps to write source code quickly.</li>
</ol>
<div class="image">
<img src="sd-dev-assist-drag-drop.png" alt="sd-dev-assist-drag-drop.png"/>
<div class="caption">
Dragging and Dropping an API in Developer Assistance</div></div>
<p> For a hands-on experience using Developer Assistance use the Quick FSP Labs for <a href="https://en-support.renesas.com/knowledgeBase/19110786">An Introduction to Developer Assistance</a>, <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating Blinky from Scratch</a> and <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating an RTC Blinky from Scratch</a>. These 15-minute Do it Yourself labs take you through the step-by-step process of using Autocomplete, Developer Assistance, and the Help system.</p>
<h4><a class="anchor" id="information-icon"></a>
Information Icon</h4>
<p>Information icons are available on each module in the thread stack. Clicking on these icons opens a module folder on GitHub that contains additional information on the module. An example information Icon is shown below:</p>
<div class="image">
<img src="sd-info-icon.png" alt="sd-info-icon.png"/>
<div class="caption">
Information icon</div></div>
<h4><a class="anchor" id="ide-help"></a>
IDE Help</h4>
<p>A good source of additional information for many FSP topics is the Help system. To get to the Help system, click on <b>Help</b> and then select <b>Help Contents</b> as seen below.</p>
<div class="image">
<img src="sd-opening-help-system.png" alt="sd-opening-help-system.png"/>
<div class="caption">
Opening the Help System</div></div>
<p> Once the Help system is open, select the <b>RA Contents</b> entry in the left side Guide-bar. Expand it to see the main RA Topics.</p>
<div class="image">
<img src="sd-ra-content-help.png" alt="sd-ra-content-help.png"/>
<div class="caption">
RA Content Help</div></div>
<p> You can also search for help topics by using the Search bar. Below is an example searching for Visual Expressions, a helpful feature in the e&sup2; studio debugger.</p>
<div class="image">
<img src="sd-e2-studio-help-from-search-bar.png" alt="sd-e2-studio-help-from-search-bar.png"/>
<div class="caption">
e&sup2; studio Help from the Search Bar</div></div>
<p> For a hands-on experience using the Help system use the Quick FSP Labs for <a href="https://en-support.renesas.com/knowledgeBase/19110786">An Introduction to Developer Assistance</a>, <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating Blinky from Scratch</a> and <a href="https://en-support.renesas.com/knowledgeBase/19110690">Creating an RTC Blinky from Scratch</a>. These 15-minute Do it Yourself labs take you through the step-by-step process of using Autocomplete, Developer Assistance, and the Help system.</p>
<h3><a class="anchor" id="hal-modules-in-fsp"></a>
HAL Modules in FSP: A Practical Description</h3>
<p>The <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html">FSP Architecture</a> section describes FSP stacks, modules and interfaces in significant detail, providing an understanding of the theory behind them. The following sections provides a quick and practical introduction on how to use API functions when writing code and where in the API reference sections you can find useful API related information.</p>
<h4><a class="anchor" id="introduction-to-hal-modules"></a>
Introduction to HAL Modules</h4>
<p>In FSP, HAL module drivers provide convenient API functions that access RA processor peripheral features. Module properties are defined in the RA GUI configurator, eliminating the tedious and error prone process of setting peripheral control registers. When configuration is complete, the generator automatically creates the code needed to implement the associated API functions. API functions are the main way a developer interacts with the target processor and peripherals.</p>
<h4><a class="anchor" id="hal-drvier-api-function-call-formats"></a>
HAL Driver API Function Call Formats</h4>
<p>HAL driver API functions all have a similar format. They all start with "R_" to indicate they are HAL related functions. Next comes the module name followed by the function and any parameters. This format is illustrated below:</p>
<div class="fragment"><div class="line">R_&lt;module&gt;_&lt;function&gt;(&lt;parameters&gt;);</div></div><!-- fragment --><p>Here are some examples:</p>
<div class="fragment"><div class="line">status = R_GPT_Open(&amp;g_timer0_ctrl, &amp;g_timer0_cfg);</div><div class="line">status = R_GPT_Start(&amp;g_timer0_ctrl);</div><div class="line">status = R_GPT_PeriodSet(&amp;g_timer0_ctrl, period);</div><div class="line">status = R_ADC_Open(&amp;g_adc0_ctrl, &amp;g_adc0_cfg);</div><div class="line">status = R_ADC_InfoGet(&amp;g_adc0_ctrl, &amp;adc_info);</div></div><!-- fragment --><h4><a class="anchor" id="hal-driver-api-call-reference-information"></a>
HAL Driver API Call Reference Information</h4>
<p>Each HAL module has a useful API Reference section that includes key details on each function. The function prototype is presented first, showing the return type (usually <code>fsp_status_t</code> for HAL functions) and the function parameters. A short description and any warnings or notes follow the function definition. In some cases, a code snippet is included to illustrate use of the function. Finally, all possible return values are provided to assist in debugging and error management.</p>
<div class="image">
<img src="sd-module-api-ref-example.png" alt="sd-module-api-ref-example.png"/>
<div class="caption">
Module Api Reference Section Example</div></div>
 <h3><a class="anchor" id="rtos-independent-applications"></a>
RTOS-Independent Applications</h3>
<p>To write application code:</p>
<ol type="1">
<li>Add all drivers and modules in the <b>Stacks</b> tab and resolve all dependencies flagged by e&sup2; studio such as missing interrupts or drivers.</li>
<li>Configure the drivers in the <b>Properties</b> view.</li>
<li>In the Project Configuration view, click the <b>Generate Project Content</b> button.</li>
<li><p class="startli">In the <b>Project Explorer</b> view, double-click on the <code>src/hal_entry.c</code> file to edit the source file.</p>
<div class="image">
<img src="sd-hal-entry-c.png" alt="sd-hal-entry-c.png"/>
</div>
<dl class="section note"><dt>Note</dt><dd>All configuration structures necessary for the driver to be called in the application are initialized in <code>ra_gen/hal_data.c</code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not modify the files in the directory ra_gen. These files are overwritten every time you push the <b>Generate Project Content</b> button.</dd></dl>
</li>
<li><p class="startli">Add your application code here:</p>
<div class="image">
<img src="sd-add-user-code.png" alt="sd-add-user-code.png"/>
<div class="caption">
Adding user code to hal_entry.c</div></div>
</li>
<li>Build the project without errors by clicking on <b>Project &gt; Build Project</b>.</li>
</ol>
<p>The following tutorial shows how execute the steps above and add application code: <a class="el" href="_s_t_a_r_t__d_e_v.html#tutorial-using-hal-drivers-programming-the-wdt">Tutorial: Using HAL Drivers - Programming the WDT</a>.</p>
<p>The WDT example is a HAL level application which does not use an RTOS. The user guides for each module also include basic application code that you can add to <code>hal_entry.c</code>.</p>
<h3><a class="anchor" id="rtos-applications"></a>
RTOS Applications</h3>
<p>To write RTOS-aware application code using RTOS, follow these steps:</p>
<ol type="1">
<li>Add a thread using the <b>Stacks</b> tab.</li>
<li>Provide a unique name for the thread in the <b>Properties</b> view for this thread.</li>
<li>Configure all drivers and resources for this thread and resolve all dependencies flagged by e&sup2; studio such as missing interrupts or drivers.</li>
<li>Configure the thread objects.</li>
<li>Provide unique names for each thread object in the <b>Properties</b> view for each object.</li>
<li>Add more threads if needed and repeat steps 1 to 5.</li>
<li>In the <b>RA Project Editor</b>, click the <b>Generate Project Content</b> button.</li>
<li><p class="startli">In the <b>Project Explorer</b> view, double-click on the <code>src/my_thread_1_entry.c</code> file to edit the source file.</p>
<div class="image">
<img src="sd-gen-files-for-rtos.png" alt="sd-gen-files-for-rtos.png"/>
<div class="caption">
Generated files for an RTOS application</div></div>
 <dl class="section note"><dt>Note</dt><dd>All configuration structures necessary for the driver to be called in the application are initialized in <code>ra_gen/my_thread_1.c</code> and <code>my_thread_2.c</code></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not modify the files in the directory <code>ra_gen</code>. These files are overwritten every time you push the <b>Generate Project Content</b> button.</dd></dl>
</li>
<li><p class="startli">Add your application code here:</p>
<div class="image">
<img src="sd-add-user-code-my-thread.png" alt="sd-add-user-code-my-thread.png"/>
<div class="caption">
Adding user code to my_thread_1.entry</div></div>
</li>
<li>Repeat steps 1 to 9 for the next thread.</li>
<li>Build your project without errors by clicking on <b>Project &gt; Build Project</b>.</li>
</ol>
<h3><a class="anchor" id="additional-resources-for-application-development"></a>
Additional Resources for Application Development</h3>
<h4><a class="anchor" id="example-projects"></a>
Example Projects</h4>
<p>A wide variety of Example Projects for FSP and RA MCUs is available on the GitHub site here: <a href="https://github.com/renesas/ra-fsp-examples">https://github.com/renesas/ra-fsp-examples</a>. Example projects are organized by target kit so it is easy to find all the examples for your kit of choice.</p>
<div class="image">
<img src="sd-fsp-ex-proj-org-by-kit.png" alt="sd-fsp-ex-proj-org-by-kit.png"/>
<div class="caption">
FSP Example Projects Organized by Kit</div></div>
<p> Projects are available as both downloadable zip files and as project source files. Typically, there is a project for each module. New example projects are being added periodically, so check back if a particular module isn't yet available.</p>
<div class="image">
<img src="sd-selection-of-ex-proj-avail-on-github.png" alt="sd-selection-of-ex-proj-avail-on-github.png"/>
<div class="caption">
A Selection of Example Projects Available on GitHub</div></div>
 <h4><a class="anchor" id="quick-labs"></a>
Quick Labs</h4>
<p>A variety of Hands-on Do It Yourself labs are available on the Renesas RA and FSP Knowledge Base. Quick FSP Labs target the EK-RA6M3 kit and typically require only 15 minutes to complete. Each lab covers a couple related development tools and techniques like Autocomplete, Developer Assistance, console I/O over RTT, and Visual Expressions, that can speed up the development process. A list of all available Quick Labs can be found here: <a href="https://en-support.renesas.com/knowledgeBase/19450948">https://en-support.renesas.com/knowledgeBase/19450948</a></p>
<h2><a class="anchor" id="debugging-the-project"></a>
Debugging the Project</h2>
<p>Once your project builds without errors, you can use the Debugger to download your application to the board and execute it.</p>
<p>To debug an application follow these steps:</p>
<ol type="1">
<li><p class="startli">On the drop-down list next to the debug icon, select <b>Debug Configurations</b>.</p>
<div class="image">
<img src="sd-debug-config.png" alt="sd-debug-config.png"/>
</div>
</li>
<li><p class="startli">In the <b>Debug Configurations</b> view, click on your project listed as <b>MyProject Debug</b>.</p>
<div class="image">
<img src="sd-my-proj-debug.png" alt="sd-my-proj-debug.png"/>
</div>
</li>
<li>Connect the board to your PC via either a standalone Segger J-Link debugger, a Segger J-Link On-Board (included on all RA EKs), or an E2 or E2 Lite and click <b>Debug</b>.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>For details on using J-Link and connecting the board to the PC, see the Quick Start Guide included in the RA MCU Kit.</dd></dl>
<h2><a class="anchor" id="modifying-toolchain-settings"></a>
Modifying Toolchain Settings</h2>
<p>There are instances where it may be necessary to make changes to the toolchain being used (for example, to change optimization level of the compiler or add a library to the linker). Such modifications can be made from within e&sup2; studio through the menu <b>Project &gt; Properties &gt; C/C++ Build &gt; Settings</b> when the project is selected. The following screenshots show the settings dialogs for the GNU Arm and LLVM toolchains. The dialog looks slightly different depending upon the toolchain being used.</p>
<div class="image">
<img src="sd-e2-proj-toolchain.png" alt="sd-e2-proj-toolchain.png"/>
<div class="caption">
e&sup2; studio Project toolchain settings for GNU Arm</div></div>
 <div class="image">
<img src="sd-e2-proj-toolchain-llvm.png" alt="sd-e2-proj-toolchain-llvm.png"/>
<div class="caption">
e&sup2; studio Project toolchain settings for LLVM</div></div>
<p> The scope for the settings is project scope which means that the settings are valid only for the project being modified.</p>
<p>The settings for the linker which control the location of the various memory sections are contained in a script file specific for the device being used. This script file is included in the project when it is created and is found in the script folder (for example, <code>/script/a6m3.ld</code>).</p>
<h2><a class="anchor" id="creating-ra-project-with-arm-compiler-6-in-e2-studio"></a>
Creating RA project with Arm Compiler 6 in e² studio</h2>
<p>e&sup2; studio does not include the Arm Compiler 6 (AC6) toolchain by default. Follow the steps below to integrate AC6 into e&sup2; studio and create an AC6 RA project.</p>
<dl class="section note"><dt>Note</dt><dd>It is assumed that the user is already familiar with RA project creation in e&sup2; studio. e&sup2; studio does not include Arm Compiler 6 (AC6) toolchain by default.</dd></dl>
<p>Steps 1 through 8 describe the process for integrating Arm Compiler 6 into e&sup2; studio.</p>
<ol type="1">
<li>Download, install, and configure license for the AC6 toolchain (<a href="https://developer.arm.com/tools-and-software/embedded/arm-compiler/downloads/version-6">https://developer.arm.com/tools-and-software/embedded/arm-compiler/downloads/version-6</a>).</li>
<li>Launch e&sup2; studio.</li>
<li>Go to <b>Window &gt; Preferences &gt; Toolchains</b>.</li>
<li><p class="startli">Click <b>Add</b>.</p>
<div class="image">
<img src="sd-ac6-add.png" alt="sd-ac6-add.png"/>
<div class="caption">
Add Toolchain</div></div>
</li>
<li><p class="startli">Browse to the path where AC6 toolchain is installed and select the <code>\bin</code> folder. Click <b>Next</b>.</p>
<div class="image">
<img src="sd-ac6-select-path.png" alt="sd-ac6-select-path.png"/>
<div class="caption">
Browse to AC6 Compiler</div></div>
</li>
<li><p class="startli">Toolchain information in displayed. Click <b>Finish</b>.</p>
<div class="image">
<img src="sd-ac6-toolchain-info.png" alt="sd-ac6-toolchain-info.png"/>
<div class="caption">
Toolchain Information</div></div>
</li>
<li><p class="startli">Click <b>Apply and Close</b>.</p>
<div class="image">
<img src="sd-ac6-apply-close.png" alt="sd-ac6-apply-close.png"/>
<div class="caption">
Apply and Close</div></div>
</li>
<li><p class="startli">Click <b>Restart Eclipse</b> when prompted.</p>
<div class="image">
<img src="sd-ac6-restart.png" alt="sd-ac6-restart.png"/>
<div class="caption">
Restart Eclipse</div></div>
</li>
<li><p class="startli">When creating a new RA C/C++ project, select <b>ARM Compiler 6</b> included in the Toolchains section.</p>
<div class="image">
<img src="sd-ac6-select-arm-compiler.png" alt="sd-ac6-select-arm-compiler.png"/>
<div class="caption">
Select Arm Compiler</div></div>
 </li>
</ol>
<h2><a class="anchor" id="importing-an-existing-project-into-e2-studio"></a>
Importing an Existing Project into e² studio</h2>
<ol type="1">
<li>Start by opening e&sup2; studio.</li>
<li>Open an existing Workspace to import the project and skip to step d. If the workspace doesn't exist, proceed with the following steps:<ol type="a">
<li><p class="startli">At the end of e&sup2; studio startup, you will see the Workspace Launcher Dialog box as shown in the following figure.</p>
<div class="image">
<img src="sd-workspace-launcher-dialog.png" alt="sd-workspace-launcher-dialog.png"/>
<div class="caption">
Workspace Launcher dialog</div></div>
</li>
<li><p class="startli">Enter a new workspace name in the Workspace Launcher Dialog as shown in the following figure. e&sup2; studio creates a new workspace with this name.</p>
<div class="image">
<img src="sd-workspace-launcher-select-workspace.png" alt="sd-workspace-launcher-select-workspace.png"/>
<div class="caption">
Workspace Launcher dialog - Select Workspace</div></div>
</li>
<li>Click <b>Launch</b>.</li>
<li><p class="startli">When the workspace is opened, you may see the Welcome Window. Click on the <b>Hide</b> arrow button to proceed past the Welcome Screen as seen in the following figure.</p>
<div class="image">
<img src="sd-workbench-arrow-button.png" alt="sd-workbench-arrow-button.png"/>
<div class="caption">
Workbench arrow button</div></div>
</li>
</ol>
</li>
<li><p class="startli">You are now in the workspace that you want to import the project into. Click the <b>File</b> menu in the menu bar, as shown in the following figure.</p>
<div class="image">
<img src="sd-menu-and-tool-bar.png" alt="sd-menu-and-tool-bar.png"/>
<div class="caption">
Menu and tool bar</div></div>
</li>
<li><p class="startli">Click <b>Import</b> on the <b>File</b> menu or in the menu bar, as shown in the following figure.</p>
<div class="image">
<img src="sd-file-menu.png" alt="sd-file-menu.png"/>
<div class="caption">
File drop-down menu</div></div>
</li>
<li><p class="startli">In the <b>Import</b> dialog box, as shown in the following figure, choose the <b>General</b> option, then <b>Existing Projects into Workspace</b>, to import the project into the current workspace.</p>
<div class="image">
<img src="sd-project-import-with-existing-project.png" alt="sd-project-import-with-existing-project.png"/>
<div class="caption">
Project Import dialog with "Existing Projects into Workspace" option selected</div></div>
</li>
<li>Click <b>Next</b>.</li>
<li>To import the project, use either <b>Select archive file</b> or <b>Select root directory</b>.<ol type="a">
<li><p class="startli">Click <b>Select archive file</b> as shown in the following figure.</p>
<div class="image">
<img src="sd-import-existing-project-dialog-1.png" alt="sd-import-existing-project-dialog-1.png"/>
<div class="caption">
Import Existing Project dialog 1 - Select archive file</div></div>
</li>
<li><p class="startli">Click <b>Select root directory</b> as shown in the following figure.</p>
<div class="image">
<img src="sd-import-existing-project-dialog-1b.png" alt="sd-import-existing-project-dialog-1b.png"/>
<div class="caption">
Import Existing Project dialog 1 - Select root directory</div></div>
</li>
</ol>
</li>
<li>Click <b>Browse</b>.</li>
<li>For <b>Select archive file</b>, browse to the folder where the zip file for the project you want to import is located. For <b>Select root directory</b>, browse to the project folder that you want to import.</li>
<li>Select the file for import. In our example, it is <code>CAN_HAL_MG_AP.zip</code> or <code>CAN_HAL_MG_AP</code>.</li>
<li>Click <b>Open</b>.</li>
<li><p class="startli">Select the project to import from the list of <b>Projects</b>, as shown in the following figure.</p>
<div class="image">
<img src="sd-import-existing-project-dialog-2.png" alt="sd-import-existing-project-dialog-2.png"/>
<div class="caption">
Import Existing Project dialog 2</div></div>
</li>
<li>Click <b>Finish</b> to import the project.</li>
</ol>
<h2><a class="anchor" id="using-semihosting-in-a-project"></a>
Using Semihosting in a Project</h2>
<dl class="section note"><dt>Note</dt><dd><b>printf requires use of the heap (BSP Tab -&gt; Properties -&gt; RA Common -&gt; Heap size (bytes))</b></dd></dl>
<p>When using certain standard C I/O functions such as <code>printf</code> and <code>scanf</code> semihosting must be initialized for them to work correctly with the <b>Renesas Debug Virtual Console</b>. In order to setup semihosting a call to <code>initialise_monitor_handles</code> should be added somewhere in your application before any semihosting related calls are made. Here is an example declaration and call:</p>
<div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keywordtype">void</span> initialise_monitor_handles(<span class="keywordtype">void</span>); <span class="comment">/* Add this declaration before calling. */</span></div><div class="line"></div><div class="line">initialise_monitor_handles(); <span class="comment">/* Add this call to your application. */</span></div></div><!-- fragment --><h1><a class="anchor" id="tutorial-your-first-ra-mcu-project-blinky"></a>
Tutorial: Your First RA MCU Project - Blinky</h1>
<h2><a class="anchor" id="tutorial-blinky"></a>
Tutorial Blinky</h2>
<p>The goal of this tutorial is to quickly get acquainted with the Flexible Platform by moving through the steps of creating a simple application using e&sup2; studio and running that application on an RA MCU board.</p>
<h2><a class="anchor" id="what-does-blinky-do"></a>
What Does Blinky Do?</h2>
<p>The application used in this tutorial is Blinky, traditionally the first program run in a new embedded development environment.</p>
<p>Blinky is the "Hello World" of microcontrollers. If the LED blinks you know that:</p>
<ul>
<li>The toolchain is setup correctly and builds a working executable image for your chip.</li>
<li>The debugger has installed with working drivers and is properly connected to the board.</li>
<li>The board is powered up and its jumper and switch settings are probably correct.</li>
<li>The microcontroller is alive, the clocks are running, and the memory is initialized.</li>
</ul>
<p>The Blinky example application used in this tutorial is designed to run the same way on all boards offered by Renesas that hold the RA microcontroller. The code in Blinky is completely board independent. It does the work by calling into the BSP (board support package) for the particular board it is running on. This works because:</p>
<ul>
<li>Every board has at least one LED connected to a GPIO pin.</li>
<li>That one LED is always labelled LED1 on the silk screen.</li>
<li>Every BSP supports an API that returns a list of LEDs on a board, and their port and pin assignments.</li>
</ul>
<h2><a class="anchor" id="prerequisites"></a>
Prerequisites</h2>
<p>To follow this tutorial, you need:</p>
<ul>
<li>Windows based PC</li>
<li>e&sup2; studio</li>
<li>Flexible Software Package</li>
<li>An RA MCU board kit</li>
</ul>
<h2><a class="anchor" id="create-a-new-project-for-blinky"></a>
Create a New Project for Blinky</h2>
<p>The creation and configuration of an RA MCU project is the first step in the creation of an application. The base RA MCU pack includes a pre-written Blinky example application that is simple and works on all Renesas RA MCU boards.</p>
<p>Follow these steps to create an RA MCU project:</p>
<ol type="1">
<li>In e&sup2; studio, click <b>File &gt; New &gt; C/C++ Project &gt; Renesas RA</b> and select <b>Renesas RA C/C++ Project</b>.</li>
<li>Assign a name to this new project. Blinky is a good name to use for this tutorial.</li>
<li><p class="startli">Click <b>Next</b>. The <b>Project Configuration</b> window shows your selection.</p>
<div class="image">
<img src="sd-proj-config-1-blinky.png" alt="sd-proj-config-1-blinky.png"/>
<div class="caption">
e&sup2; studio Project Configuration window (part 1)</div></div>
</li>
<li><p class="startli">Select the board support package by selecting the name of your board from the <b>Device Selection</b> drop-down list and click <b>Next</b>.</p>
<div class="image">
<img src="sd-proj-config-2.png" alt="sd-proj-config-2.png"/>
<div class="caption">
e&sup2; studio Project Configuration window (part 2)</div></div>
</li>
<li><p class="startli">Select the build artifact and RTOS.</p>
<div class="image">
<img src="sd-proj-config-2a.png" alt="sd-proj-config-2a.png"/>
<div class="caption">
e&sup2; studio Project Configuration window (part 3)</div></div>
</li>
<li><p class="startli">Select the Blinky template for your board and click <b>Finish</b>.</p>
<div class="image">
<img src="sd-proj-config-3.png" alt="sd-proj-config-3.png"/>
<div class="caption">
e&sup2; studio Project Configuration window (part 4)</div></div>
<p> Once the project has been created, the name of the project will show up in the <b>Project Explorer</b> window of e&sup2; studio. Now click the <b>Generate Project Content</b> button in the top right corner of the <b>Project Configuration</b> window to generate your board specific files.</p>
<div class="image">
<img src="sd-proj-config-tab.png" alt="sd-proj-config-tab.png"/>
<div class="caption">
e&sup2; studio Project Configuration tab</div></div>
<p> Your new project is now created, configured, and ready to build.</p>
</li>
</ol>
<h3><a class="anchor" id="details-about-the-blinky-configuration"></a>
Details about the Blinky Configuration</h3>
<p>The <b>Generate Project Content</b> button creates configuration header files, copies source files from templates, and generally configures the project based on the state of the <b>Project Configuration</b> screen.</p>
<p>For example, if you check a box next to a module in the <b>Components</b> tab and click the <b>Generate Project Content</b> button, all the files necessary for the inclusion of that module into the project will be copied or created. If that same check box is then unchecked those files will be deleted.</p>
<h3><a class="anchor" id="configuring-the-blinky-clocks"></a>
Configuring the Blinky Clocks</h3>
<p>By selecting the Blinky template, the clocks are configured by e&sup2; studio for the Blinky application. The clock configuration tab (see <a class="el" href="_s_t_a_r_t__d_e_v.html#configuring-clocks">Configuring Clocks</a>) shows the Blinky clock configuration. The Blinky clock configuration is stored in the BSP clock configuration file (see BSP Clock Configuration).</p>
<h3><a class="anchor" id="configuring-the-blinky-pins"></a>
Configuring the Blinky Pins</h3>
<p>By selecting the Blinky template, the GPIO pins used to toggle the LED1 are configured by e&sup2; studio for the Blinky application. The pin configuration tab shows the pin configuration for the Blinky application (see <a class="el" href="_s_t_a_r_t__d_e_v.html#configuring-pins">Configuring Pins</a>). The Blinky pin configuration is stored in the BSP configuration file (see BSP Pin Configuration).</p>
<h3><a class="anchor" id="configuring-the-parameters-for-blinky-components"></a>
Configuring the Parameters for Blinky Components</h3>
<p>The Blinky project automatically selects the following HAL components in the Components tab:</p>
<ul>
<li>r_ioport</li>
</ul>
<p>To see the configuration parameters for any of the components, check the <b>Properties</b> tab in the HAL window for the respective driver (see <a class="el" href="_s_t_a_r_t__d_e_v.html#adding-and-configuring-hal-drivers">Adding and Configuring HAL Drivers</a>).</p>
<h3><a class="anchor" id="where-is-main"></a>
Where is main()?</h3>
<p>The main function is located in <code>&lt; project &gt;/ra_gen/main.c</code>. It is one of the files that are generated during the project creation stage and only contains a call to <code>hal_entry()</code>. For more information on generated files, see <a class="el" href="_s_t_a_r_t__d_e_v.html#adding-and-configuring-hal-drivers">Adding and Configuring HAL Drivers</a>.</p>
<h3><a class="anchor" id="blinky-example-code"></a>
Blinky Example Code</h3>
<p>The blinky application is stored in the <code>hal_entry.c</code> file. This file is generated by e&sup2; studio when you select the Blinky Project template and is located in the project's <code>src/</code> folder.</p>
<p>The application performs the following steps:</p>
<ol type="1">
<li>Get the LED information for the selected board by bsp_leds_t structure.</li>
<li>Define the output level HIGH for the GPIO pins controlling the LEDs for the selected board.</li>
<li>Get the selected system clock speed and scale down the clock, so the LED toggling can be observed.</li>
<li>Toggle the LED by writing to the GPIO pin with <code>R_BSP_PinWrite((bsp_io_port_pin_t) pin, pin_level);</code></li>
</ol>
<h2><a class="anchor" id="build-the-blinky-project"></a>
Build the Blinky Project</h2>
<p>Highlight the new project in the <b>Project Explorer</b> window by clicking on it and build it.</p>
<p>There are three ways to build a project:</p>
<ol type="1">
<li>Click on <b>Project</b> in the menu bar and select <b>Build Project</b>.</li>
<li>Click on the hammer icon.</li>
<li>Right-click on the project and select <b>Build Project</b>.</li>
</ol>
<div class="image">
<img src="sd-proj-explorer.jpg" alt="sd-proj-explorer.jpg"/>
<div class="caption">
e&sup2; studio Project Explorer window</div></div>
<p> Once the build is complete a message is displayed in the build <b>Console</b> window that displays the final image file name and section sizes in that image.</p>
<div class="image">
<img src="sd-proj-build-console.png" alt="sd-proj-build-console.png"/>
<div class="caption">
e&sup2; studio Project Build console</div></div>
 <h2><a class="anchor" id="debug-the-blinky-project"></a>
Debug the Blinky Project</h2>
<h3><a class="anchor" id="debug-prerequisites"></a>
Debug prerequisites</h3>
<p>To debug the project on a board, you need</p>
<ul>
<li>The board to be connected to e&sup2; studio</li>
<li>The debugger to be configured to talk to the board</li>
<li>The application to be programmed to the microcontroller</li>
</ul>
<p>Applications run from the internal flash of your microcontroller. To run or debug the application, the application must first be programmed to the microcontroller's flash. There are two ways to do this:</p>
<ul>
<li>JTAG debugger</li>
<li>Built-in boot-loader via UART or USB</li>
</ul>
<p>Some boards have an on-board JTAG debugger and others require an external JTAG debugger connected to a header on the board.</p>
<p>Refer to your board's user manual to learn how to connect the JTAG debugger to e&sup2; studio.</p>
<h3><a class="anchor" id="debug-steps"></a>
Debug steps</h3>
<p>To debug the Blinky application, follow these steps:</p>
<ol type="1">
<li><p class="startli">Configure the debugger for your project by clicking <b>Run &gt; Debugger Configurations ...</b></p>
<div class="image">
<img src="sd-debug-icon.png" alt="sd-debug-icon.png"/>
<div class="caption">
e&sup2; studio Debug icon</div></div>
<p> or by selecting the drop-down menu next to the bug icon and selecting <b>Debugger Configurations ...</b></p>
<div class="image">
<img src="sd-debug-config-window.jpg" alt="sd-debug-config-window.jpg"/>
<div class="caption">
e&sup2; studio Debugger Configurations selection option</div></div>
</li>
<li><p class="startli">Select your debugger configuration in the window. If it is not visible then it must be created by clicking the <b>New</b> icon in the top left corner of the window. Once selected, the <b>Debug Configuration</b> window displays the Debug configuration for your Blinky project.</p>
<div class="image">
<img src="sd-debug-config-with-blinky.jpg" alt="sd-debug-config-with-blinky.jpg"/>
<div class="caption">
e&sup2; studio Debugger Configurations window with Blinky project</div></div>
</li>
<li>Click <b>Debug</b> to begin debugging the application.</li>
<li><p class="startli">Extracting RA Debug.</p>
<div class="image">
<img src="sd-extracting-ra-debug.png" alt="sd-extracting-ra-debug.png"/>
</div>
</li>
</ol>
<h3><a class="anchor" id="details-about-the-debug-process"></a>
Details about the Debug Process</h3>
<p>In debug mode, e&sup2; studio executes the following tasks:</p>
<ol type="1">
<li>Downloading the application image to the microcontroller and programming the image to the internal flash memory.</li>
<li>Setting a breakpoint at main().</li>
<li>Setting the stack pointer register to the stack.</li>
<li>Loading the program counter register with the address of the reset vector.</li>
<li>Displaying the startup code where the program counter points to.</li>
</ol>
<div class="image">
<img src="sd-debug-mem-window.png" alt="sd-debug-mem-window.png"/>
<div class="caption">
e&sup2; studio Debugger memory window</div></div>
 <h2><a class="anchor" id="run-the-blinky-project"></a>
Run the Blinky Project</h2>
<p>While in Debug mode, click <b>Run &gt; Resume</b> or click on the <b>Play</b> icon twice.</p>
<div class="image">
<img src="sd-debug-play-icon.jpg" alt="sd-debug-play-icon.jpg"/>
<div class="caption">
e&sup2; studio Debugger Play icon</div></div>
<p> The LEDs on the board marked LED1, LED2, and LED3 should now be blinking.</p>
<h1><a class="anchor" id="tutorial-using-hal-drivers-programming-the-wdt"></a>
Tutorial: Using HAL Drivers - Programming the WDT</h1>
<h2><a class="anchor" id="application-wdt"></a>
Application WDT</h2>
<p>This tutorial illustrates the creation of a simple application that uses the Watchdog Timer module to monitor program operation. The tutorial shows each step in the development process and in particular identifies the auto-generated files and project structure created when using FSP and its GUI based configurator. The level of detail provided here is more than is normally needed during development but can be helpful in explaining how FSP works behind the scenes to simplify your work.</p>
<p>This application makes use of the following FSP modules:</p>
<ul>
<li><a class="el" href="group___b_s_p___m_c_u.html">MCU Board Support Package</a></li>
<li><a class="el" href="group___w_d_t.html">Watchdog (r_wdt)</a></li>
<li><a class="el" href="group___i_o_p_o_r_t.html">I/O Port (r_ioport)</a></li>
</ul>
<h2><a class="anchor" id="creating-a-wdt-application-using-the-ra-fsp-and-e2-studio"></a>
Creating a WDT Application Using the RA MCU FSP and e² studio</h2>
<h3><a class="anchor" id="using-the-fsp-and-e2-studio"></a>
Using FSP and e² studio</h3>
<p>The Flexible Software Package (FSP) from Renesas provides a complete driver library for developing RA MCU applications. FSP provides Hardware Abstraction Layer (HAL) drivers, Board Support Package (BSP) drivers for the developer to use to create applications. FSP is integrated into Renesas e&sup2; studio based on eclipse providing build (editor, compiler and linker) and debug phases with an extended GNU Debug (GDB) interface.</p>
<h3><a class="anchor" id="the-wdt-application"></a>
The WDT Application</h3>
<p>The flowchart for the WDT application is shown below.</p>
<div class="image">
<img src="sd-wdt-app-flow.png" alt="sd-wdt-app-flow.png"/>
<div class="caption">
WDT Application flow diagram</div></div>
 <h3><a class="anchor" id="wdt-application-flow"></a>
WDT Application flow</h3>
<p>The main sections of the WDT application are:</p>
<ol type="1">
<li>The BSP initializes the clocks, pins and other elements of the MCU readying the application to run.</li>
<li><code>main()</code> calls <code>hal_entry()</code>. The function <code>hal_entry()</code> is created by FSP with a placeholder for user code. The code for the WDT is added to this function.</li>
<li>Initialize the WDT, but do not start it.</li>
<li>Start the WDT by refreshing it.</li>
<li>In the first loop the red LED flashes 30 times and refreshes the watchdog each time the LED state is changed.</li>
<li>In the second loop, the green LED flashes, but the program DOES NOT refresh the watchdog. After the watchdog timeout period the device will reset which can be observed by the red LED flashing again as the sequence repeats.</li>
</ol>
<h2><a class="anchor" id="creating-the-project-with-e2-studio"></a>
Creating the Project with e² studio</h2>
<p>Start e&sup2; studio and choose a workspace folder in the Workspace Launcher. Configure a new RA MCU project as follows.</p>
<ol type="1">
<li><p class="startli">Select <b>File &gt; New &gt; RA C/C++ Project</b>. Then select the template for the project.</p>
<div class="image">
<img src="sd-create-new-proj1.png" alt="sd-create-new-proj1.png"/>
</div>
 <div class="image">
<img src="sd-create-new-proj2.jpg" alt="sd-create-new-proj2.jpg"/>
<div class="caption">
Creating a new project</div></div>
</li>
<li><p class="startli">In the e&sup2; studio Project <b>Configuration (RA Project)</b> window enter a project name, for example, WDT_Application. In addition, select the toolchain. If you want to choose new locations for the project unselect <b>Use default location</b>. Click <b>Next</b>.</p>
<div class="image">
<img src="sd-proj-config-1.png" alt="sd-proj-config-1.png"/>
<div class="caption">
Project configuration (part 1)</div></div>
</li>
<li><p class="startli">This application runs on the EK-RA6M3 board. So, for the <b>Board</b> select <b>EK-RA6M3</b>.</p>
<p class="startli">This will automatically populate the <b>Device</b> drop-down with the correct device used on this board. Select the <b>Toolchain</b> version. Select <b>J-Link ARM</b> as the <b>Debugger</b>. Click <b>Next</b> to configure the project.</p>
<div class="image">
<img src="sd-proj-config-2.png" alt="sd-proj-config-2.png"/>
<div class="caption">
Project configuration (part 2)</div></div>
<p> The project template is now selected. As no RTOS is required select <b>Bare Metal - Blinky</b>.</p>
<div class="image">
<img src="sd-proj-config-3.png" alt="sd-proj-config-3.png"/>
<div class="caption">
Project configuration (part 3)</div></div>
</li>
<li><p class="startli">Click <b>Finish</b>.</p>
<p class="startli">e&sup2; studio creates the project and opens the <b>Project Explorer</b> and <b>Project Configuration Settings</b> views with the <b>Summary</b> page showing a summary of the project configuration.</p>
</li>
</ol>
<h2><a class="anchor" id="configuring-the-project-with-e2-studio"></a>
Configuring the Project with e² studio</h2>
<p>e&sup2; studio simplifies and accelerates the project configuration process by providing a GUI interface for selecting the options to configure the project.</p>
<p>e&sup2; studio offers a selection of perspectives presenting different windows to the user depending on the operation in progress. The default perspectives are <b>C/C++</b>, <b>FSP Configuration</b> and <b>Debug</b>. The perspective can be changed by selecting a new one from the buttons at the top right.</p>
<div class="image">
<img src="sd-select-param.jpg" alt="sd-select-param.jpg"/>
<div class="caption">
Selecting a perspective</div></div>
<p> The <b>C/C++</b> perspective provides a layout selected for code editing. The <b>FSP Configuration</b> perspective provides elements for configuring a RA MCU project, and the <b>Debug</b> perspective provides a view suited for debugging.</p>
<ol type="1">
<li>In order to configure the project settings ensure the <b>FSP Configuration</b> perspective is selected.</li>
<li>Ensure the <b>Project Configuration [WDT Application]</b> is open. It is already open if the Summary information is visible. To open the Project Configuration now or at any time make sure the <b>RA Configuration</b> perspective is selected and double-click on the <code>configuration.xml</code> file in the Project Explorer pane on the right side of e&sup2; studio.</li>
</ol>
<div class="image">
<img src="sd-ra-proj-config.jpg" alt="sd-ra-proj-config.jpg"/>
<div class="caption">
RA MCU Project Configuration Settings</div></div>
<p> At the base of the Project Configuration view there are several tabs for configuring the project. A project may require changes to some or all of these tabs. The tabs are shown below.</p>
<div class="image">
<img src="sd-proj-config-tabs.png" alt="sd-proj-config-tabs.png"/>
<div class="caption">
Project Configuration Tabs</div></div>
 <h3><a class="anchor" id="bsp-tab"></a>
BSP Tab</h3>
<p>The <b>BSP</b> tab allows the Board Support Package (BSP) options to be modified from their defaults. For this particular WDT project no changes are required. However, if you want to use the WDT in auto-start mode, you can configure the settings of the OFS0 (Option Function Select Register 0) register in the <b>BSP</b> tab. See the RA Hardware User's Manual for details on the WDT autostart mode.</p>
<h3><a class="anchor" id="clocks-tab"></a>
Clocks Tab</h3>
<p>The <b>Clocks</b> tab presents a graphical view of the clock tree of the device. The drop-down boxes in the GUI enables configuration of the various clocks. The WDT uses PCLCKB. The default output frequency for this clock is 60 MHz. Ensure this clock is outputting this value.</p>
<div class="image">
<img src="sd-clock-config.png" alt="sd-clock-config.png"/>
<div class="caption">
Clock configuration</div></div>
 <h3><a class="anchor" id="interrupts-tab"></a>
Interrupts Tab</h3>
<p>The <b>Interrupts</b> tab is used to add new user events or interrupts. No new interrupts or events are needed by the application, so no edits in this tab are required.</p>
<h3><a class="anchor" id="event-links-tab"></a>
Event Links Tab</h3>
<p>The <b>Event Links</b> tab is used to configure events used by the Event Link Controller (ELC). This project doesn't use the ELC, so no edits in this tab are required.</p>
<h3><a class="anchor" id="pins-tab"></a>
Pins Tab</h3>
<p>The <b>Pins</b> tab provides a graphical tool for configuring the functionality of the pins of the device. For the WDT project no pin configuration is required. Although the project uses two LEDs connected to pins on the device, these pins are pre-configured as output GPIO pins by the BSP.</p>
<h3><a class="anchor" id="stacks-tab"></a>
Stacks Tab</h3>
<p>You can add any driver to the project using the <b>Stacks</b> tab. The HAL driver IO port pins are added automatically by e&sup2; studio when the project is configured. The WDT application uses no RTOS Resources, so you only need to add the HAL WDT driver.</p>
<div class="image">
<img src="sd-stacks-tab.jpg" alt="sd-stacks-tab.jpg"/>
<div class="caption">
Stacks tab</div></div>
<ol type="1">
<li><p class="startli">Click on the <b>HAL/Common Panel</b> in the Threads Window as indicated in the figure above.</p>
<p class="startli">The Stacks Panel becomes a <b>HAL/Common Stacks</b> panel and is populated with the modules preselected by e&sup2; studio.</p>
</li>
<li>Click on <b>New Stack</b> to find a pop-up window with the available HAL level drivers.</li>
<li>Select <b>WATCHDOG Driver on r_wdt</b>.</li>
</ol>
<div class="image">
<img src="sd-module-select.png" alt="sd-module-select.png"/>
<div class="caption">
Module Selection</div></div>
<p> The selected HAL WDT driver is added to the <b>HAL/Common Stacks</b> Panel and the <b>Property</b> Window shows all configuration options for the selected module. The <b>Property</b> tab for the WDT should be visible at the bottom left of the screen. If it is not visible, check that the <b>FSP Configuration</b> perspective is selected.</p>
<div class="image">
<img src="sd-module-properties.png" alt="sd-module-properties.png"/>
<div class="caption">
Module Properties</div></div>
<p> All parameters can be left with their default values.</p>
<div class="image">
<img src="sd-g-wdt-on-wdt-prop.jpg" alt="sd-g-wdt-on-wdt-prop.jpg"/>
<div class="caption">
g_wdt WATCHDOG Driver on WDT properties</div></div>
<p> With PCLKB running at 60 MHz the WDT will reset the device 2.23 seconds after the last refresh.</p>
<p>WDT clock = 60 MHz / 8192 = 7.32 kHz</p>
<p>Cycle time = 1 / 7.324 kHz = 136.53 us</p>
<p>Timeout = 136.53 us x 16384 = 2.23 seconds</p>
<p>Save the <b>Project Configuration</b> file and click the <b>Generate Project Content</b> button in the top right corner of the <b>Project Configuration</b> pane.</p>
<div class="image">
<img src="gen-proj-content.png" alt="gen-proj-content.png"/>
<div class="caption">
Generate Project Content button</div></div>
<p> e&sup2; studio generates the project files.</p>
<h3><a class="anchor" id="components-tab"></a>
Components Tab</h3>
<p>The components tab is included for reference to see which modules are included in the project. Modules are selected automatically in the Components view after they are added in the Stacks Tab.</p>
<p>For the WDT project ensure that the following modules are selected:</p>
<ol type="1">
<li>HAL_Drivers -&gt; r_ioport</li>
<li>HAL_Drivers -&gt; r_wdt</li>
</ol>
<div class="image">
<img src="sd-component-select.png" alt="sd-component-select.png"/>
<div class="caption">
Component Selection</div></div>
 <dl class="section note"><dt>Note</dt><dd>The list of modules displayed in the Components tab depends on the installed FSP version.</dd></dl>
<h2><a class="anchor" id="wdt-generated-project-files"></a>
WDT Generated Project Files</h2>
<p>Clicking the Generate Project Content button performs the following tasks.</p>
<ul>
<li><p class="startli"><code>r_wdt</code> folder and WDT driver contents created at:</p>
<p class="startli"><code>ra/fsp/src</code></p>
</li>
<li><p class="startli"><code>r_wdt_api.h</code> created in:</p>
<p class="startli"><code>ra/fsp/inc/api</code></p>
</li>
<li><p class="startli"><code>r_wdt.h</code> created in:</p>
<p class="startli"><code>ra/fsp/inc/instances</code></p>
</li>
</ul>
<p>The above files are the standard files for the WDT HAL module. They contain no specific project contents. They are the driver files for the WDT. Further information on the contents of these files can be found in the documentation for the WDT HAL module.</p>
<p>Configuration information for the WDT HAL module in the WDT project is found in:</p>
<p><code>ra_cfg/fsp_cfg/r_wdt_cfg.h</code></p>
<p>The above file's contents are based upon the <b>Common</b> settings in the <b>g_wdt WATCHDOG Driver on WDT Properties</b> pane.</p>
<div class="image">
<img src="sd-r_wdt_cfg.h-contents.png" alt="sd-r_wdt_cfg.h-contents.png"/>
<div class="caption">
r_wdt_cfg.h contents</div></div>
 <dl class="section warning"><dt>Warning</dt><dd>Do not edit any of these files as they are recreated every time the Generate Project Content button is clicked and so any changes will be overwritten.</dd></dl>
<p>The <code>r_ioport</code> folder is not created at <code>ra/fsp/src</code> as this module is required by the BSP and so already exists. It is included in the WDT project in order to include the correct header file in <code>ra_gen/hal_data.c</code>&ndash;see later in this document for further details. For the same reason the other IOPORT header files&ndash; <code>ra/fsp/inc/api/r_ioport_api.h</code>and<code>ra/fsp/inc/instances/r_ioport.h</code>&ndash;are not created as they already exist.</p>
<p>In addition to generating the HAL driver files for the WDT and IOPORT files e&sup2; studio also generates files containing configuration data for the WDT and a file where user code can safely be added. These files are shown below.</p>
<div class="image">
<img src="sd-wdt-proj-files.png" alt="sd-wdt-proj-files.png"/>
<div class="caption">
WDT project files</div></div>
 <h3><a class="anchor" id="wdt-hal-data-h"></a>
WDT hal_data.h</h3>
<p>The contents of <code>hal_data.h</code> are shown below.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* generated HAL header file - do not edit */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef HAL_DATA_H_</span></div><div class="line"><span class="preprocessor"> #define HAL_DATA_H_</span></div><div class="line"></div><div class="line"><span class="preprocessor"> #include &lt;stdint.h&gt;</span></div><div class="line"><span class="preprocessor"> #include &quot;bsp_api.h&quot;</span></div><div class="line"><span class="preprocessor"> #include &quot;common_data.h&quot;</span></div><div class="line"><span class="preprocessor"> #include &quot;r_wdt.h&quot;</span></div><div class="line"><span class="preprocessor"> #include &quot;r_wdt_api.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor"> #ifdef __cplusplus</span></div><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span></div><div class="line">{</div><div class="line"><span class="preprocessor"> #endif</span></div><div class="line"></div><div class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="group___w_d_t___a_p_i.html#structwdt__instance__t">wdt_instance_t</a> g_wdt0;</div><div class="line"></div><div class="line"><span class="preprocessor"> #ifndef NULL</span></div><div class="line"><span class="keywordtype">void</span> NULL(<a class="code" href="group___w_d_t___a_p_i.html#structwdt__callback__args__t">wdt_callback_args_t</a> * p_args);</div><div class="line"></div><div class="line"><span class="preprocessor"> #endif</span></div><div class="line"></div><div class="line"><span class="keyword">extern</span> <a class="code" href="group___w_d_t.html#structwdt__instance__ctrl__t">wdt_instance_ctrl_t</a> g_wdt0_ctrl;</div><div class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="group___w_d_t___a_p_i.html#structwdt__cfg__t">wdt_cfg_t</a>     g_wdt0_cfg;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> hal_entry(<span class="keywordtype">void</span>);</div><div class="line"><span class="keywordtype">void</span> g_hal_init(<span class="keywordtype">void</span>);</div><div class="line"></div><div class="line"><span class="preprocessor"> #ifdef __cplusplus</span></div><div class="line">}                                      <span class="comment">/* extern &quot;C&quot; */</span></div><div class="line"><span class="preprocessor"> #endif</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif                                 </span><span class="comment">/* HAL_DATA_H_ */</span><span class="preprocessor"></span></div><div class="line"></div></div><!-- fragment --><p> <code>hal_data.h</code> contains the header files required by the generated project. In addition this file includes external references to the <b>g_wdt0</b> instance structure which contains pointers to the configuration, control, api structures used for WDT HAL driver.</p>
<dl class="section warning"><dt>Warning</dt><dd>This file is regenerated each time Generate Project Content is clicked and must not be edited.</dd></dl>
<h3><a class="anchor" id="wdt-hal-data-c"></a>
WDT hal_data.c</h3>
<p>The contents of <code>hal_data.c</code> are shown below.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* generated HAL source file - do not edit */</span></div><div class="line"><span class="preprocessor">#include &quot;hal_data.h&quot;</span></div><div class="line"><a class="code" href="group___w_d_t.html#structwdt__instance__ctrl__t">wdt_instance_ctrl_t</a> g_wdt0_ctrl;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <a class="code" href="group___w_d_t___a_p_i.html#structwdt__cfg__t">wdt_cfg_t</a> g_wdt0_cfg =</div><div class="line">{</div><div class="line">    .<a class="code" href="group___w_d_t___a_p_i.html#a32ddaf9b3fd7bab2b654e660588ac680">timeout</a>        = <a class="code" href="group___w_d_t___a_p_i.html#gga880fcf63a5220c6618a0cf380268a76cacd016302c00b39880d3828d18467833e">WDT_TIMEOUT_16384</a>,</div><div class="line">    .clock_division = <a class="code" href="group___w_d_t___a_p_i.html#gga6b0f563a6311763e6204add68a018089a379cad22ab77f5b144788ae4fb82e7af">WDT_CLOCK_DIVISION_8192</a>,</div><div class="line">    .window_start   = <a class="code" href="group___w_d_t___a_p_i.html#gga9e0c1284f5d75d4a090d988536e3f633a8677bab323b9b04737bf003bc8c68703">WDT_WINDOW_START_100</a>,</div><div class="line">    .window_end     = <a class="code" href="group___w_d_t___a_p_i.html#gga62d4360afabd1652aa7a1b9f624d7f61ad9fd7f9a41a89a9d67f0b8c37cbfdc12">WDT_WINDOW_END_0</a>,</div><div class="line">    .reset_control  = <a class="code" href="group___w_d_t___a_p_i.html#gga7624d80dde311cb1289f558ea464fa63a71f32c409072999582d4e4afb789b096">WDT_RESET_CONTROL_RESET</a>,</div><div class="line">    .stop_control   = <a class="code" href="group___w_d_t___a_p_i.html#gga803dd68cafce3a3d9ca5630b8c4838daa7dda22fd5a14857cc859222620b71368">WDT_STOP_CONTROL_ENABLE</a>,</div><div class="line">    .p_callback     = NULL,</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">/* Instance structure to use this module. */</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="group___w_d_t___a_p_i.html#structwdt__instance__t">wdt_instance_t</a> g_wdt0 =</div><div class="line">{.<a class="code" href="group___w_d_t___a_p_i.html#ac301430918784342b3f136d2afc705a7">p_ctrl</a> = &amp;g_wdt0_ctrl, .p_cfg = &amp;g_wdt0_cfg, .p_api = &amp;g_wdt_on_wdt};</div><div class="line"><span class="keywordtype">void</span> g_hal_init (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    g_common_init();</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p> <code>hal_data.c</code> contains <code>g_wdt0_ctrl</code> which is the control structure for this instance of the WDT HAL driver. This structure should not be initialized as this is done by the driver when it is opened.</p>
<p>The contents of <code>g_wdt0_cfg</code> are populated in this file using the <b>Watchdog Driver on g_wdt0</b> pane in the Project Configuration <b>Stacks</b> tab. If the contents of this structure do not reflect the settings made in the IDE, ensure the <b>Project Configuration</b> settings are saved before clicking the <b>Generate Project Content</b> button.</p>
<dl class="section warning"><dt>Warning</dt><dd>This file is regenerated each time Generate Project Content is clicked and so should not be edited.</dd></dl>
<h3><a class="anchor" id="wdt-main-c"></a>
WDT main.c</h3>
<p>Contains <code>main()</code> called by the BSP start-up code. <code>main()</code> calls <code>hal_entry()</code> which contains user developed code (see next file). Here are the contents of <code>main.c</code>.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* generated main source file - do not edit*/</span></div><div class="line"><span class="preprocessor">#include &quot;hal_data.h&quot;</span></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>)</div><div class="line"></div><div class="line">{</div><div class="line">    hal_entry();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <dl class="section warning"><dt>Warning</dt><dd>This file is regenerated each time Generate Project Content is clicked and so should not be edited.</dd></dl>
<h3><a class="anchor" id="wdt-hal-entry-c"></a>
WDT hal_entry.c</h3>
<p>This file contains the function <code>hal_entry()</code> called from <code>main()</code>. User developed code should be placed in this file and function.</p>
<p>For the WDT project edit the contents of this file to contain the code below. This code implements the flowchart in overview section of this document.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;hal_data.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;bsp_pin_cfg.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;r_ioport.h&quot;</span></div><div class="line"><span class="preprocessor">#define RED_LED_NO_OF_FLASHES    30</span></div><div class="line"><span class="preprocessor">#define RED_LED_PIN              BSP_IO_PORT_01_PIN_00</span></div><div class="line"><span class="preprocessor">#define GREEN_LED_PIN            BSP_IO_PORT_04_PIN_00</span></div><div class="line"><span class="preprocessor">#define RED_LED_DELAY_MS         125</span></div><div class="line"><span class="preprocessor">#define GREEN_LED_DELAY_MS       250</span></div><div class="line"><span class="keyword">volatile</span> uint32_t delay_counter;</div><div class="line"><span class="keyword">volatile</span> uint16_t loop_counter;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___b_s_p___m_c_u.html#ga662624feaff3850ffbe7fb118ab140d7">R_BSP_WarmStart</a>(<a class="code" href="group___b_s_p___m_c_u.html#ga6fe6dc3c0813eeae8665430a31c005b4">bsp_warm_start_event_t</a> event);</div><div class="line"></div><div class="line"><span class="comment">/*******************************************************************************************************************/</span></div><div class="line"><span class="keywordtype">void</span> hal_entry (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="comment">/* Allow the WDT to run when the debugger is connected */</span></div><div class="line">    R_DEBUG-&gt;DBGSTOPCR_b.DBGSTOP_WDT = 0;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Open the WDT */</span></div><div class="line">    <a class="code" href="group___w_d_t.html#gad64d0778fd0ceccb13a7287bb0d1fca8">R_WDT_Open</a>(&amp;g_wdt0_ctrl, &amp;g_wdt0_cfg);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Start the WDT by refreshing it */</span></div><div class="line">    <a class="code" href="group___w_d_t.html#gaff080d0dcc993cfbe7e99771396feffb">R_WDT_Refresh</a>(&amp;g_wdt0_ctrl);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Flash the red LED and feed the WDT for a few seconds */</span></div><div class="line">    <span class="keywordflow">for</span> (loop_counter = 0; loop_counter &lt; RED_LED_NO_OF_FLASHES; loop_counter++)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Turn red LED on */</span></div><div class="line">        <a class="code" href="group___i_o_p_o_r_t.html#ga1b17ca2e38acde207881e7e4ba2a7e28">R_IOPORT_PinWrite</a>(&amp;g_ioport_ctrl, RED_LED_PIN, <a class="code" href="group___b_s_p___i_o.html#ggab4ef0cc3fce421d48310f23c614aadc0abb31064742440cdbdd638330a1cf7a9f">BSP_IO_LEVEL_LOW</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Delay */</span></div><div class="line">        <a class="code" href="group___b_s_p___m_c_u.html#ga04da4b0c795fdf43432869f4a87065fe">R_BSP_SoftwareDelay</a>(RED_LED_DELAY_MS, <a class="code" href="group___b_s_p___m_c_u.html#ggafd98e2a6f080d6a52a3ef72e3d731b2ba59fcc4e8d51046d4a1bd63c87ac64913">BSP_DELAY_UNITS_MILLISECONDS</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Refresh WDT */</span></div><div class="line">        <a class="code" href="group___w_d_t.html#gaff080d0dcc993cfbe7e99771396feffb">R_WDT_Refresh</a>(&amp;g_wdt0_ctrl);</div><div class="line">        <a class="code" href="group___i_o_p_o_r_t.html#ga1b17ca2e38acde207881e7e4ba2a7e28">R_IOPORT_PinWrite</a>(&amp;g_ioport_ctrl, RED_LED_PIN, <a class="code" href="group___b_s_p___i_o.html#ggab4ef0cc3fce421d48310f23c614aadc0acf9a28559b5a18ed9b8af4c2a7df10ef">BSP_IO_LEVEL_HIGH</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Delay */</span></div><div class="line">        <a class="code" href="group___b_s_p___m_c_u.html#ga04da4b0c795fdf43432869f4a87065fe">R_BSP_SoftwareDelay</a>(RED_LED_DELAY_MS, <a class="code" href="group___b_s_p___m_c_u.html#ggafd98e2a6f080d6a52a3ef72e3d731b2ba59fcc4e8d51046d4a1bd63c87ac64913">BSP_DELAY_UNITS_MILLISECONDS</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Refresh WDT */</span></div><div class="line">        <a class="code" href="group___w_d_t.html#gaff080d0dcc993cfbe7e99771396feffb">R_WDT_Refresh</a>(&amp;g_wdt0_ctrl);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Flash green LED but STOP feeding the WDT. WDT should reset the</span></div><div class="line"><span class="comment">     * device */</span></div><div class="line">    <span class="keywordflow">while</span> (1)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Turn green LED on */</span></div><div class="line">        <a class="code" href="group___i_o_p_o_r_t.html#ga1b17ca2e38acde207881e7e4ba2a7e28">R_IOPORT_PinWrite</a>(&amp;g_ioport_ctrl, GREEN_LED_PIN, <a class="code" href="group___b_s_p___i_o.html#ggab4ef0cc3fce421d48310f23c614aadc0abb31064742440cdbdd638330a1cf7a9f">BSP_IO_LEVEL_LOW</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Delay */</span></div><div class="line">        <a class="code" href="group___b_s_p___m_c_u.html#ga04da4b0c795fdf43432869f4a87065fe">R_BSP_SoftwareDelay</a>(GREEN_LED_DELAY_MS, <a class="code" href="group___b_s_p___m_c_u.html#ggafd98e2a6f080d6a52a3ef72e3d731b2ba59fcc4e8d51046d4a1bd63c87ac64913">BSP_DELAY_UNITS_MILLISECONDS</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Turn green off */</span></div><div class="line">        <a class="code" href="group___i_o_p_o_r_t.html#ga1b17ca2e38acde207881e7e4ba2a7e28">R_IOPORT_PinWrite</a>(&amp;g_ioport_ctrl, GREEN_LED_PIN, <a class="code" href="group___b_s_p___i_o.html#ggab4ef0cc3fce421d48310f23c614aadc0acf9a28559b5a18ed9b8af4c2a7df10ef">BSP_IO_LEVEL_HIGH</a>);</div><div class="line"></div><div class="line">        <span class="comment">/* Delay */</span></div><div class="line">        <a class="code" href="group___b_s_p___m_c_u.html#ga04da4b0c795fdf43432869f4a87065fe">R_BSP_SoftwareDelay</a>(GREEN_LED_DELAY_MS, <a class="code" href="group___b_s_p___m_c_u.html#ggafd98e2a6f080d6a52a3ef72e3d731b2ba59fcc4e8d51046d4a1bd63c87ac64913">BSP_DELAY_UNITS_MILLISECONDS</a>);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/*******************************************************************************************************************/</span></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___b_s_p___m_c_u.html#ga662624feaff3850ffbe7fb118ab140d7">R_BSP_WarmStart</a> (<a class="code" href="group___b_s_p___m_c_u.html#ga6fe6dc3c0813eeae8665430a31c005b4">bsp_warm_start_event_t</a> event)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___b_s_p___m_c_u.html#gga6fe6dc3c0813eeae8665430a31c005b4a682d5dad980652c1acbc5b04531f6da2">BSP_WARM_START_RESET</a> == event)</div><div class="line">    {</div><div class="line"><span class="preprocessor">#if BSP_FEATURE_FLASH_LP_VERSION != 0</span></div><div class="line"></div><div class="line">        <span class="comment">/* Enable reading from data flash. */</span></div><div class="line">        R_FACI_LP-&gt;DFLCTL = 1U;</div><div class="line"></div><div class="line">        <span class="comment">/* Would normally have to wait for tDSTOP(6us) for data flash recovery. Placing the enable here, before clock and</span></div><div class="line"><span class="comment">         * C runtime initialization, should negate the need for a delay since the initialization will typically take more than 6us. */</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___b_s_p___m_c_u.html#gga6fe6dc3c0813eeae8665430a31c005b4af322ff0740a8d31f831b98ff042f0811">BSP_WARM_START_POST_C</a> == event)</div><div class="line">    {</div><div class="line">        <span class="comment">/* C runtime environment and system clocks are setup. */</span></div><div class="line"></div><div class="line">        <span class="comment">/* Configure pins. */</span></div><div class="line">        <a class="code" href="group___i_o_p_o_r_t.html#ga24938047dccc62c4426ff543489454de">R_IOPORT_Open</a>(&amp;IOPORT_CFG_CTRL, &amp;IOPORT_CFG_NAME);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p> The WDT HAL driver API functions are defined in <code>r_wdt.h</code>. The WDT HAL driver is opened through the open API call using the instance structure defined in <code>r_wdt_api.h</code>:</p>
<div class="fragment"><div class="line"></div><div class="line">    <span class="comment">/* Open the WDT */</span></div><div class="line">    <a class="code" href="group___w_d_t.html#gad64d0778fd0ceccb13a7287bb0d1fca8">R_WDT_Open</a>(&amp;g_wdt0_ctrl, &amp;g_wdt0_cfg);</div><div class="line"></div></div><!-- fragment --><p> The first passed parameter is the pointer to the control structure <code>g_wdt0_ctrl</code> instantiated in <code>hal_data.c</code>. The second parameter is the pointer to the configuration data <code>g_wdto_cfg</code> instantiated in the same <code>hal_data.c</code> file.</p>
<p>The WDT is started and refreshed through the API call:</p>
<div class="fragment"><div class="line"></div><div class="line">    <span class="comment">/* Start the WDT by refreshing it */</span></div><div class="line">    <a class="code" href="group___w_d_t.html#gaff080d0dcc993cfbe7e99771396feffb">R_WDT_Refresh</a>(&amp;g_wdt0_ctrl);</div><div class="line"></div></div><!-- fragment --><p> Again the first (and only in this case) parameter passed to this API is the pointer to the control structure of this instance of the driver.</p>
<h2><a class="anchor" id="building-and-testing-the-project"></a>
Building and Testing the Project</h2>
<p>Build the project in e&sup2; studio by clicking <b>Build &gt; Build Project</b> or by clicking the build icon. The project should build without errors.</p>
<p>To debug the project</p>
<ol type="1">
<li>Connect the USB cable between the target board debug port and host PC.</li>
<li>In the <b>Project Explorer</b> pane on the left side of e&sup2; studio, right-click on the WDT project <b>WDT_Application</b> and select <b>Debug As &gt; Debug Configurations</b>.</li>
<li><p class="startli">Under <b>Renesas GDB Hardware Debugging</b> select <b>WDT_Application Debug</b> as shown below.</p>
<div class="image">
<img src="sd-debug-config.jpg" alt="sd-debug-config.jpg"/>
<div class="caption">
Debug configuration</div></div>
</li>
<li><p class="startli">Click the <b>Debug</b> button. Click Yes to the debug perspective if asked.</p>
<div class="image">
<img src="sd-extracting-ra-debug.png" alt="sd-extracting-ra-debug.png"/>
</div>
</li>
<li>The code should run the <code><a class="el" href="group___b_s_p___m_c_u.html#ga4fd935a08e0d5096d1fdf2ff39379887">Reset_Handler()</a></code> function.</li>
<li>Resume execution via <b>Run &gt; Resume</b>. Execution will stop in <code>main()</code> at the call to <code>hal_entry()</code>.</li>
<li>Resume execution again.</li>
</ol>
<p>The red LED should start flashing. After 30 flashes the green LED will start flashing and the red LED will stop flashing.</p>
<p>While the green LED is flashing the WDT will underflow and reset the device resulting in the red LED to flash again as the sequence repeats.</p>
<ol type="1">
<li>Stop the debugger in e&sup2; studio via <b>Run &gt; Terminate</b>.</li>
<li>Click the reset button on the target board. The LEDs begin flashing.</li>
</ol>
<h1><a class="anchor" id="primer-trustzone-project-development"></a>
Primer: Arm TrustZone Project Development</h1>
<p>This section will introduce the user to the tools supporting Arm® TrustZone® technology configuration for the RA Family of microcontrollers. It is intended to be read by development engineers implementing RA Arm TrustZone projects for the first time. It will introduce basic concepts followed by workflow and tooling functions designed to simplify and accelerate their first Arm TrustZone development. A background knowledge of e&sup2; studio and RA device hardware is expected.</p>
<h2><a class="anchor" id="target-device"></a>
Target Device</h2>
<p>RA Cortex®-M33 and Cortex®-M85 devices with Arm TrustZone security extension. As shown in the following table, most RA devices that include TrustZone support also support Device Lifecycle Management (DLM).</p>
<table class="doxtable">
<tr>
<th>MCU Groups with TrustZone and DLM </th><th>MCU Groups with TrustZone and no DLM </th><th>MCU Groups with TrustZone and Alternate DLM  </th></tr>
<tr>
<td>RA4E1, RA4M2, RA4M3, RA6E1, RA6M4, RA6M5, RA6T2 </td><td>RA4E2, RA4T1, RA6E2, RA6T3 </td><td>RA8M1 </td></tr>
</table>
<h2><a class="anchor" id="renesas-implementation-of-arm-trustzone-technology"></a>
Renesas Implementation of Arm TrustZone Technology</h2>
<p>The following section is supplied for reference only. For full details of TrustZone implementation, refer to Arm documentation (<a href="https://developer.arm.com/ip-products/security-ip/trustzone">https://developer.arm.com/ip-products/security-ip/trustzone</a>) and the MCU user manual.</p>
<p>Arm TrustZone technology divides the MCU and therefore the application into Secure and Non-Secure partitions. Secure applications can access both Secure and Non-Secure memory and resources. Non-Secure code can access Non-Secure memory and resources as well as Secure resources through a set of so-called veneers located in the Non-Secure Callable (NSC) region. This ensures a single access point for Secure code when called from the Non-Secure partition. The MCU starts up in the Secure partition by default. The security state of the CPU can be either Secure or Non-Secure.</p>
<p>The MCU code flash, data flash, and SRAM are divided into Secure (S) and Non-Secure (NS) regions. Code flash and SRAM include a further region known as Non-Secure Callable (NSC). The method to set these memory security attributes depends on whether the device supports DLM:</p>
<ul>
<li>For devices that support DLM, memory security attributes are set into the non-volatile memory through SCI or USB boot mode commands when the device lifecycle is Secure Software Debug (SSD) state. The memory security attributes are loaded into the Implementation Defined Attribution Unit (IDAU) peripheral and the memory controller before application execution and cannot be updated by application code.</li>
<li>For devices that do not support DLM, memory security attributes are written to IDAU registers at startup by application code using secure accesses.</li>
</ul>
<div class="image">
<img src="tz-secure-nonsecure.png" alt="tz-secure-nonsecure.png"/>
<div class="caption">
Secure and Non-Secure Regions</div></div>
<p> Note: All external memory accesses are considered to be Non-Secure.</p>
<p>Code Flash and SRAM can be divided into Secure, Non-Secure, and Non-Secure Callable. All secure memory accesses from the Non-Secure region MUST go through the Non-Secure Callable gateway and target a specific Secure Gateway (SG) assembler instruction. This forces access to Secure APIs at a fixed location and prevents calls to sub-functions and so on. Failing to target an SG instruction will generate a TrustZone exception.</p>
<p>TrustZone enabled compilers will manage generation of the NSC veneer automatically using CMSE extensions.</p>
<h3><a class="anchor" id="calling-from-non-secure-to-secure"></a>
Calling from Non-Secure to Secure</h3>
<p>A new instruction SG (Secure Gateway) has been added to the Armv8-M architecture. This MUST be the destination instruction for any branch within the Non-Secure Callable region. If an attempt is made to branch to any other instruction from the Non-Secure partition, a TrustZone exception will be thrown.</p>
<div class="image">
<img src="tz-non-secure-to-secure-calling.png" alt="tz-non-secure-to-secure-calling.png"/>
<div class="caption">
Calling from Non-Secure to Secure Functions</div></div>
 <h3><a class="anchor" id="calling-from-secure-to-non-secure"></a>
Calling from Secure to Non-Secure</h3>
<p>Secure code uses B(L)XNS instructions to make direct calls to Non-Secure functions. While this is certainly possible, it can create a security vulnerability in the application. It is also challenging for the Secure application to determine the address of the non-secure function during build phase. From the RA Tools and FSP point view, calling directly from Secure to Non-Secure via FSP API is not supported.</p>
<p>Preference is for the Secure code to initialise as necessary from reset, then pass control to the Non-Secure partition. It will manage any data transfers and so forth via FSP call-backs as security checks. For example, secure data can be copied to Non-Secure RAM.</p>
<div class="image">
<img src="tz-secure-to-non-secure-calling.png" alt="tz-secure-to-non-secure-calling.png"/>
<div class="caption">
Calling from Secure to Non-Secure Functions</div></div>
 <h2><a class="anchor" id="workflow"></a>
Workflow</h2>
<p>Arm TrustZone MCU development normally consists of two projects within a workspace, Secure and Non-Secure. General project workflows are described in the following sections. The Renesas project generator also supports development with "Flat project" model with no Arm TrustZone awareness.</p>
<h3><a class="anchor" id="secure-project"></a>
Secure Project</h3>
<ol type="1">
<li>Start a new Secure project in e&sup2; studio.</li>
<li>Select and configure pins and drivers/stacks that need to be initialized and used in Secure mode. This should be kept to a minimum to reduce the security attack surface.</li>
<li>Expose top of stacks as Non-Secure Callable (NSC) <em><b>if</b></em> they need to be accessed from Non-Secure partition. Again, this should be kept to a minimum.</li>
<li>Generate project content and write Secure code such as key handling and opening drives as needed.</li>
<li>Modify/remove any unnecessary "Guard" functions as needed to control access via NSC.</li>
<li>Build project.</li>
<li>A Non-Secure project will be needed before debugging. If necessary, prepare a "dummy" Non-Secure project or replace <code>R_BSP_NonSecureEnter();</code> with <code>while(1);</code> in <code>hal_entry.c</code>.</li>
</ol>
<h3><a class="anchor" id="non-secure-project"></a>
Non-Secure Project</h3>
<ol type="1">
<li>Start a new Non-Secure project.</li>
<li>If you have access to the Secure project, choose this option. However, if you only have access to a device with pre-programmed Secure code (commonly referred to as provisioned device) choose "Secure Bundle".</li>
<li>Select and configure pins and drivers/stacks that need to be initialized and used in Non-Secure mode.</li>
<li>Note that you can add NSC drivers and stacks as needed.</li>
<li>Generate project content and write Non-Secure code as needed</li>
<li>Access NSC drivers and Stacks via Guard functions.</li>
<li>Build and debug project.</li>
</ol>
<h3><a class="anchor" id="flat-project"></a>
Flat Project</h3>
<p>A flat project does not technically use Arm TrustZone as the developer has made a decision to place the entire application in Secure partition from restart.</p>
<p>Notes:</p>
<ul>
<li>Any code placed in external memory (such as OSPI or QSPI) will be Non-Secure.</li>
<li>The Ethernet EDMAC is designed to be a Non-Secure bus master so associated Ethernet RAM buffers will be placed in Non-Secure RAM. The tooling will automatically manage this.</li>
</ul>
<p>The workflow is as follows:</p>
<ol type="1">
<li>Start a new Flat project.</li>
<li>Select and configure pins and drivers/stacks as needed.</li>
<li>Generate project content and write code as needed.</li>
<li>Build and debug project.</li>
</ol>
<h2><a class="anchor" id="ra-project-generator-pg"></a>
RA Project Generator (PG)</h2>
<p>The RA project generators have been created to help users through setting up new TrustZone enabled projects. User will be prompted for project settings such as Project Type (Secure, Non-Secure, or Flat), compiler, RTOS and debugger. Care is needed when setting up a TrustZone project to ensure that the connection between Secure and Non-Secure partitions are managed correctly.</p>
<div class="image">
<img src="tz-secure-proj.png" alt="tz-secure-proj.png"/>
<div class="caption">
Secure Project (following Arm notation as green)</div></div>
 <div class="image">
<img src="tz-non-secure-proj.png" alt="tz-non-secure-proj.png"/>
<div class="caption">
Non-Secure Project (following Arm notation as red)</div></div>
 <div class="image">
<img src="tz-flat-proj.png" alt="tz-flat-proj.png"/>
<div class="caption">
Flat Project</div></div>
 <h3><a class="anchor" id="secure-project-set-up"></a>
Secure Project Set Up</h3>
<p>All code, data, and peripherals in this project will be configured as Secure using the device Peripheral Security Attribution (PSA) registers. Although it is very application specific, we recommend keeping the Secure project code as small as possible to reduce the attack surface. For example, secure key handling may be the only application code in the secure project.</p>
<p>Necessary values to set up the TrustZone memory partition (IDAU registers) will be automatically calculated after the project is built to ensure they match the code and data size, keeping the attack surface as small as possible.</p>
<p>Typically, ANSI C start up code (clearing of RAM, variable initialisation, etc) , clock, and secure peripheral initialisation will occur in this project.</p>
<p>At the end of the Secure code, a call will be made to <code>R_BSP_NonSecureEnter();</code> to pass control to the Non-Secure partition.</p>
<p>Non-Secure Callable (NSC) "Guard" functions are added to the project and expose selected modules to Non-Secure projects. User can add application-specific access checks as needed in these functions.</p>
<p>Output of this project type will be an elf file that must be either pre-programmed (provisioned) into a device or referenced by a Non-Secure project (via Secure bundle <code>*.SBD</code>) to build a final image.</p>
<p>This project type will NOT typically be debugged in isolation and will normally require a Non-Secure project such as a call to a <code>R_BSP_NonSecureEnter()</code> to be made. This can be replaced with <code>while(1);</code> if needed.</p>
<h3><a class="anchor" id="rtos-support-in-tz-project"></a>
RTOS Support in TrustZone Project</h3>
<p>Although the RTOS kernel and user tasks will reside in the Non-Secure partition, the Secure partition needs to allocate stack space and so on. It is essential when starting a new RTOS project that the TrustZone Secure RTOS-Minimal template is selected. This will add the Arm TrustZone Context RA Port as below.</p>
<div class="image">
<img src="tz-secure-rtos-min-a.png" alt="tz-secure-rtos-min-a.png"/>
</div>
<div class="image">
<img src="tz-secure-rtos-min-b.png" alt="tz-secure-rtos-min-b.png"/>
<div class="caption">
Secure RTOS-Minimal Template</div></div>
 <h3><a class="anchor" id="peripheral-security-attribution"></a>
Peripheral Security Attribution</h3>
<p>Each peripheral can be configured to be Secure or Non-Secure. Peripherals are divided into two types.</p>
<p>Type-1 peripherals have one security attribute. Access to all registers is controlled by one security attribute. The Type-1 peripheral security attribute is set in the PSARx (x = B to E) register by the secure application.</p>
<p>Type-2 peripherals have the security attribute for each register or for each bit. Access to each register or bit field is controlled according to these security attributes. The Type-2 peripheral security attribute is set in the Security Attribution register in each module by the Secure application. For more information about the Security Attribution register, see sections in the Appropriate MCU’s User’s Manual for each peripheral.</p>
<p>Table 1. Secure and Non-Secure Peripherals</p>
<table class="doxtable">
<tr>
<th>Type </th><th>Peripheral  </th></tr>
<tr>
<td>Type 1 </td><td>SCI, SPI, USBFS, CAN, IIC, SCE9, DOC, SDHI, SSIE, CTSU, CRC, CAC, TSN, ADC12, DAC12, POEG, AGT, GPT, RTC, IWDT, WDT </td></tr>
<tr>
<td>Type 2 </td><td>System control (Resets, LVD, Clock Generation Circuit, Low Power Modes, Battery Backup Function), FLASH CACHE, SRAM controller, CPU CACHE, DMAC, DTC, ICU, MPU, BUS, Security setting, ELC, I/O ports </td></tr>
<tr>
<td>Always Non-Secure </td><td>CS Area Controller, QSPI, OSPI, ETHERC, EDMAC </td></tr>
</table>
<p>FSP will initialise the arbitration registers during Secure project BSP start up. User code may also be written to set or clear further arbitration. However care must be taken not to undermine FSP.</p>
<h3><a class="anchor" id="non-secure"></a>
Non-Secure</h3>
<p>All code, data, and peripherals in this project will be configured as Non-Secure. This project type must be associated with a Secure project to enable access to secure code, peripherals, linker scripts and others.</p>
<h3><a class="anchor" id="flat-project-type"></a>
Flat Project Type</h3>
<p>All code, data, and peripherals are configured in a Secure single partition except for the EDMAC RAM buffers that will remain in the Non-Secure partition. Effectively, TrustZone is disabled.</p>
<h3><a class="anchor" id="secure-connection-to-non-secure-project"></a>
Secure Connection to Non-Secure Project</h3>
<p>When starting a new Non-Secure Project, the user will be prompted for either a Secure Project or Secure Bundle. In each case, details of the linker settings, Non-Secure Callable functions, and Secure peripherals will be read to enable the Non-Secure project setup.</p>
<p>Should the Secure project or bundle be rebuilt, the Non-Secure editor will detect this and prompt user to regenerate the Non-Secure project configuration.</p>
<div class="image">
<img src="tz-secure-proj-or-bundle.png" alt="tz-secure-proj-or-bundle.png"/>
<div class="caption">
Secure Project or Bundle Selection</div></div>
 <h4><a class="anchor" id="secure-project-combined"></a>
Secure Project (Combined)</h4>
<p>A Secure project must reside in the same Workspace as the Non-Secure project and will typically be used when a design engineer has access to both the Secure and Non-Secure project sources. This is sometimes known as "Combined model".</p>
<p>A Secure <code>.elf</code> file will be referenced and included in the debug configuration for download to the target device. The development engineer will have visibility of Secure and Non-Secure project source code and configuration.</p>
<h4><a class="anchor" id="secure-bundle-split"></a>
Secure Bundle (Split)</h4>
<p>A Secure Bundle will ONLY include linker memory ranges, symbol references, and details of locked Secure peripheral configuration settings but no access to Secure source code (API header files will be included as necessary).</p>
<p>The Secure bundle file (*.SBD) must be supplied to the Non-Secure developer by the Secure project developer.</p>
<p>The development engineer will typically not have access to the Secure project or <code>.elf</code> file which MUST be pre-programmed or provisioned into the target MCU.</p>
<p>For devices that support DLM, the DLM state of the target device should then be switched to NSECSD (see section 6.2) before the device is provided to the non-secure developer.</p>
<p>This is often referred to as "Split model" where a basic security set up is developed by a Secure team and then passed to the Non-Secure team in the same facility or at a third party. The Non-Secure team has no access to the Secure source code and cannot directly access Secure peripherals, data, or APIs.</p>
<h3><a class="anchor" id="debug-configurations"></a>
Debug Configurations</h3>
<p>After each project type has been selected, a suitable debug configuration will be generated.</p>
<h4><a class="anchor" id="non-secure-with-secure-project-combined"></a>
Non-Secure with Secure Project (Combined)</h4>
<p>Both Secure and Non-Secure <code>.elf</code> files will be downloaded.</p>
<p>A debug configuration called <code>&lt;project name&gt;_SSD</code> will be generated.</p>
<h4><a class="anchor" id="non-secure-with-secure-bundle-split"></a>
Non-Secure with Secure Bundle (Split)</h4>
<p>Only a Non-Secure elf will be downloaded. This configuration must be used with a pre-provisioned device (Secure project pre-programmed into MCU Flash).</p>
<p>A debug configuration called <code>&lt;project name&gt;_NSECSD</code> will be generated.</p>
<h4><a class="anchor" id="flat-debug"></a>
Flat Debug</h4>
<p>A single <code>.elf</code> file will be downloaded.</p>
<p>A debug configuration called <code>&lt;project name&gt;_FLAT</code> will be generated.</p>
<h2><a class="anchor" id="secure-projects"></a>
Secure Projects</h2>
<p>As mentioned, Secure code will be called immediately after device reset and run ANSI C start up, clock, interrupt vector table, and secure peripheral initialization before starting user code. All selected peripheral configuration settings will be automatically initialised as Secure.</p>
<h3><a class="anchor" id="secure-clock"></a>
Secure Clock</h3>
<p>Device clock settings are the possible exception in that they will be initialised in the Secure project (to enable faster start up from reset) but can be set as Secure or Non-Secure as user application may need to change settings during execution (for low-power mode and so on). The Secure and Non-Secure FSP BSPs can both change the clock settings.</p>
<p>However, clock settings can be locked as Secure should the developer choose to do so.</p>
<div class="image">
<img src="tz-secure-clock-setting.png" alt="tz-secure-clock-setting.png"/>
<div class="caption">
Secure Clock Setting</div></div>
 <h3><a class="anchor" id="setting-drivers-as-nsc"></a>
Setting Drivers as NSC</h3>
<p>Some driver and middleware stacks in the Secure project may need to be accessed by the Non-Secure partition. To enable generation of NSC veneers, set "Non-Secure Callable" from the right-click context menu for the selected modules in the Configurator.</p>
<p>Note: It is only possible to "expose" top of stacks as NSC.</p>
<div class="image">
<img src="tz-generate-nsc-veneers-a.png" alt="tz-generate-nsc-veneers-a.png"/>
</div>
<div class="image">
<img src="tz-generate-nsc-veneers-b.png" alt="tz-generate-nsc-veneers-b.png"/>
<div class="caption">
Generate NSC Veneers</div></div>
<p> The top of the stack will be marked with a new icon and tool tip to signify NSC access.</p>
<h3><a class="anchor" id="guard-functions"></a>
Guard Functions</h3>
<p>Access to NSC drivers from a Non-Secure project is possible through the Guard APIs. FSP will automatically generate Guard functions for all the top of stack/driver APIs added to the project as Non-Secure Callable.</p>
<p>User can choose to add further levels of access control or delete guard function if they wish to only expose a limited range of APIs to a Non-Secure developer.</p>
<div class="fragment"><div class="line">BSP_CMSE_NONSECURE_ENTRY fsp_err_t g_uart0_open_guard(</div><div class="line">        uart_ctrl_t *const p_api_ctrl, uart_cfg_t const *const p_cfg) {</div><div class="line">    /* User can add security checks here */</div><div class="line"></div><div class="line">    FSP_PARAMETER_NOT_USED(p_api_ctrl);</div><div class="line">    FSP_PARAMETER_NOT_USED(p_cfg);</div><div class="line"></div><div class="line">    return R_SCI_UART_Open(&amp;g_uart0_ctrl, &amp;g_uart0_cfg);</div><div class="line">}</div></div><!-- fragment --><p>For example, an SCI channel may be opened and configured for a desired baud rate by the Secure developer, but only enable the Write API to the Non-Secure developer. In which case, all but <code>g_uart0_write_guard()</code> could be deleted. CTRL structures are not required as they will be added on the Secure side.</p>
<p>For example, the call from the Non-Secure partition would be as follows:</p>
<div class="fragment"><div class="line">err = g_uart0_open_guard(0,0);</div></div><!-- fragment --><h2><a class="anchor" id="non-secure-projects"></a>
Non-Secure projects</h2>
<p>Configuration of the project can continue as for other RA devices, but certain resources will be locked if they have been previously set up as Secure.</p>
<p>The Non-Secure project will be called from the Secure project via <code>R_BSP_NonSecureEnter();</code></p>
<h3><a class="anchor" id="clock-set-up"></a>
Clock Set Up</h3>
<p>You may recall that clocks can be set as Secure or Non-Secure. If they are set as Secure, settings will only be available to view, and user will not be able to change them. The Override button will be greyed. This is useful to preserve CGC sync with secure project by not overriding unless necessary. If it is NOT set as Secure, user can choose to override the initial Secure settings</p>
<div class="image">
<img src="tz-clock-setting-non-secure.png" alt="tz-clock-setting-non-secure.png"/>
<div class="caption">
Clock Setting as Non-Secure</div></div>
 <div class="image">
<img src="tz-clock-setting-secure.png" alt="tz-clock-setting-secure.png"/>
<div class="caption">
Clock Setting as Secure</div></div>
 <h3><a class="anchor" id="selecting-nsc-drivers"></a>
Selecting NSC Drivers</h3>
<p>Drivers declared as NSC in a Secure project can be selected and added to Non-Secure project and will be decorated as before.</p>
<div class="image">
<img src="tz-selecting-nsc-drivers-a.png" alt="tz-selecting-nsc-drivers-a.png"/>
</div>
<div class="image">
<img src="tz-selecting-nsc-drivers-b.png" alt="tz-selecting-nsc-drivers-b.png"/>
<div class="caption">
Selecting NSC Drivers</div></div>
 <h3><a class="anchor" id="locked-resources"></a>
Locked Resources</h3>
<p>When a NSC Secure driver is added to a Non-Secure project, the configuration settings are locked and are available for information only. A padlock is added for indication.</p>
<div class="image">
<img src="tz-locked-resources.png" alt="tz-locked-resources.png"/>
<div class="caption">
Locked Resources</div></div>
 <h3><a class="anchor" id="locked-channels"></a>
Locked Channels</h3>
<p>In a peripheral with multiple channels, for example, DMA, if a Non-Secure developer tries to select a channel that has already been defined as Secure, the following error message type will be displayed.</p>
<div class="image">
<img src="tz-error-msg-selecting-secure.png" alt="tz-error-msg-selecting-secure.png"/>
<div class="caption">
Error Message when Selecting a Secure Channel</div></div>
 <h2><a class="anchor" id="idau-registers"></a>
IDAU registers</h2>
<p>Renesas RA TrustZone-enabled devices include a set of registers known as Implementation Defined Attribution Unit (IDAU) that are used to set up partitions between Secure, Non-Secure Callable, and Non-Secure regions.</p>
<p>For devices that use DLM, the IDAU registers can only be programmed during MCU <em><b>boot mode</b></em> and NOT through the debug interfaces. Because of this, special debugger firmware has been developed to manage bringing the device up in SCI boot mode to set up the IDAU registers (automatically drives MD pin) and then switch back to debug mode as needed.</p>
<p><b>Note:</b> Please be aware of the extra signal connection (MD pin) needed on the debug interface connector. The Renesas Evaluation Kit (EK) for your selected device is a good reference.</p>
<div class="image">
<img src="tz-debug-iface-connector.png" alt="tz-debug-iface-connector.png"/>
</div>
<p> The e&sup2; studio build phase automatically extracts the IDAU partition register settings from the Secure <code>.elf</code> file and programs them into the device during debug connection, which can be observed in the console.</p>
<p>This is an important phase of TrustZone development as the Secure partitions should be set as small as possible to ensure that the security attack surface is as small as possible.</p>
<p>However, should the developer wish to make these partitions larger to accommodate, for example during field firmware updates, const or data arrays should be placed in the Secure project as needed.</p>
<div class="image">
<img src="tz-ra-current-status.png" alt="tz-ra-current-status.png"/>
<div class="caption">
RA TrustZone Device Current Status</div></div>
<p> It is also possible to manually set up the partition registers through the Renesas Device Partition Manager.</p>
<div class="image">
<img src="tz-ren-dev-partition-mgr-a.png" alt="tz-ren-dev-partition-mgr-a.png"/>
</div>
<div class="image">
<img src="tz-ren-dev-partition-mgr-b.png" alt="tz-ren-dev-partition-mgr-b.png"/>
<div class="caption">
Renesas Device Partition Manager</div></div>
<p>In e&sup2; studio, when manually setting partitions, make sure to disable setting partitions in the debug configuration to prevent the settings from being overridden when a debug session is launched.</p>
<div class="image">
<img src="tz-set-boundaries.png" alt="tz-set-boundaries.png"/>
</div>
 <h3><a class="anchor" id="sci-boot-mode"></a>
SCI Boot Mode</h3>
<p>Example of MD mode pin connection to debugger connector (from EK schematic).</p>
<div class="image">
<img src="tz-md-mode-pin-ex.png" alt="tz-md-mode-pin-ex.png"/>
<div class="caption">
Example of MD Mode Pin Connection to Debugger Connector (from EK schematic</div></div>
<h3><a class="anchor" id="dlm-states"></a>
DLM States</h3>
<p>Device lifecycle defines the current phase of the device and controls the capabilities of the debug interface, the serial programming interface and Renesas test mode. The following illustration shows the lifecycle definitions and capability in each lifecycle.</p>
<div class="image">
<img src="tz-lifecycle-stages.png" alt="tz-lifecycle-stages.png"/>
<div class="caption">
Lifecycle Stages</div></div>
<p> Note: All authentication key exchange and transitioning to LCK_DBG, LCK_BOOT, RMA_REQ is only managed by Renesas Flash Programmer (RFP) or other production programming tools, and NOT within e&sup2; studio.</p>
<div class="image">
<img src="tz-lifecycle-stages-debug-levels.png" alt="tz-lifecycle-stages-debug-levels.png"/>
<div class="caption">
Lifecycle Stages and Debug Levels</div></div>
<p> There are three debug access levels. The debug access level changes according to the lifecycle state.</p>
<ul>
<li>DBG2: The debugger connection is allowed, and no restriction to access memories and peripherals</li>
<li>DBG1: The debugger connection is allowed, and restricted to access only Non-Secure memory regions and peripherals</li>
<li>DBG0: The debugger connection is not allowed</li>
</ul>
<p>State transitions can be performed using the Renesas Flash Programmer (RFP, see section below) or using the Renesas Device Partition Manager (limited number of states possible). It is possible to secure transitions between states using authentication keys. For more information on DLM states and transitions (device specific), please refer to device user manual.</p>
<h3><a class="anchor" id="alt-dlm-states"></a>
Devices with Alternate DLM States</h3>
<p>Some devices have an alternate implementation of Device Lifecycle Management (See <a class="el" href="_s_t_a_r_t__d_e_v.html#target-device">Target Device</a>). While the concept is the same, the DLM states are a little different. The following illustration shows the lifecycle definitions and capability in each lifecycle.</p>
<div class="image">
<img src="tz-alt-lifecycle-stages.png" alt="tz-alt-lifecycle-stages.png"/>
<div class="caption">
Lifecycle Stages</div></div>
<p> Note: All authentication key exchange and transitioning to LCK_BOOT, and RMA_REQ is only managed by Renesas Flash Programmer (RFP) or other production programming tools, and NOT within e&sup2; studio.</p>
<div class="image">
<img src="tz-alt-lifecycle-stages-debug-levels.png" alt="tz-alt-lifecycle-stages-debug-levels.png"/>
<div class="caption">
Lifecycle Stages and Debug Levels</div></div>
<p> There are three authentication levels. The available authentication levels change according to the lifecycle state and determine the memory and resources that are accessible by the debugger.</p>
<ul>
<li>AL2: The debugger connection is allowed, and no restriction to access memories and peripherals</li>
<li>AL1: The debugger connection is allowed, and restricted to access only Non-Secure memory regions and peripherals</li>
<li>AL0: The debugger connection is not allowed</li>
</ul>
<p>State transitions can be performed using the Renesas Flash Programmer (RFP, see section below) or using the Renesas Device Partition Manager (limited number of states possible). It is possible to secure transitions between states using authentication keys. For more information on DLM states and transitions (device specific), please refer to device user manual.</p>
<p>In addition to having different DLM States, these devices also handle memory partitioning differently. Code Flash and Data Flash partitions are divided into secure and non-secure regions using SCI or USB boot mode commands. All other memory regions are set in IDAU and SAU registers in the secure application during the BSP startup procedure. All memory regions and peripherals that are configured as non-secure must be accessed using an aliased non-secure address. This non-secure address is calcualted by setting bit 28 in the address.</p>
<h3><a class="anchor" id="non-dlm-devices"></a>
Devices without DLM</h3>
<p>For devices that do not have DLM, the IDAU registers are programmed by secure application code at startup. Devices without DLM do not support IDAU register programming using boot mode commands.</p>
<h2><a class="anchor" id="debug"></a>
Debug</h2>
<p>By default, devices supporting DLM will be in SSD mode and so allow access to Secure and Non-Secure partitions. In this mode both Secure and Non-Secure <code>.elf</code> files will be downloaded.</p>
<p>The current debugger status is displayed in the lower left corner and includes the DLM state (SSD or NSECSD) and current partition (Secure, Non-Secure, or Non-Secure Callable) when the debugger is stopped, for example.</p>
<div class="image">
<img src="tz-current-debugger-status-a.png" alt="tz-current-debugger-status-a.png"/>
</div>
 <div class="image">
<img src="tz-current-debugger-status-b.png" alt="tz-current-debugger-status-b.png"/>
</div>
 <div class="image">
<img src="tz-current-debugger-status-c.png" alt="tz-current-debugger-status-c.png"/>
<div class="caption">
Current Debugger Status</div></div>
 <h3><a class="anchor" id="non-secure-debug"></a>
Non-Secure Debug</h3>
<p>Once the device is transitioned to NSECSD mode, only Non-Secure Flash, RAM and Peripherals can be accessed. In this mode, a Secure <code>.elf</code> must be pre-programmed (provisioned) into the device, and only a Non-Secure <code>.elf</code> file will be downloaded.</p>
<p>When in NSECSD mode access to Secure elements will be blocked and data displayed as ????????.</p>
<p>In NSECSD mode, it is not possible to set breakpoints on Secure code or data.</p>
<p>It is not possible to step into Secure code; the debugger will perform a step-over of any Secure function calls. Should the user press the Suspend button during execution, the debugger will stop at the next Non-Secure code access.</p>
<p>Assuming Secure memory region finishes at 32K (0x8000) in NSECSD debug mode (colour coding added for indication only), memory will be displayed as shown in the following figure.</p>
<div class="image">
<img src="tz-mem-display-nsecsd-debug-mode.png" alt="tz-mem-display-nsecsd-debug-mode.png"/>
<div class="caption">
Memory Display in NSECSD Debug Mode</div></div>
<p> Disassembly will be displayed as shown in the following figure.</p>
<div class="image">
<img src="tz-disassembly-display-nsecsd-debug-mode.png" alt="tz-disassembly-display-nsecsd-debug-mode.png"/>
<div class="caption">
Disassembly Display in NSECSD Debug Mode</div></div>
 <h2><a class="anchor" id="debugger-support"></a>
Debugger support</h2>
<p>Renesas E2, E2 Lite, and SEGGER J-Link are supported in e&sup2; studio for TrustZone projects.</p>
<p><b>Debugger Support for TrustZone Projects</b></p>
<table class="doxtable">
<tr>
<th>Feature </th><th>E2 Lite </th><th>E2 </th><th>J-Link </th><th>J-Link OB </th><th>ULINK </th><th>IAR I-jet  </th></tr>
<tr>
<td>JTAG </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>SWD </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>ETB trace </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>ETM trace </td><td>No </td><td>Yes </td><td>Yes </td><td>No </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>TrustZone partition programming </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td><td>Yes </td></tr>
<tr>
<td>Non secure debug </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td><td>Yes </td></tr>
<tr>
<td>e&sup2; studio </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td><td>No </td></tr>
<tr>
<td>IAR EW Arm </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td><td>Yes </td></tr>
<tr>
<td>Keil MDK </td><td>Under consideration </td><td>Under consideration </td><td>Yes </td><td>Yes </td><td>Yes </td><td>No </td></tr>
</table>
<h2><a class="anchor" id="third-party-ides"></a>
Third-Party IDEs</h2>
<p>Third-party IDEs such as IAR Systems EWARM and Keil MDK (uVision) are supported by the RA Smart Configurator (RASC).</p>
<p>In general, RASC offers the same configurator functionality as e&sup2; studio documented above. Project generators are available to initialise workspaces in the target IDEs as well as setting up debug configurations and so forth. However, there are some limitations that need to be noted especially with regards to IDAU TrustZone partition register programming. See the specific RASC documentation for usage details.</p>
<h2><a class="anchor" id="renesas-flash-programmer-rfp"></a>
Renesas Flash Programmer (RFP)</h2>
<p>Updated versions of Renesas Flash Programmer (RFP) are available to support setting of partitions, DLM state and Authentication keys.</p>
<p>RFP can be downloaded free of charge on the Renesas web site.</p>
<p>A new mode has been added to Program Flash Options as shown in the following graphics.</p>
<div class="image">
<img src="tz-rfp-program-flash-options.png" alt="tz-rfp-program-flash-options.png"/>
<div class="caption">
RFP Program Flash Options</div></div>
<p> Options to set partition boundaries are shown in the following figure.</p>
<div class="image">
<img src="tz-rfp-partition-boundaries.png" alt="tz-rfp-partition-boundaries.png"/>
<div class="caption">
RFP Partition Boundaries</div></div>
<p> Options to set DLM state, Authentication keys, and Security settings are shown in the following figure.</p>
<div class="image">
<img src="tz-rfp-dlm-authent-keys-security-settings.png" alt="tz-rfp-dlm-authent-keys-security-settings.png"/>
<div class="caption">
RFP DLM State, Authentication Keys, and Security Settings</div></div>
<p> Great care is needed here as some DLM states can **<span class="underline">permanently</span>** turn off debug and boot mode on the devices. Equally programming a security access authentication key can lead to permanently locked devices if the key is lost.</p>
<h2><a class="anchor" id="glossary"></a>
Glossary</h2>
<p><b>IDAU</b></p>
<p>Implementation Defined Attribute Unit. Used to program TrustZone partitions.</p>
<p><b>NSECSD</b></p>
<p>Non-Secure Software Development mode</p>
<p><b>SSD</b></p>
<p>Secure Software Development mode</p>
<p><b>NSC</b></p>
<p>Non-Secure Callable. Special Secure memory region used for Veneer to allow access to Secure APIs from Non-Secure code.</p>
<p><b>Provisioned</b></p>
<p>Device with Secure code pre-programmed and DLM state set to <b>NSECSD</b></p>
<p><b>Flat project</b></p>
<p>All code, data and peripherals are configured as secure with the exception of the EDMAC RAM buffer which are placed in Non-Secure RAM due to the configuration of the internal bus masters.</p>
<p><b>Veneer</b></p>
<p>Code that resides in Non-Secure Callable region</p>
<p><b>Combined model</b></p>
<p>Development engineer has access to both Secure and Non-Secure project and source code</p>
<p><b>Split model</b></p>
<p>Development Engineer has access to only the Non-Secure partition. No visibility of Secure source code. Secure code will be provisioned into device.</p>
<h3><a class="anchor" id="configurator-icon-glossary"></a>
Configurator Icon Glossary</h3>
<div class="image">
<img src="tz-config-icons-a.png" alt="tz-config-icons-a.png"/>
</div>
 <div class="image">
<img src="tz-config-icons-b.png" alt="tz-config-icons-b.png"/>
<div class="caption">
Configurator Icons</div></div>
 <h1><a class="anchor" id="RASC-MDK-IAR-user-guide"></a>
RASC User Guide for MDK and IAR</h1>
<h2><a class="anchor" id="RASC"></a>
What is RASC?</h2>
<p>The Renesas RA Smart Configurator (RASC) is a desktop application designed to configure device hardware such as clock set up and pin assignment as well as initialization of FSP software components for a Renesas RA microcontroller project when using a 3rd-party IDE and toolchain.</p>
<p>The RA Smart Configurator can currently be used with</p><ol type="1">
<li>Keil MDK and the Arm compiler toolchain.</li>
<li>IAR EWARM with IAR toolchain for Arm</li>
</ol>
<p>Projects can be configured and the project content generated in the same way as in e&sup2; studio. Please refer to <a class="el" href="_s_t_a_r_t__d_e_v.html#configuring-a-project">Configuring a Project</a> section for more details.</p>
<h2><a class="anchor" id="using-ra-smart-configurator-with-keil-mdk"></a>
Using RA Smart Configurator with Keil MDK</h2>
<h3><a class="anchor" id="RASC-MDK-prerequisites"></a>
Prerequisites</h3>
<ul>
<li>Keil MDK and Arm compiler are installed and licensed. Please refer to the RASC Release notes for the version to be installed.</li>
<li>Import the RA device pack. Download the RA device pack archive file (ex: MDK_Device_Packs_2.x.x.zip) from the <a href="https://github.com/renesas/fsp/releases">FSP GitHub release page</a>. Extract the archive file to locate the RA device pack. To import the RA device pack, launch the PackInstaller.exe from <code>&lt;keil_mdk_install_dir&gt;\UV4</code>. Select the menu item <b>File &gt; Import...</b> and browse to the extracted .pack file.</li>
<li>Verify that the latest updates for RA devices are included in Keil MDK. To verify, select the menu "Packs" in Pack Installer and verify that the menu item <b>Check for Updates on Launch</b> is selected. If not, select <b>Check for Updates on Launch</b> and relaunch Pack Installer.</li>
<li>For flashing and debugging, the latest Segger J-Link DLL is installed into Keil MDK.</li>
<li>Install RASC and FSP using the Platform Installer from the GitHub release page.</li>
</ul>
<h3><a class="anchor" id="using-ra-smart-configurator-with-keil-mdk-create-project"></a>
Create new RA project</h3>
<p>The following steps are required to create an RA project using Keil MDK, RASC and FSP:</p>
<ol type="1">
<li>Start the RA Smart Configurator.</li>
<li><p class="startli">Enter a project folder and project name.</p>
<div class="image">
<img src="image009.png" alt="image009.png"/>
<div class="caption">
RASC project settings</div></div>
</li>
<li><p class="startli">Select the target device and IDE.</p>
<div class="image">
<img src="image010.png" alt="image010.png"/>
<div class="caption">
Target device and IDE selection</div></div>
</li>
<li>The rest of the project generator and FSP configuration is the same as e&sup2; studio. Please refer to the previous sections for details.</li>
<li>On completion of FSP configuration, press "Generate Project Content"</li>
<li><p class="startli">A new Keil MDK project file will be generated in the project path. Double click this file to open MDK and continue development as usual.</p>
<div class="image">
<img src="uVision-imported-data.png" alt="uVision-imported-data.png"/>
<div class="caption">
uVision project workspace with imported project data</div></div>
 </li>
</ol>
<h3><a class="anchor" id="using-ra-smart-configurator-with-keil-mdk-modify-project"></a>
Modify existing RA project</h3>
<p>Once an initial project has been generated and configured, it is also possible to make changes using RASC as follows.</p>
<dl class="section note"><dt>Note</dt><dd>This setup only needs to be done once per project.</dd></dl>
<p>Set up the following links to RASC:</p>
<ol type="1">
<li>In Keil MDK uVision, select <b>Tools &gt; Customize Tools Menu...</b>.</li>
<li>Select the <b>new</b> icon and fill in the fields as follows for each tool:<ol type="a">
<li>RA Smart Configurator:<ul>
<li>Menu item name: Enter: RA Smart Configurator</li>
<li>Command: Select "..." and navigate to <code>rasc.exe</code></li>
<li>Initial Folder: Enter: <code>$P</code></li>
<li>Arguments: Enter: <code>configuration.xml</code></li>
</ul>
</li>
<li>Device Partition Manager:<ul>
<li>Menu item name: Enter: Device Partition Manager</li>
<li>Command: Select "..." and navigate to <code>rasc.exe</code></li>
<li>Initial Folder: Enter: <code>$P</code></li>
<li>Arguments: Enter: <code>-application com.renesas.cdt.ddsc.dpm.ui.dpmapplication configuration.xml "$L%L"</code></li>
</ul>
</li>
</ol>
</li>
</ol>
<p>To reconfigure an existing project select <b>Tools &gt; RA Smart Configurator</b></p>
<p>To reconfigure the TrustZone partitions select <b>Tools &gt; Device Partition Manager</b></p>
<h3><a class="anchor" id="using-ra-smart-configurator-with-keil-mdk-build-project"></a>
Build and Debug RA project</h3>
<p>The project can be built by selecting the menu item <b>Project &gt; Build Target</b> or tool bar item <b>Rebuild</b> or the keyboard shortcut F7.</p>
<p>Assembler, Compiler, Linker and Debugger settings can be changed in <b>Options for Target</b> dialog, which can be launched using the menu item <b>Project &gt; Options for Target</b>, the tool bar item <b>Options for Target</b> or the keyboard shortcut Alt+F7.</p>
<div class="image">
<img src="uVision-target-options.png" alt="uVision-target-options.png"/>
<div class="caption">
Options for Target</div></div>
<p> RASC will set up the uVision project to debug the selected device using J-Link or J-Link OB debugger by default.</p>
<p>A Debug session can be started or stopped by selecting the menu item <b>Debug &gt; Start/Stop Debug Session</b> or keyboard shortcut CTRL+F5. When debugging for the first time, J-Link firmware update may be needed if requested by the tool.</p>
<p>Refer to the documentation from Keil to get more information on the debug features in uVision. Note that not all features supported by uVision debugger are implemented in the J-Link interface. Consult SEGGER J-Link documentation for more information.</p>
<h3><a class="anchor" id="using-ra-smart-configurator-with-keil-mdk-notes-restrictions"></a>
Notes and Restrictions</h3>
<ol type="1">
<li><b>When debugging a TrustZone based project, the Secure project image MUST be downloaded before the Non Secure project.</b></li>
<li><p class="startli">For TrustZone enabled devices, the user will need to manually set up the memory partitions using the "Renesas Device Partition Manager" from inside RASC before downloading.</p>
<div class="image">
<img src="image007.png" alt="image007.png"/>
<div class="caption">
Renesas Device partition Manager</div></div>
</li>
<li>RA FSP contains a full set of drivers and middleware and may not be compatible with other CMSIS packs from Keil, Arm or third parties.</li>
<li>Flash programming is currently only supported through the debugger connection.</li>
</ol>
<h2><a class="anchor" id="using-ra-smart-configurator-with-ewarm"></a>
Using RA Smart Configurator with IAR EWARM</h2>
<p>IAR Systems Embedded Workbench for Arm (EWARM) includes support for Renesas RA devices. These can be set up as bare metal designs within EWARM. However, most RA developers will want to integrate RA FSP drivers and middleware into their designs. RASC will facilitate this.</p>
<p>RASC generates a "Project Connection" file that can be loaded directly into EWARM to update project files.</p>
<h3><a class="anchor" id="RASC-EWARM-prerequisites"></a>
Prerequisites</h3>
<ul>
<li>IAR EWARM installed and licensed. Pleae refer to the Release notes for the version to be installed.</li>
<li>RASC and FSP Installed</li>
</ul>
<h3><a class="anchor" id="using-ra-smart-configurator-with-ewarm-create-project"></a>
Create new RA project</h3>
<p>The following steps are required to create an RA project using IAR EWARM, RASC and FSP:</p>
<ol type="1">
<li>Start the RA Smart Configurator.</li>
<li><p class="startli">Enter a project folder and project name.</p>
<div class="image">
<img src="image014.png" alt="image014.png"/>
<div class="caption">
RASC project settings</div></div>
</li>
<li><p class="startli">Select the target device and IDE.</p>
<div class="image">
<img src="image016.png" alt="image016.png"/>
<div class="caption">
Target device and IDE selection</div></div>
</li>
<li>The rest of the project generator and FSP configuration operates the same as e&sup2; studio. Refer to the previous sections for details.</li>
<li>On completion of FSP configuration, press <b>Generate Project Content</b>.</li>
<li>A new IAR EWARM project file will be generated in the project path. Double click this file to open IAR EWARM and continue development as usual.</li>
<li>To Use RASC with EWARM, RASC needs to configured as a tool in EWARM by selecting the menu item <b>Tools &gt; Configure Tools...</b>. Select <b>New</b> to create a new tool in the dialog shown and add the following information:<ul>
<li>Menu Text: <b>RA Smart Configurator</b><ol type="a">
<li>Command: Select <b>Browse...</b> and navigate to <code>rasc.exe</code> in the installed RASC</li>
<li>Argument: <code>configuration.xml</code></li>
<li>Initial Directory: <code>$PROJ_DIR$</code></li>
<li>Tool Available: Always</li>
</ol>
</li>
<li>Menu Text: <b>Device Partition Manager</b><ol type="a">
<li>Command: Select <b>Browse...</b> and navigate to <code>rasc.exe</code> in the installed RASC</li>
<li>Argument: -<code>application com.renesas.cdt.ddsc.dpm.ui.dpmapplication configuration.xml "$TARGET_PATH$"</code></li>
<li>Initial Directory: <code>$PROJ_DIR$</code></li>
<li>Tool Available: Always</li>
</ol>
</li>
</ul>
</li>
<li>RASC can now be re-launched from EWARM using the menu item <b>Tools &gt; RA Smart Configurator</b>.</li>
<li>A Project connection needs to be set up in EWARM to build the project. Select <b>Project &gt; Add Project Connection</b> in EWARM and select <b>IAR Project Connection</b>. Navigate to the project folder and select <code>buildinfo.ipcf</code> and click <b>Open</b>. The project can now build in EWARM.</li>
</ol>
<h3><a class="anchor" id="using-ra-smart-configurator-with-ewarm-notes-restrictions"></a>
Notes and Restrictions</h3>
<p>When starting a TrustZone enabled debug session Partition sizes are checked automatically.</p>
<ul>
<li>If partition sizes are set correctly, the debug session will launch as normal.</li>
<li>If partition sizes need to be changed, IAR EWARM will prompt to run the Renesas Device Partition Manager. Select <b>Yes</b>. The Device Partition Manager will start with the required partition sizes prefilled.</li>
<li>Select <b>Set TrustZone secure / non-secure boundaries</b> as the only action.</li>
<li>Enter debugger details, if required.</li>
<li>Select <b>Run</b> to program the partitions.</li>
<li>Return to the IDE and relaunch the debug session </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v5.8.0 User's Manual Copyright © (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
