<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: USB Host Communications Device Class Driver (r_usb_hcdc)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v3.2.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">
 
    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text"> 
      </span>
      <span class="right">
          &nbsp; 
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___u_s_b___h_c_d_c.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() { 
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body. 
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works 
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len)); 
            }
          } 
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }    
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element. 
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;  
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">USB Host Communications Device Class Driver (r_usb_hcdc)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This module provides a USB Host Communications Device Class (HCDC) driver. It implements the <a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html">USB HCDC Interface</a>. </p>
<p><a class="anchor" id="functionss"></a></p><h2 class="groupheader">Functions</h2>
<p>Refer to <a class="el" href="group___u_s_b.html">USB (r_usb_basic)</a> for the common API (r_usb_basic) to be called from the application. <a class="anchor" id="details"></a></p><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="r-usb-hcdc-overview"></a>
Overview</h1>
<p>The r_usb_hcdc module, when used in combination with the r_usb_basic module, operates as a USB Host Communications Device Class (HCDC) driver. The HCDC conforms to the PSTN device subclass abstract control model of the USB Communications Device Class (CDC) specification and enables communication with a CDC peripheral device.</p>
<h2><a class="anchor" id="r-usb-hcdc-features"></a>
Features</h2>
<p>The r_usb_hcdc module has the following key features:</p><ul>
<li>Checks for connected devices</li>
<li>Implementation of communication line settings</li>
<li>Acquisition of the communication line state</li>
<li>Data transfer to and from a CDC peripheral device</li>
</ul>
<h1><a class="anchor" id="r-usb-hcdc-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for r_usb_hcdc</h2>
The following build time configurations are defined in fsp_cfg/r_usb_hcdc_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Target Peripheral Device Class ID</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
CDC class supported device</li>
<li>
Vendor class device</li>
</ul>
</td><td>CDC class supported device </td><td>Specify the device class ID of the CDC device to be connected. </td></tr>
<tr>
<td>Bulk Input Transfer Pipe</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
USB PIPE1</li>
<li>
USB PIPE2</li>
<li>
USB PIPE3</li>
<li>
USB PIPE4</li>
<li>
USB PIPE5</li>
</ul>
</td><td>USB PIPE1 </td><td>Select the USB pipe to use for bulk input transfers. </td></tr>
<tr>
<td>Bulk Output Transfer Pipe</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
USB PIPE1</li>
<li>
USB PIPE2</li>
<li>
USB PIPE3</li>
<li>
USB PIPE4</li>
<li>
USB PIPE5</li>
</ul>
</td><td>USB PIPE2 </td><td>Select the USB pipe to use for bulk output transfers. </td></tr>
<tr>
<td>Interrupt In Pipe</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
USB PIPE6</li>
<li>
USB PIPE7</li>
<li>
USB PIPE8</li>
<li>
USB PIPE9</li>
</ul>
</td><td>USB PIPE6 </td><td>Select the USB pipe to use for interrupts. </td></tr>
</table>
 <h2>Configurations for Middleware &gt; USB &gt; USB HCDC driver on r_usb_hcdc</h2>
This module can be added to the Stacks tab via New Stack &gt; Middleware &gt; USB &gt; USB HCDC driver on r_usb_hcdc.<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Name</td><td>Name must be a valid C symbol</td><td>g_hcdc0 </td><td>Module name. </td></tr>
</table>
</p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a class="el" href="group___u_s_b.html">USB (r_usb_basic)</a> module for hardware configuration options.</dd></dl>
<h2><a class="anchor" id="r-usb-hcdc-clock-configuration"></a>
Clock Configuration</h2>
<p>Refer to the <a class="el" href="group___u_s_b.html">USB (r_usb_basic)</a> module.</p>
<h2><a class="anchor" id="r-usb-hcdc-pin-configuration"></a>
Pin Configuration</h2>
<p>Refer to the <a class="el" href="group___u_s_b.html">USB (r_usb_basic)</a> module.</p>
<h1><a class="anchor" id="r-usb-hcdc-usage_notes"></a>
Usage Notes</h1>
<h2>Communications Device Class (CDC), PSTN and ACM</h2>
<p>This software conforms to the Abstract Control Model (ACM) subclass of the Communications Device Class specification as defined in the "USB Communications Class Subclass Specification for PSTN Devices", Revision 1.2. The Abstract Control Model subclass is a technology that bridges the gap between USB devices and earlier modems (employing RS-232C connections) enabling use of application programs designed for older modems.</p>
<p><b>Basic Functions</b></p>
<p>The main functions of HCDC are the following:</p><ul>
<li>Verify connected devices</li>
<li>Make communication line settings</li>
<li>Acquire the communication line state</li>
<li>Transfer data to and from the CDC peripheral device</li>
</ul>
<h3>Abstract Control Model Class Requests - Host to Device</h3>
<p>This driver supports the following class requests:</p>
<table class="doxtable">
<tr>
<th align="left">Request </th><th align="left">Code </th><th align="left">Description  </th></tr>
<tr>
<td align="left">SendEncapsulatedCommand </td><td align="left">0x00 </td><td align="left">Transmits an AT command as defined by the protocol used by the device (normally 0 for USB). </td></tr>
<tr>
<td align="left">GetEncapsulatedResponse </td><td align="left">0x01 </td><td align="left">Requests a response to a command transmitted by SendEncapsulatedCommand. </td></tr>
<tr>
<td align="left">SetCommFeature </td><td align="left">0x02 </td><td align="left">Enables or disables features such as device-specific 2-byte code and country setting. </td></tr>
<tr>
<td align="left">GetCommFeature </td><td align="left">0x03 </td><td align="left">Acquires the enabled/disabled state of features such as device-specific 2-byte code and country setting. </td></tr>
<tr>
<td align="left">ClearCommFeature </td><td align="left">0x04 </td><td align="left">Restores the default enabled/disabled settings of features such as device-specific 2-byte code and country setting. </td></tr>
<tr>
<td align="left">SetLineCoding </td><td align="left">0x20 </td><td align="left">Makes communication line settings (communication speed, data length, parity bit, and stop bit length). </td></tr>
<tr>
<td align="left">GetLineCoding </td><td align="left">0x21 </td><td align="left">Acquires the communication line setting state. </td></tr>
<tr>
<td align="left">SetControlLineState </td><td align="left">0x22 </td><td align="left">Makes communication line control signal (RTS, DTR) settings. </td></tr>
<tr>
<td align="left">SendBreak </td><td align="left">0x23 </td><td align="left">Transmits a break signal. </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>For more information about Abstract Control Model requests, refer to Table 11 "Requests - Abstract Control Model" in the "USB Communications Class Subclass Specification for PSTN Devices", Revision 1.2.</dd></dl>
<p>The expected data format for each command is shown below followed by dependent structures.</p>
<table class="doxtable">
<tr>
<th align="center">bmRequestType </th><th align="center">bRequest </th><th align="center">wValue </th><th align="center">wIndex </th><th align="center">wLength </th><th align="left">Data  </th></tr>
<tr>
<td align="center">0x21 </td><td align="center">SEND_ENCAPSULATED_COMMAND (0x00) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">Data length </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__encapsulated__t">usb_hcdc_encapsulated_t</a> </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">GET_ENCAPSULATED_RESPONSE (0x01) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">Data length </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__encapsulated__t">usb_hcdc_encapsulated_t</a> </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">SET_COMM_FEATURE (0x02) </td><td align="center">usb_hcdc_feature_selector_t </td><td align="center">0x0000 </td><td align="center">Data length </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#unionusb__hcdc__commfeature__t">usb_hcdc_commfeature_t</a> </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">GET_COMM_FEATURE (0x03) </td><td align="center">usb_hcdc_feature_selector_t </td><td align="center">0x0000 </td><td align="center">Data length </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#unionusb__hcdc__commfeature__t">usb_hcdc_commfeature_t</a> </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">CLEAR_COMM_FEATURE (0x04) </td><td align="center">usb_hcdc_feature_selector_t </td><td align="center">0x0000 </td><td align="center">Data length </td><td align="left">None </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">SET_LINE_CODING (0x20) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__linecoding__t">usb_hcdc_linecoding_t</a> </td></tr>
<tr>
<td align="center">0xA1 </td><td align="center">GET_LINE_CODING (0x21) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">0x0007 </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__linecoding__t">usb_hcdc_linecoding_t</a> </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">SET_CONTROL_LINE_STATE (0x22) </td><td align="center"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__controllinestate__t">usb_hcdc_controllinestate_t</a> </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="left">None </td></tr>
<tr>
<td align="center">0x21 </td><td align="center">SEND_BREAK (0x23) </td><td align="center"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__breakduration__t">usb_hcdc_breakduration_t</a> </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="left">None </td></tr>
</table>
<h3>ACM Notifications from Device to Host</h3>
<p>The following class notifications are supported:</p>
<table class="doxtable">
<tr>
<th align="left">Notification </th><th align="center">Code </th><th align="left">Description  </th></tr>
<tr>
<td align="left">RESPONSE_AVAILABLE </td><td align="center">0x01 </td><td align="left">Response to GET_ENCAPSULATED_RESPONSE </td></tr>
<tr>
<td align="left">SERIAL_STATE </td><td align="center">0x20 </td><td align="left">Notification of serial line state </td></tr>
</table>
<p>The data types returned are as follows:</p>
<table class="doxtable">
<tr>
<th align="center">bmRequestType </th><th align="left">bRequest </th><th align="center">wValue </th><th align="center">wIndex </th><th align="center">wLength </th><th align="left">Data  </th></tr>
<tr>
<td align="center">0xA1 </td><td align="left">RESPONSE_AVAILABLE (0x01) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="left">None </td></tr>
<tr>
<td align="center">0xA1 </td><td align="left">SERIAL_STATE (0x20) </td><td align="center">0x0000 </td><td align="center">0x0000 </td><td align="center">0x0002 </td><td align="left"><a class="el" href="group___u_s_b___h_c_d_c___a_p_i.html#structusb__hcdc__serialstate__t">usb_hcdc_serialstate_t</a> </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>The host is notified with SERIAL_STATE whenever a change in the UART port state is detected.</dd></dl>
<h2><a class="anchor" id="r-usb-hcdc-limitations"></a>
Limitations</h2>
<p>This driver is subject to the following limitations:</p>
<ul>
<li>Suspend is not supported when a data transfer is in progress. Confirm that data transfer has completed before executing suspend.</li>
<li>Use of compound USB devices with CDC class support is not supported.</li>
<li>This module must be incorporated into a project using r_usb_basic and does not provide any public APIs.</li>
<li>This driver does not support Low-speed.</li>
<li>This driver does not support simultaneous operation with the other device class.</li>
</ul>
<h1><a class="anchor" id="r-usb-hcdc-examples"></a>
Examples</h1>
<h2>USB HCDC Loopback Example</h2>
<p>The main functions of the HCDC loopback example are as follows:</p>
<ol type="1">
<li>Virtual UART control settings are configured by transmitting the class request SET_LINE_CODING to the CDC device.</li>
<li>Sends receive (Bulk In transfer) requests to a CDC peripheral device and receives data.</li>
<li>Loops received data back to the peripheral by means of Bulk Out transfers.</li>
</ol>
<div class="image">
<object type="image/svg+xml" data="r_usb_hcdc_data_Transfer.svg">r_usb_hcdc_data_Transfer.svg</object>
<div class="caption">
Data Transfer (Loopback)</div></div>
<p> The main loop performs loopback processing in which data received from a CDC peripheral device is transmitted unaltered back to the peripheral.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define SET_LINE_CODING           (USB_CDC_SET_LINE_CODING | USB_HOST_TO_DEV | USB_CLASS | USB_INTERFACE)</span></div><div class="line"><span class="preprocessor">#define GET_LINE_CODING           (USB_CDC_GET_LINE_CODING | USB_DEV_TO_HOST | USB_CLASS | USB_INTERFACE)</span></div><div class="line"><span class="preprocessor">#define SET_CONTROL_LINE_STATE    (USB_CDC_SET_CONTROL_LINE_STATE | USB_HOST_TO_DEV | USB_CLASS | USB_INTERFACE)</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define COM_SPEED                 (9600U)</span></div><div class="line"><span class="preprocessor">#define COM_DATA_BIT              (8U)</span></div><div class="line"><span class="preprocessor">#define COM_STOP_BIT              (0)</span></div><div class="line"><span class="preprocessor">#define COM_PARITY_BIT            (0)</span></div><div class="line"><span class="preprocessor">#define LINE_CODING_LENGTH        (7)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> usb_basic_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___u_s_b___a_p_i.html#ga56bea25fbffdbda134044c49d40d5e40">usb_status_t</a>     event;</div><div class="line">    usb_event_info_t event_info;</div><div class="line"></div><div class="line">    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#ad92d0a1d797e8e806082b4fb6cf65f03">open</a>(&amp;g_basic0_ctrl, &amp;g_basic0_cfg);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">while</span> (1)</div><div class="line">    {</div><div class="line">        <span class="comment">/* Get USB event data */</span></div><div class="line">        g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a3acf29ae5b0455d82149e36b5387d02d">eventGet</a>(&amp;event_info, &amp;event);</div><div class="line"></div><div class="line">        <span class="comment">/* Handle the received event (if any) */</span></div><div class="line">        <span class="keywordflow">switch</span> (event)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___u_s_b___a_p_i.html#gga56bea25fbffdbda134044c49d40d5e40ab5c3bd23fe62533150eef3a4e8c8d13c">USB_STATUS_CONFIGURED</a>:</div><div class="line"></div><div class="line">                <span class="comment">/* Configure virtual UART settings */</span></div><div class="line">                set_line_coding(&amp;g_basic0_ctrl, event_info.device_address); <span class="comment">/* CDC Class request &quot;SetLineCoding&quot; */</span></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___u_s_b___a_p_i.html#gga56bea25fbffdbda134044c49d40d5e40a63dd4552584256ef9d1a0d5da2159e9c">USB_STATUS_READ_COMPLETE</a>:</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (<a class="code" href="group___u_s_b___a_p_i.html#ggab1dc4a2240edf1a50cca3945f31dc9f2aa31d93178a24f042fb19db6da3b5a2d8">USB_CLASS_HCDC</a> == event_info.type)</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> (event_info.data_size &gt; 0)</div><div class="line">                    {</div><div class="line">                        <span class="comment">/* Send the received data back to the connected peripheral */</span></div><div class="line"></div><div class="line">                        g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a6eb4c329c32333e7475202b7f5825bce">write</a>(&amp;g_basic0_ctrl, g_snd_buf, event_info.data_size, USB_DEVICE_ADDRESS_1);</div><div class="line"></div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">else</span></div><div class="line">                    {</div><div class="line"></div><div class="line">                        <span class="comment">/* Send the data reception request when the zero-length packet is received. */</span></div><div class="line">                        g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a1f8293d27b1dee87d1e925800c70edb3">read</a>(&amp;g_basic0_ctrl, g_rcv_buf, CDC_DATA_LEN, USB_DEVICE_ADDRESS_1);</div><div class="line"></div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span>                   <span class="comment">/* USB_HCDCC */</span></div><div class="line">                {</div><div class="line">                    <span class="comment">/* Control Class notification &quot;SerialState&quot; receive start */</span></div><div class="line">                    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a1f8293d27b1dee87d1e925800c70edb3">read</a>(&amp;g_basic0_ctrl,</div><div class="line">                                      (uint8_t *) &amp;g_serial_state,</div><div class="line">                                      USB_HCDC_SERIAL_STATE_MSG_LEN,</div><div class="line">                                      USB_DEVICE_ADDRESS_1);</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___u_s_b___a_p_i.html#gga56bea25fbffdbda134044c49d40d5e40ad44448290b4f36868a09b48e4588b29d">USB_STATUS_WRITE_COMPLETE</a>:</div><div class="line"></div><div class="line">                <span class="comment">/* Start receive operation */</span></div><div class="line">                g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a1f8293d27b1dee87d1e925800c70edb3">read</a>(&amp;g_basic0_ctrl, g_rcv_buf, CDC_DATA_LEN, USB_DEVICE_ADDRESS_1);</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">case</span> <a class="code" href="group___u_s_b___a_p_i.html#gga56bea25fbffdbda134044c49d40d5e40a24e9ad4653245663e5e89bda173141fd">USB_STATUS_REQUEST_COMPLETE</a>:</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (USB_CDC_SET_LINE_CODING == (event_info.setup.request_type &amp; <a class="code" href="group___u_s_b___a_p_i.html#ga3a6743f3e336fc05e70e59b05206f634">USB_BREQUEST</a>))</div><div class="line">                {</div><div class="line">                    <span class="comment">/* Set virtual RTS/DTR signal state */</span></div><div class="line">                    set_control_line_state(&amp;g_basic0_ctrl, event_info.device_address); <span class="comment">/* CDC Class request &quot;SetControlLineState&quot; */</span></div><div class="line">                }</div><div class="line">                <span class="comment">/* Check Complete request &quot;SetControlLineState&quot; */</span></div><div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (USB_CDC_SET_CONTROL_LINE_STATE == (event_info.setup.request_type &amp; <a class="code" href="group___u_s_b___a_p_i.html#ga3a6743f3e336fc05e70e59b05206f634">USB_BREQUEST</a>))</div><div class="line">                {</div><div class="line">                    <span class="comment">/* Read back virtual UART settings */</span></div><div class="line">                    get_line_coding(&amp;g_basic0_ctrl, event_info.device_address); <span class="comment">/* CDC Class request &quot;SetLineCoding&quot; */</span></div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (USB_CDC_GET_LINE_CODING == (event_info.setup.request_type &amp; <a class="code" href="group___u_s_b___a_p_i.html#ga3a6743f3e336fc05e70e59b05206f634">USB_BREQUEST</a>))</div><div class="line">                {</div><div class="line">                    <span class="comment">/* Now that setup is complete, start loopback operation */</span></div><div class="line">                    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#a1f8293d27b1dee87d1e925800c70edb3">read</a>(&amp;g_basic0_ctrl, g_snd_buf, CDC_DATA_LEN, USB_DEVICE_ADDRESS_1);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    <span class="comment">/* Unsupported request */</span></div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="keywordflow">default</span>:</div><div class="line"></div><div class="line">                <span class="comment">/* Other event */</span></div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> set_control_line_state (<a class="code" href="group___u_s_b.html#gad5c104adfb44c721d9c664bf7fabddfb">usb_instance_ctrl_t</a> * p_ctrl, uint8_t device_address)</div><div class="line">{</div><div class="line">    usb_setup_t setup;</div><div class="line"></div><div class="line">    setup.request_type   = SET_CONTROL_LINE_STATE; <span class="comment">/* bRequestCode:SET_CONTROL_LINE_STATE, bmRequestType */</span></div><div class="line">    setup.request_value  = 0x0000;                 <span class="comment">/* wValue:Zero */</span></div><div class="line">    setup.request_index  = 0x0000;                 <span class="comment">/* wIndex:Interface */</span></div><div class="line">    setup.request_length = 0x0000;                 <span class="comment">/* wLength:Zero */</span></div><div class="line"></div><div class="line">    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#aa6abce0db3b9a1afbf93a02c02e84b7e">hostControlTransfer</a>(p_ctrl, &amp;setup, (uint8_t *) &amp;g_usb_dummy, device_address);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> set_line_coding (<a class="code" href="group___u_s_b.html#gad5c104adfb44c721d9c664bf7fabddfb">usb_instance_ctrl_t</a> * p_ctrl, uint8_t device_address)</div><div class="line">{</div><div class="line">    usb_setup_t setup;</div><div class="line"></div><div class="line">    g_com_parm.dwdte_rate   = (<a class="code" href="group___u_s_b___h_c_d_c___a_p_i.html#ga23d0116191faddf3caa83a32cbccbbd8">usb_hcdc_line_speed_t</a>) COM_SPEED;</div><div class="line">    g_com_parm.bchar_format = (<a class="code" href="group___u_s_b___h_c_d_c___a_p_i.html#ga8a99f2bb7e53f371b7f92457e20cfe54">usb_hcdc_stop_bit_t</a>) COM_STOP_BIT;</div><div class="line">    g_com_parm.bparity_type = (<a class="code" href="group___u_s_b___h_c_d_c___a_p_i.html#ga018a04577fdc4d43125c12f84785f548">usb_hcdc_parity_bit_t</a>) COM_PARITY_BIT;</div><div class="line">    g_com_parm.bdata_bits   = (<a class="code" href="group___u_s_b___h_c_d_c___a_p_i.html#gab219f0f6daf3dfd72efea91ecb9136b3">usb_hcdc_data_bit_t</a>) COM_DATA_BIT;</div><div class="line"></div><div class="line">    setup.request_type   = SET_LINE_CODING;    <span class="comment">/* bRequestCode:SET_LINE_CODING, bmRequestType */</span></div><div class="line">    setup.request_value  = 0x0000;             <span class="comment">/* wValue:Zero */</span></div><div class="line">    setup.request_index  = 0x0000;             <span class="comment">/* wIndex:Interface */</span></div><div class="line">    setup.request_length = LINE_CODING_LENGTH; <span class="comment">/* Data:Line Coding Structure */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Request Control transfer */</span></div><div class="line">    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#aa6abce0db3b9a1afbf93a02c02e84b7e">hostControlTransfer</a>(p_ctrl, &amp;setup, (uint8_t *) &amp;g_com_parm, device_address);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> get_line_coding (<a class="code" href="group___u_s_b.html#gad5c104adfb44c721d9c664bf7fabddfb">usb_instance_ctrl_t</a> * p_ctrl, uint8_t device_address)</div><div class="line">{</div><div class="line">    usb_setup_t setup;</div><div class="line"></div><div class="line">    setup.request_type   = GET_LINE_CODING;    <span class="comment">/* bRequestCode:GET_LINE_CODING, bmRequestType */</span></div><div class="line">    setup.request_value  = 0x0000;             <span class="comment">/* wValue:Zero */</span></div><div class="line">    setup.request_index  = 0x0000;             <span class="comment">/* wIndex:Interface */</span></div><div class="line">    setup.request_length = LINE_CODING_LENGTH; <span class="comment">/* Data:Line Coding Structure */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Request Control transfer */</span></div><div class="line">    g_usb_on_usb.<a class="code" href="group___u_s_b___a_p_i.html#aa6abce0db3b9a1afbf93a02c02e84b7e">hostControlTransfer</a>(p_ctrl, &amp;setup, (uint8_t *) &amp;g_com_parm, device_address);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v3.2.0 User's Manual Copyright Â© (2021) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
