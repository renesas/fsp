<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Azure Embedded Wireless Framework GM Port (rm_azure_ewf_gm)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
     });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v6.2.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">

    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text">
      </span>
      <span class="right">
          &nbsp;
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_m___a_z_u_r_e___e_w_f___g_m.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body.
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len));
            }
          }
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element.
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Azure Embedded Wireless Framework GM Port (rm_azure_ewf_gm)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> &raquo; <a class="el" href="group___r_e_n_e_s_a_s___n_e_t_w_o_r_k_i_n_g___m_o_d_u_l_e_s.html">Networking</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<dl class="section note"><dt>Note</dt><dd><b>The Azure Embedded Wireless Framework is still in beta and not all APIs may be fully implemented yet.</b></dd></dl>
<h1><a class="anchor" id="rm-azure-ewf-gm-overview"></a>
Overview</h1>
<p>This documentation is for the GMxxx ports of the Azure Embedded Wireless Framework.</p>
<ul>
<li>For more information on the framework see the documentation: <a href="https://azure.github.io/embedded-wireless-framework/html/index.html">https://azure.github.io/embedded-wireless-framework/html/index.html</a>.<ul>
<li>There are also various examples available for the RA6M4_EK: <a href="https://github.com/Azure/embedded-wireless-framework/tree/main/examples/EK-RA6M4">https://github.com/Azure/embedded-wireless-framework/tree/main/examples/EK-RA6M4</a>.</li>
</ul>
</li>
<li>For more GM02S hardware information including pin and baud rate info please see the GM02S page: <a href="https://sequans.com/products/monarch-2-gm02s/">https://sequans.com/products/monarch-2-gm02s/</a>.</li>
</ul>
<h2>Features</h2>
<ul>
<li>Various APIs to control/access GMxxx modem features via AT commands.</li>
<li>Raw AT command APIs</li>
<li>IPv4 sockets using TCP/UDP</li>
<li>The EWF framework is usable standalone with bare metal and ThreadX.</li>
<li>The framework can also be used with NetX when coupled with a EWF NetX middleware layer.</li>
</ul>
<h2>Limitations</h2>
<p>The following are the limitations of the Azure EWF Library:</p>
<ul>
<li>DTC is not supported. The lower level interface using R_UART relies on processing data one byte at a time via the interrupt callback and UART_EVENT_RX_CHAR.</li>
<li>Server mode sockets should be supported but have not been fully tested due to APN limitations.</li>
<li>There are potential issues when using the default (-Os) optimization or above with AC6. All files under embedded_wireless_framework should be set to compile with no optimization (-O0) when using AC6.</li>
<li><code>nx_ip_status_check</code> does not currently work for the EWF middleware.</li>
<li>When using socket send functions (<code>ewf_adapter_tcp_send</code> and <code>ewf_adapter_udp_send</code>) the GM port is limited to sending only 1460 bytes at a time. Data sent using these functions should be broken into 1460 byte chunks or less.<ul>
<li>When using NetX the packet size for the driver packet pool should be set to 1460 bytes or less. Using larger packet sizes will work but the NetX Middleware Driver will potentially break up the packets inefficiently.</li>
</ul>
</li>
</ul>
<h2>Unsupported NetX Duo Features</h2>
<p>These features are handled directly on the GMxxx hardware or are not supported yet in the EWF library. NetX APIs for these features should not be used:</p>
<ul>
<li>IPv6 functionality (the EWF library doesn't yet support IPv6)</li>
<li>ARP is handled directly by the cellular modem</li>
<li>DHCP is handled directly by the cellular modem.</li>
</ul>
<h1><a class="anchor" id="rm-azure-ewf-gm-configuration"></a>
Configuration</h1>
<p>The GM02S port for the Embedded Wireless Framework can be added to the Stacks tab via New Stack &gt; Networking &gt; Azure EWF Adapter on GM02S.</p>
<p><h2>Build Time Configurations for Common</h2>
The following build time configurations are defined in fsp_cfg/azure/ewf/ewf.config.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr class="tree_none">
<td>Parameter Checking</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>This enables checking of function parameters. When this is disabled, parameter checking code is not present and the footprint is reduced </td></tr>
<tr class="tree_none">
<td>Enable Logging</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>This enables logging and the compilation of debug code. When disabled, logging and debug code is not present and the footprint is reduced. </td></tr>
<tr class="tree_none">
<td>Verbose Logging</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>This enables verbose logging. Verbose logging will only work if a EWF Log Function is set and logging is enabled. </td></tr>
<tr class="tree_none">
<td>EWF Log Function</td><td>Manual Entry</td><td>printf(__VA_ARGS__) </td><td>Function the library uses for standard log messages when logging is enabled. </td></tr>
<tr class="tree_none">
<td>EWF Log Error Function</td><td>Manual Entry</td><td>printf(__VA_ARGS__) </td><td>Function the library uses for error log messages when logging is enabled. </td></tr>
</table>
</p>
<h1><a class="anchor" id="rm-azure-ewf-gm-usage_notes"></a>
Usage Notes</h1>
<p>The basic setup for the library is as follows:</p>
<dl class="section note"><dt>Note</dt><dd>**The message allocator (<code>EWF_ALLOCATOR_THREADX_STATIC_DECLARE</code>) should be at least 1500 bytes for GM**</dd></dl>
<ol type="1">
<li>Declare an allocator, interface, and adapter using appropriate macros (<code>EWF_ALLOCATOR_THREADX_STATIC_DECLARE</code>/<code>EWF_ALLOCATOR_MEMORY_POOL_STATIC_DECLARE</code>/<code>EWF_ALLOCATOR_C_HEAP_STATIC_DECLARE</code>, <code>EWF_INTERFACE_RA_UART_STATIC_DECLARE</code>, <code>EWF_ADAPTER_RENESAS_GM02S_STATIC_DECLARE</code>).</li>
<li>Start the adapter with <code>ewf_adapter_start</code>.</li>
<li>Setup modem service if necessary with functions from <code>ewf_adapter_api_modem.h</code> and other included <code>api_modem_*</code> files.</li>
<li>Set functionality with <code>ewf_adapter_modem_functionality_set</code>.</li>
<li>Wait for network registration (can use <code>ewf_adapter_modem_network_registration_check</code> to wait).</li>
<li>Do a service activate to set desired PDP context with <code>ewf_adapter_modem_packet_service_activate</code>. This should be called regardless of whether context is already activated as it sets an internal library context number for functions like <code>ewf_adapter_get_ipv4_address</code>.</li>
<li>Call other network functions as needed from desired headers (i.e. TCP functions are in <code>ewf_adapter_api_tcp.h</code>).</li>
</ol>
<p>When using NetX Duo the following must be done:</p>
<ul>
<li>Before creating an IP instance make sure that the modem adapter is started and connected to a network.</li>
<li>After creating an IP instance the adapter pointer has to be stored manually to the IP instance: <code>g_ip.nx_ip_interface-&gt;nx_interface_additional_link_info = adapter_ptr;</code>.</li>
<li>After creating an IP instance the gateway address should be set to the IP of the modem in order to satisfy NetX Duo's internal routing algorithms (packets are actually routed by the modem hardware): <code>nx_ip_gateway_address_set(&amp;g_ip, RM_NETXDUO_TESTS_IP_ADDR);</code>.</li>
</ul>
<h1><a class="anchor" id="rm-azure-ewf-gm-examples"></a>
Examples</h1>
<h2>Basic TCP Socket Example</h2>
<dl class="section note"><dt>Note</dt><dd>The user should choose the relevant EWF_ALLOCATOR and EWF_ADAPTER macros from this example to use based on the hardware and RTOS being used</dd></dl>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define EWF_LOG_BUFFER_SIZE                    (256)</span></div><div class="line"><span class="preprocessor">#define EWF_MODEM_NETWORK_WAIT_TIME_SECONDS    (30)</span></div><div class="line"><span class="preprocessor">#define EWF_HTTP_GET_SERVER                    &quot;www.microsoft.com&quot;</span></div><div class="line"><span class="preprocessor">#define EWF_HTTP_GET                           &quot;GET / HTTP/1.1\r\nHost:www.microsoft.com\r\n\r\n&quot;</span></div><div class="line"><span class="preprocessor">#define EWF_HTTP_PORT                          (80)</span></div><div class="line"></div><div class="line">ewf_allocator * message_allocator_ptr = NULL;</div><div class="line">ewf_interface * interface_ptr         = NULL;</div><div class="line">ewf_adapter   * adapter_ptr           = NULL;</div><div class="line"><span class="keywordtype">char</span>            ewf_log_buffer[EWF_LOG_BUFFER_SIZE];</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rm_azure_ewf_gm_example ()</div><div class="line">{</div><div class="line">    <span class="keyword">static</span> uint8_t buffer[2048];       <span class="comment">// NOLINT</span></div><div class="line">    uint32_t       buffer_length = <span class="keyword">sizeof</span>(buffer);</div><div class="line"></div><div class="line">    <span class="comment">/* Azure library has macros to declare/allocate structs and pointers.</span></div><div class="line"><span class="comment">     * Different ones should be used depending on Adapter and whether the library is being used on bare metal or ThreadX */</span></div><div class="line"></div><div class="line">    <span class="comment">/* This is for the memory allocator using ThreadX block pools */</span></div><div class="line">    EWF_ALLOCATOR_THREADX_STATIC_DECLARE(message_allocator_ptr, message_allocator, 12, 2048);</div><div class="line"></div><div class="line">    <span class="comment">/* This is for the memory allocator using static memory on bare metal */</span></div><div class="line">    EWF_ALLOCATOR_MEMORY_POOL_STATIC_DECLARE(message_allocator_ptr, message_allocator, 12, 2048);</div><div class="line"></div><div class="line">    <span class="comment">/* This is for the memory allocator using the heap on bare metal */</span></div><div class="line">    EWF_ALLOCATOR_C_HEAP_STATIC_DECLARE(message_allocator_ptr, message_allocator, 12, 2048);</div><div class="line"></div><div class="line">    <span class="comment">/* This is for the communications interface using R_UART */</span></div><div class="line">    EWF_INTERFACE_RA_UART_STATIC_DECLARE(interface_ptr, sci_uart);</div><div class="line"></div><div class="line">    <span class="comment">/* If using GM01Q */</span></div><div class="line">    EWF_ADAPTER_RENESAS_GM01Q_STATIC_DECLARE(adapter_ptr, renesas_gm01q, message_allocator_ptr, NULL, interface_ptr);</div><div class="line"></div><div class="line">    <span class="comment">/* If using GM02S */</span></div><div class="line">    EWF_ADAPTER_RENESAS_GM02S_STATIC_DECLARE(adapter_ptr, renesas_gm02s, message_allocator_ptr, NULL, interface_ptr);</div><div class="line"></div><div class="line">    <span class="comment">/* Start the adapter */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_start(adapter_ptr));</div><div class="line"></div><div class="line">    <span class="comment">/* Set the ME functionality */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_modem_functionality_set(adapter_ptr, <span class="stringliteral">&quot;1&quot;</span>));</div><div class="line"></div><div class="line">    <span class="comment">/* Wait for the modem functionality to be up */</span></div><div class="line">    assert(EWF_RESULT_OK ==</div><div class="line">           ewf_adapter_modem_network_registration_check(adapter_ptr, EWF_ADAPTER_MODEM_CMD_QUERY_EPS_NETWORK_REG,</div><div class="line">                                                        EWF_MODEM_NETWORK_WAIT_TIME_SECONDS));</div><div class="line"></div><div class="line">    <span class="comment">/* Do a service activate to set context num correctly */</span></div><div class="line">    ewf_adapter_modem_packet_service_activate(adapter_ptr, 1);</div><div class="line"></div><div class="line">    ewf_socket_tcp socket_tcp = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Open TCP Socket */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_open(adapter_ptr, &amp;socket_tcp));</div><div class="line"></div><div class="line">    <span class="comment">/* Connect to server */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_connect(&amp;socket_tcp, EWF_HTTP_GET_SERVER, EWF_HTTP_PORT));</div><div class="line"></div><div class="line">    <span class="comment">/* Send HTTP GET */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_send(&amp;socket_tcp, (<span class="keyword">const</span> uint8_t *) EWF_HTTP_GET, strlen(EWF_HTTP_GET)));</div><div class="line"></div><div class="line">    <span class="comment">/* Receive HTTP GET response */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_receive(&amp;socket_tcp, buffer, &amp;buffer_length, <span class="keyword">true</span>));</div><div class="line"></div><div class="line">    <span class="comment">/* Shutdown socket connection to server */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_shutdown(&amp;socket_tcp));</div><div class="line"></div><div class="line">    <span class="comment">/* Close/destroy socket */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_tcp_close(&amp;socket_tcp));</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>NetX Duo Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#define NETXDUO_EXAMPLE_PACKET_SIZE         (1568U)</span></div><div class="line"><span class="preprocessor">#define NETXDUO_EXAMPLE_PACKET_NUM          (100U)</span></div><div class="line"><span class="preprocessor">#define NETXDUO_EXAMPLE_PACKET_POOL_SIZE    ((sizeof(NX_PACKET) + NETXDUO_EXAMPLE_PACKET_SIZE) * \</span></div><div class="line"><span class="preprocessor">                                             NETXDUO_EXAMPLE_PACKET_NUM)</span></div><div class="line"><span class="preprocessor">#define NETXDUO_EXAMPLE_IP_STACK_SIZE       (2048U)</span></div><div class="line"></div><div class="line">NX_PACKET_POOL g_packet_pool;</div><div class="line">NX_IP          g_ip;</div><div class="line"><span class="keyword">static</span> uint8_t g_ip_stack_memory[NETXDUO_EXAMPLE_IP_STACK_SIZE] BSP_ALIGN_VARIABLE(4);</div><div class="line"><span class="keyword">static</span> uint8_t g_packet_pool_memory[NETXDUO_EXAMPLE_PACKET_POOL_SIZE] BSP_ALIGN_VARIABLE(4);</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> rm_azure_ewf_gm_netx_example ()</div><div class="line">{</div><div class="line">    uint32_t modem_ip_addr;</div><div class="line"></div><div class="line">    <span class="comment">/* Azure library has macros to declare/allocate structs and pointers.</span></div><div class="line"><span class="comment">     * Different ones should be used depending on Adapter and whether the library is being used on bare metal or ThreadX */</span></div><div class="line"></div><div class="line">    <span class="comment">/* This is for the memory allocator using ThreadX block pools */</span></div><div class="line">    EWF_ALLOCATOR_THREADX_STATIC_DECLARE(message_allocator_ptr, message_allocator, 12, 2048);</div><div class="line"></div><div class="line">    <span class="comment">/* This is for the communications interface using R_UART */</span></div><div class="line">    EWF_INTERFACE_RA_UART_STATIC_DECLARE(interface_ptr, sci_uart);</div><div class="line"></div><div class="line">    <span class="comment">/* If using GM01Q */</span></div><div class="line">    EWF_ADAPTER_RENESAS_GM01Q_STATIC_DECLARE(adapter_ptr, renesas_gm01q, message_allocator_ptr, NULL, interface_ptr);</div><div class="line"></div><div class="line">    <span class="comment">/* If using GM02S */</span></div><div class="line">    EWF_ADAPTER_RENESAS_GM02S_STATIC_DECLARE(adapter_ptr, renesas_gm02s, message_allocator_ptr, NULL, interface_ptr);</div><div class="line"></div><div class="line">    <span class="comment">/* Start the adapter */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_start(adapter_ptr));</div><div class="line"></div><div class="line">    <span class="comment">/* Set the ME functionality */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_modem_functionality_set(adapter_ptr, <span class="stringliteral">&quot;1&quot;</span>));</div><div class="line"></div><div class="line">    <span class="comment">/* Wait for the modem functionality to be up */</span></div><div class="line">    assert(EWF_RESULT_OK ==</div><div class="line">           ewf_adapter_modem_network_registration_check(adapter_ptr, EWF_ADAPTER_MODEM_CMD_QUERY_EPS_NETWORK_REG,</div><div class="line">                                                        EWF_MODEM_NETWORK_WAIT_TIME_SECONDS));</div><div class="line"></div><div class="line">    <span class="comment">/* Do a service activate to set context num correctly */</span></div><div class="line">    ewf_adapter_modem_packet_service_activate(adapter_ptr, 1);</div><div class="line"></div><div class="line">    <span class="comment">/* Get modem IP */</span></div><div class="line">    assert(EWF_RESULT_OK == ewf_adapter_get_ipv4_address(adapter_ptr, &amp;modem_ip_addr));</div><div class="line"></div><div class="line">    UINT status;</div><div class="line"></div><div class="line">    <span class="comment">/* Create a packet pool */</span></div><div class="line">    status = nx_packet_pool_create(&amp;g_packet_pool,</div><div class="line">                                   <span class="stringliteral">&quot;Packet Pool&quot;</span>,</div><div class="line">                                   NETXDUO_EXAMPLE_PACKET_SIZE,</div><div class="line">                                   &amp;g_packet_pool_memory[0],</div><div class="line">                                   NETXDUO_EXAMPLE_PACKET_POOL_SIZE);</div><div class="line">    assert(NX_SUCCESS == status);</div><div class="line"></div><div class="line">    <span class="comment">/* Create an IP instance using EWF middleware */</span></div><div class="line">    status = nx_ip_create(&amp;g_ip,</div><div class="line">                          <span class="stringliteral">&quot;IP Instance&quot;</span>,</div><div class="line">                          modem_ip_addr,</div><div class="line">                          IP_ADDRESS(255, 255, 255, 0),</div><div class="line">                          &amp;g_packet_pool,</div><div class="line">                          nx_driver_ewf_adapter,</div><div class="line">                          &amp;g_ip_stack_memory[0],</div><div class="line">                          <span class="keyword">sizeof</span>(g_ip_stack_memory),</div><div class="line">                          15);</div><div class="line">    assert(NX_SUCCESS == status);</div><div class="line"></div><div class="line">    <span class="comment">/* Save the adapter pointer in the IP instance */</span></div><div class="line">    g_ip.nx_ip_interface-&gt;nx_interface_additional_link_info = adapter_ptr;</div><div class="line"></div><div class="line">    <span class="comment">/* EWF requires gateway address to be set */</span></div><div class="line">    status = nx_ip_gateway_address_set(&amp;g_ip, modem_ip_addr);</div><div class="line">    assert(NX_SUCCESS == status);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v6.2.0 User's Manual Copyright © (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
