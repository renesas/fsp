<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Motor Driver (rm_motor_driver)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v3.2.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">
 
    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text"> 
      </span>
      <span class="right">
          &nbsp; 
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___m_o_t_o_r___d_r_i_v_e_r.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() { 
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body. 
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works 
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len)); 
            }
          } 
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }    
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element. 
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;  
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Motor Driver (rm_motor_driver)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4bd2f8839a086bd8a9d43f621a21457e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga4bd2f8839a086bd8a9d43f621a21457e">RM_MOTOR_DRIVER_Open</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl, <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__cfg__t">motor_driver_cfg_t</a> const *const p_cfg)</td></tr>
<tr class="memdesc:ga4bd2f8839a086bd8a9d43f621a21457e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens and configures the Motor Driver module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a8429930c08fa6bdb6222d8ab066c5aa9">motor_driver_api_t::open</a>.  <a href="#ga4bd2f8839a086bd8a9d43f621a21457e">More...</a><br /></td></tr>
<tr class="separator:ga4bd2f8839a086bd8a9d43f621a21457e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8578efe055c99d6df3e22c50c4b4a19f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga8578efe055c99d6df3e22c50c4b4a19f">RM_MOTOR_DRIVER_Close</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl)</td></tr>
<tr class="memdesc:ga8578efe055c99d6df3e22c50c4b4a19f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disables specified Motor Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a5bfdf8db1c43883461a5e4239b3b2b45">motor_driver_api_t::close</a>.  <a href="#ga8578efe055c99d6df3e22c50c4b4a19f">More...</a><br /></td></tr>
<tr class="separator:ga8578efe055c99d6df3e22c50c4b4a19f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47e6e5e673759ff4a9a4f6732d684114"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga47e6e5e673759ff4a9a4f6732d684114">RM_MOTOR_DRIVER_Reset</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl)</td></tr>
<tr class="memdesc:ga47e6e5e673759ff4a9a4f6732d684114"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset variables of Motor Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a504ed01b6321cf200d8401b023039bfd">motor_driver_api_t::reset</a>.  <a href="#ga47e6e5e673759ff4a9a4f6732d684114">More...</a><br /></td></tr>
<tr class="separator:ga47e6e5e673759ff4a9a4f6732d684114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4b6a5885ff92438ae5aa4bec910c2d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#gab4b6a5885ff92438ae5aa4bec910c2d7">RM_MOTOR_DRIVER_PhaseVoltageSet</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl, float const u_voltage, float const v_voltage, float const w_voltage)</td></tr>
<tr class="memdesc:gab4b6a5885ff92438ae5aa4bec910c2d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Phase Voltage Data to calculate PWM duty. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a3ed32f76b4f974931c3387d59b0bde4c">motor_driver_api_t::phaseVoltageSet</a>.  <a href="#gab4b6a5885ff92438ae5aa4bec910c2d7">More...</a><br /></td></tr>
<tr class="separator:gab4b6a5885ff92438ae5aa4bec910c2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd93daea13fa1de8ca55d0d455dbac8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#gabd93daea13fa1de8ca55d0d455dbac8b">RM_MOTOR_DRIVER_CurrentGet</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl, <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__current__get__t">motor_driver_current_get_t</a> *const p_current_get)</td></tr>
<tr class="memdesc:gabd93daea13fa1de8ca55d0d455dbac8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get calculated phase Current, Vdc &amp; Va_max data. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a8b6a7b3b6b6065ff3276632c33f34c07">motor_driver_api_t::currentGet</a>.  <a href="#gabd93daea13fa1de8ca55d0d455dbac8b">More...</a><br /></td></tr>
<tr class="separator:gabd93daea13fa1de8ca55d0d455dbac8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga633b9d92ae17f4a177d5cf9d7e606433"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga633b9d92ae17f4a177d5cf9d7e606433">RM_MOTOR_DRIVER_FlagCurrentOffsetGet</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl, uint8_t *const p_flag_offset)</td></tr>
<tr class="memdesc:ga633b9d92ae17f4a177d5cf9d7e606433"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the flag of finish current offset detection. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a757b8d7120439ce9903deedbfb73b46c">motor_driver_api_t::flagCurrentOffsetGet</a>.  <a href="#ga633b9d92ae17f4a177d5cf9d7e606433">More...</a><br /></td></tr>
<tr class="separator:ga633b9d92ae17f4a177d5cf9d7e606433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31885205fdac5a3334f950c5a4ba5d2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga31885205fdac5a3334f950c5a4ba5d2e">RM_MOTOR_DRIVER_CurrentOffsetRestart</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl)</td></tr>
<tr class="memdesc:ga31885205fdac5a3334f950c5a4ba5d2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart the current offset detection. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#adae5b042125b32e5a4a5247233ed62be">motor_driver_api_t::currentOffsetRestart</a>.  <a href="#ga31885205fdac5a3334f950c5a4ba5d2e">More...</a><br /></td></tr>
<tr class="separator:ga31885205fdac5a3334f950c5a4ba5d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90e9bf7d09f25ca18cdb735798ca5c1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga90e9bf7d09f25ca18cdb735798ca5c1e">RM_MOTOR_DRIVER_ParameterUpdate</a> (<a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const p_ctrl, <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__cfg__t">motor_driver_cfg_t</a> const *const p_cfg)</td></tr>
<tr class="memdesc:ga90e9bf7d09f25ca18cdb735798ca5c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the parameters of Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a95a0311d62025b0b3f92255fe2198e52">motor_driver_api_t::parameterUpdate</a>.  <a href="#ga90e9bf7d09f25ca18cdb735798ca5c1e">More...</a><br /></td></tr>
<tr class="separator:ga90e9bf7d09f25ca18cdb735798ca5c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Calculation process for the motor control on RA MCUs. This module implements the <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html">Motor driver Interface</a>. </p>
<h1><a class="anchor" id="rm-motor_driver-overview"></a>
Overview</h1>
<p>The motor driver module is used to translate phase voltage to PWM duty and output PWM, and detect phase current and main line voltage. This module should be called cyclically at included A/D Conversion finish interrupt.</p>
<h2><a class="anchor" id="rm-motor_driver-features"></a>
Features</h2>
<p>The Motor Driver Module has below features.</p><ul>
<li>Calculate each phase(U/V/W) PWM duty according to reference and output PWM.</li>
<li>Detect each phase current and main line voltage.</li>
<li>Detect and correct A/D offset at phase current channel</li>
</ul>
<h1><a class="anchor" id="rm-motor_driver-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for rm_motor_driver</h2>
The following build time configurations are defined in fsp_cfg/rm_motor_driver_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Parameter Checking</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Default (BSP)</li>
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Default (BSP) </td><td>If selected code for parameter checking is included in the build. </td></tr>
</table>
 <h2>Configurations for Middleware &gt; Motor &gt; ADC and PWM Modulation Driver on rm_motor_driver</h2>
This module can be added to the Stacks tab via New Stack &gt; Middleware &gt; Motor &gt; ADC and PWM Modulation Driver on rm_motor_driver .<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>General &gt; Name</td><td>Name must be a valid C symbol</td><td>g_motor_driver0 </td><td>Module name. </td></tr>
<tr>
<td>General &gt; PWM Timer Frequency[MHz]</td><td>Manual Entry</td><td>120 </td><td>GPT PWM Timer Frequency </td></tr>
<tr>
<td>General &gt; PWM Carrier Period[Microseconds]</td><td>Manual Entry</td><td>50 </td><td>GPT PWM Carrier Period </td></tr>
<tr>
<td>General &gt; Dead Time[Raw Counts]</td><td>Manual Entry</td><td>240 </td><td>GPT PWM Dead Time </td></tr>
<tr>
<td>General &gt; Current Range[A]</td><td>Manual Entry</td><td>27.5F </td><td>Current Range to measure(Maximum input current) </td></tr>
<tr>
<td>General &gt; Voltage Range[V]</td><td>Manual Entry</td><td>111.0F </td><td>Voltage Range to measure(Maximum input Main Line Voltage) </td></tr>
<tr>
<td>General &gt; Counts for current offset measurement</td><td>Manual Entry</td><td>500 </td><td>How many times to measure current offset </td></tr>
<tr>
<td>General &gt; A/D conversion channel for U Phase current</td><td>Manual Entry</td><td>0 </td><td>Specify the A/D channel for U Phase current </td></tr>
<tr>
<td>General &gt; A/D conversion channel for W Phase current</td><td>Manual Entry</td><td>2 </td><td>Specify the A/D channel for W Phase current </td></tr>
<tr>
<td>General &gt; A/D conversion channel for Main Line Voltage</td><td>Manual Entry</td><td>5 </td><td>Specify the A/D channel for Main Line Voltage </td></tr>
<tr>
<td>General &gt; Input Voltage</td><td>Manual Entry</td><td>24.0F </td><td>Input Voltage </td></tr>
<tr>
<td>General &gt; Resolution of A/D conversion</td><td>Manual Entry</td><td>0xFFF </td><td>Resolution of A/D conversion </td></tr>
<tr>
<td>General &gt; Offset of A/D conversion for current</td><td>Manual Entry</td><td>0x745 </td><td>Offset of A/D conversion for current </td></tr>
<tr>
<td>General &gt; Conversion level of A/D conversion for voltage</td><td>Manual Entry</td><td>0.6F </td><td>Conversion level of A/D conversion for voltage </td></tr>
<tr>
<td>General &gt; GTIOCA Stop Level</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Pin Level Low</li>
<li>
Pin Level High</li>
</ul>
</td><td>Pin Level High </td><td>Select the behavior of the output pin when the timer is stopped. </td></tr>
<tr>
<td>General &gt; GTIOCB Stop Level</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Pin Level Low</li>
<li>
Pin Level High</li>
</ul>
</td><td>Pin Level High </td><td>Select the behavior of the output pin when the timer is stopped. </td></tr>
<tr>
<td>Modulation &gt; Maximum Duty</td><td>Manual Entry</td><td>0.9375F </td><td>Maximum Duty of PWM </td></tr>
<tr>
<td>Interrupts &gt; Callback</td><td>Name must be a valid C symbol</td><td>NULL </td><td>A user callback function. If this callback function is provided, it is called at A/D conversion finish interrupt. </td></tr>
</table>
</p>
<h2><a class="anchor" id="rm-motor_driver-clock-configuration"></a>
Clock Configuration</h2>
<p>Set used clock with included GPT timer.</p>
<h2><a class="anchor" id="rm-motor_driver-pin-configuration"></a>
Pin Configuration</h2>
<p>Depend on included GPT Three Phase Module and ADC Module.</p>
<h1><a class="anchor" id="rm-motor_driver-usage_notes"></a>
Usage Notes</h1>
<h2><a class="anchor" id="rm-motor_driver-limitations"></a>
Limitations</h2>
<p>Basically no limitation exists.</p>
<h1><a class="anchor" id="rm-motor_driver-examples"></a>
Examples</h1>
<h2>Basic Example</h2>
<p>This is a basic example of minimal use of the Motor Driver in an application.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> motor_driver_basic_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err = FSP_SUCCESS;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Initializes the module. */</span></div><div class="line">    err = <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga4bd2f8839a086bd8a9d43f621a21457e">RM_MOTOR_DRIVER_Open</a>(&amp;g_motor_driver0.p_ctrl, &amp;g_motor_driver0.p_cfg);</div><div class="line"></div><div class="line"></div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Basically run this module at cyclic interrupt (e.g. included GPT PWM Carrier intterupt).</span></div><div class="line"><span class="comment">     * This implementation is an example. */</span></div><div class="line"></div><div class="line">    <span class="comment">// while (true)</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Application work here. */</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">/* Get electric current, main line voltage and maximum voltage component */</span></div><div class="line">        (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#gabd93daea13fa1de8ca55d0d455dbac8b">RM_MOTOR_DRIVER_CurrentGet</a>(&amp;g_motor_driver0.p_ctrl, &amp;f_get_iu, &amp;f_get_iw, &amp;f_get_vdc, &amp;f_get_va_max);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">/* Get the flag of A/D convderted current offset */</span></div><div class="line">        (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga633b9d92ae17f4a177d5cf9d7e606433">RM_MOTOR_DRIVER_FlagCurrentOffsetGet</a>(&amp;g_motor_driver0.p_ctrl, &amp;u1_get_flg_offset);</div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">// Perform current control process here</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment">/* Set phase voltage */</span></div><div class="line">        (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#gab4b6a5885ff92438ae5aa4bec910c2d7">RM_MOTOR_DRIVER_PhaseVoltageSet</a>(&amp;g_motor_driver0.p_ctrl, 1.0F, 1.0F, 1.0F);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga90e9bf7d09f25ca18cdb735798ca5c1e">RM_MOTOR_DRIVER_ParameterUpdate</a>(&amp;g_motor_driver0.p_ctrl, &amp;g_motor_driver0.p_cfg);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga47e6e5e673759ff4a9a4f6732d684114">RM_MOTOR_DRIVER_Reset</a>(&amp;g_motor_driver0.p_ctrl);</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line"><span class="comment"></span></div><div class="line">    (void) <a class="code" href="group___m_o_t_o_r___d_r_i_v_e_r.html#ga8578efe055c99d6df3e22c50c4b4a19f">RM_MOTOR_DRIVER_Close</a>(&amp;g_motor_driver0.p_ctrl);</div><div class="line"></div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2 class="groupheader">Function Documentation</h2>
<a id="ga4bd2f8839a086bd8a9d43f621a21457e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4bd2f8839a086bd8a9d43f621a21457e">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_Open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_Open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__cfg__t">motor_driver_cfg_t</a> const *const&#160;</td>
          <td class="paramname"><em>p_cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens and configures the Motor Driver module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a8429930c08fa6bdb6222d8ab066c5aa9">motor_driver_api_t::open</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Motor Driver successfully configured. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer, or one or more configuration options is invalid. </td></tr>
    <tr><td class="paramname">FSP_ERR_ALREADY_OPEN</td><td>Module is already open. This module can only be opened once. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8578efe055c99d6df3e22c50c4b4a19f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8578efe055c99d6df3e22c50c4b4a19f">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_Close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_Close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disables specified Motor Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a5bfdf8db1c43883461a5e4239b3b2b45">motor_driver_api_t::close</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successfully closed. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga47e6e5e673759ff4a9a4f6732d684114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47e6e5e673759ff4a9a4f6732d684114">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_Reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_Reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset variables of Motor Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a504ed01b6321cf200d8401b023039bfd">motor_driver_api_t::reset</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successfully reset. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab4b6a5885ff92438ae5aa4bec910c2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4b6a5885ff92438ae5aa4bec910c2d7">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_PhaseVoltageSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_PhaseVoltageSet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float const&#160;</td>
          <td class="paramname"><em>u_voltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float const&#160;</td>
          <td class="paramname"><em>v_voltage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float const&#160;</td>
          <td class="paramname"><em>w_voltage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set Phase Voltage Data to calculate PWM duty. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a3ed32f76b4f974931c3387d59b0bde4c">motor_driver_api_t::phaseVoltageSet</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successfully data is set. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabd93daea13fa1de8ca55d0d455dbac8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabd93daea13fa1de8ca55d0d455dbac8b">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_CurrentGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_CurrentGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__current__get__t">motor_driver_current_get_t</a> *const&#160;</td>
          <td class="paramname"><em>p_current_get</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get calculated phase Current, Vdc &amp; Va_max data. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a8b6a7b3b6b6065ff3276632c33f34c07">motor_driver_api_t::currentGet</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successful data get. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
    <tr><td class="paramname">FSP_ERR_INVALID_ARGUMENT</td><td>Input parameter error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga633b9d92ae17f4a177d5cf9d7e606433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga633b9d92ae17f4a177d5cf9d7e606433">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_FlagCurrentOffsetGet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_FlagCurrentOffsetGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_flag_offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the flag of finish current offset detection. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a757b8d7120439ce9903deedbfb73b46c">motor_driver_api_t::flagCurrentOffsetGet</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successful data get. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
    <tr><td class="paramname">FSP_ERR_INVALID_ARGUMENT</td><td>Input parameter error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga31885205fdac5a3334f950c5a4ba5d2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31885205fdac5a3334f950c5a4ba5d2e">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_CurrentOffsetRestart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_CurrentOffsetRestart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restart the current offset detection. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#adae5b042125b32e5a4a5247233ed62be">motor_driver_api_t::currentOffsetRestart</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successfully restarted. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga90e9bf7d09f25ca18cdb735798ca5c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90e9bf7d09f25ca18cdb735798ca5c1e">&#9670;&nbsp;</a></span>RM_MOTOR_DRIVER_ParameterUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_MOTOR_DRIVER_ParameterUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#gafa26e3bdab89f248d2798b0d7f6c2e73">motor_driver_ctrl_t</a> *const&#160;</td>
          <td class="paramname"><em>p_ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#structmotor__driver__cfg__t">motor_driver_cfg_t</a> const *const&#160;</td>
          <td class="paramname"><em>p_cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the parameters of Driver Module. Implements <a class="el" href="group___m_o_t_o_r___d_r_i_v_e_r___a_p_i.html#a95a0311d62025b0b3f92255fe2198e52">motor_driver_api_t::parameterUpdate</a>. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Successfully data was updated. </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>Null pointer. </td></tr>
    <tr><td class="paramname">FSP_ERR_NOT_OPEN</td><td>Module is not open. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v3.2.0 User's Manual Copyright Â© (2021) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
