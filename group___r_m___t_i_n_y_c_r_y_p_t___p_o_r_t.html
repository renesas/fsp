<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: TinyCrypt H/W Acceleration (rm_tinycrypt_port)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed"); 
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");	
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
     }); 
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v5.8.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">
 
    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text"> 
      </span>
      <span class="right">
          &nbsp; 
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() { 
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body. 
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works 
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len)); 
            }
          } 
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }    
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element. 
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;  
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TinyCrypt H/W Acceleration (rm_tinycrypt_port)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> &raquo; <a class="el" href="group___r_e_n_e_s_a_s___s_e_c_u_r_i_t_y___m_o_d_u_l_e_s.html">Security</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga61682df07075c19ebb327063d5ba6e8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga61682df07075c19ebb327063d5ba6e8b">RM_TINCYRYPT_PORT_Init</a> ()</td></tr>
<tr class="separator:ga61682df07075c19ebb327063d5ba6e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c2f26b3efb9ca315f40754bfb926eb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga7c2f26b3efb9ca315f40754bfb926eb0">RM_TINCYRYPT_PORT_TRNG_Read</a> (uint8_t *const p_rngbuf, uint32_t num_req_bytes)</td></tr>
<tr class="memdesc:ga7c2f26b3efb9ca315f40754bfb926eb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads requested length of random data from the TRNG. Generate <code>num_req_bytes</code> of random bytes and store them in <code>p_rngbuf</code> buffer.  <a href="#ga7c2f26b3efb9ca315f40754bfb926eb0">More...</a><br /></td></tr>
<tr class="separator:ga7c2f26b3efb9ca315f40754bfb926eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09389b89e02115f59a1da9cccc0b09f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga09389b89e02115f59a1da9cccc0b09f8">default_CSPRNG</a> (uint8_t *dest, unsigned int size)</td></tr>
<tr class="memdesc:ga09389b89e02115f59a1da9cccc0b09f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implements the Cryptographically Secure Pseudo-Random Number Generator function required byt TinyCrypt.  <a href="#ga09389b89e02115f59a1da9cccc0b09f8">More...</a><br /></td></tr>
<tr class="separator:ga09389b89e02115f59a1da9cccc0b09f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>AES128 Hardware acceleration for TinyCrypt on the RA2 family. </p>
<h1><a class="anchor" id="rm-tinycrypt-overview"></a>
Overview</h1>
<dl class="section note"><dt>Note</dt><dd><b>The TinyCrypt port module does not provide any interfaces to the user. Consult the documentation at <a href="https://github.com/intel/tinycrypt/blob/master/documentation/tinycrypt.rst">https://github.com/intel/tinycrypt/blob/master/documentation/tinycrypt.rst</a> for further information.</b></dd></dl>
<p>TinyCrypt is designed as a small footprint software crypto implementation to be used on resource constrained devices. The software only module is available in FSP on all RA devices. Hardware acceleration for AES-128 is provided only for the RA2 family. This release uses TinyCrypt v0.2.8.</p>
<h2>Hardware Overview</h2>
<table class="doxtable">
<tr>
<th>Crypto Peripheral version </th><th>Devices  </th></tr>
<tr>
<td>AES Engine </td><td>RA2A1, RA2E1, RA2L1 </td></tr>
</table>
<h2><a class="anchor" id="rm-tinycrypt-features"></a>
Features</h2>
<p>For features supported by the software-only version, refer to the TinyCrypt documentation.</p>
<p>The TinyCrypt port module provides hardware support for the following operations</p><ul>
<li>AES<ul>
<li>Keybits - 128, 192, 256 <a class="anchor" id="um_tc_AES128_encryption_decryption"></a><a class="anchor" id="um_tc_AES192_encryption_decryption"></a><a class="anchor" id="um_tc_AES256_encryption_decryption"></a></li>
<li>ECB, CBC, CTR, CCM, GCM and CMAC modes <a class="anchor" id="um_tc_AES128_cbc_encryption_decryption"></a><a class="anchor" id="um_tc_AES192_cbc_encryption_decryption"></a><a class="anchor" id="um_tc_AES256_cbc_encryption_decryption"></a><a class="anchor" id="um_tc_AES128_ctr_encryption_decryption"></a><a class="anchor" id="um_tc_AES128_ctr_encryption_decryption_hw"></a><a class="anchor" id="um_tc_AES192_ctr_encryption_decryption_hw"></a><a class="anchor" id="um_tc_AES256_ctr_encryption_decryption_hw"></a><a class="anchor" id="um_tc_AES128_gcm_encryption"></a><a class="anchor" id="um_tc_AES128_gcm_decryption"></a><a class="anchor" id="um_tc_AES128_gcm_decryption_abnormal"></a><a class="anchor" id="um_tc_AES128_gcm_encryption_decryption_large_pt"></a><a class="anchor" id="um_tc_AES192_gcm_encryption"></a><a class="anchor" id="um_tc_AES192_gcm_decryption"></a><a class="anchor" id="um_tc_AES192_gcm_decryption_abnormal"></a><a class="anchor" id="um_tc_AES192_gcm_encryption_decryption_large_pt"></a><a class="anchor" id="um_tc_AES256_gcm_encryption"></a><a class="anchor" id="um_tc_AES256_gcm_decryption"></a><a class="anchor" id="um_tc_AES256_gcm_decryption_abnormal"></a><a class="anchor" id="um_tc_AES256_gcm_encryption_decryption_large_pt"></a><a class="anchor" id="um_tc_AES128_ccm_encryption"></a><a class="anchor" id="um_tc_AES192_ccm_encryption"></a><a class="anchor" id="um_tc_AES256_ccm_encryption"></a><a class="anchor" id="um_tc_AES128_ccm_decryption"></a><a class="anchor" id="um_tc_AES192_ccm_decryption"></a><a class="anchor" id="um_tc_AES256_ccm_decryption"></a><a class="anchor" id="um_tc_AES128_cmac_computation"></a><a class="anchor" id="um_tc_AES192_cmac_computation"></a><a class="anchor" id="um_tc_AES256_cmac_computation"></a><a class="anchor" id="um_tc_AES128_gcm_96bits_iv"></a><a class="anchor" id="um_tc_AES192_gcm_96bits_iv"></a><a class="anchor" id="um_tc_AES256_gcm_96bits_iv"></a><a class="anchor" id="um_tc_AES128_gcm_null_aad"></a><a class="anchor" id="um_tc_AES192_gcm_null_aad"></a><a class="anchor" id="um_tc_AES256_gcm_null_aad"></a><a class="anchor" id="um_tc_AES128_gcm_null_aad_null_pt"></a><a class="anchor" id="um_tc_AES192_gcm_null_aad_null_pt"></a><a class="anchor" id="um_tc_AES256_gcm_null_aad_null_pt"></a> -TRNG <a class="anchor" id="um_rng_hardware_acceleration"></a> </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="rm-tinycrypt-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for TinyCrypt_Acceleration</h2>
The following build time configurations are defined in fsp_cfg/rm_tinycrypt_port_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr class="tree_none">
<td>Parameter Checking</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Default (BSP)</li>
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Default (BSP) </td><td>If selected code for parameter checking is included in the build. </td></tr>
</table>
</p>
<h2><a class="anchor" id="rm-tinycrypt-aes-configuration"></a>
AES Configuration</h2>
<p>To enable hardware acceleration for the AES128 operation, choose TinyCrypt (H/W Accelerated) from the stack options . This feature is only supported on the RA2 family.</p>
<h1><a class="anchor" id="rm-tinycrypt-usage-notes"></a>
Usage Notes</h1>
<h2><a class="anchor" id="rm-tinycrypt-hardware-init"></a>
Hardware Initialization</h2>
<p>Invoke RM_TINCYRYPT_PORT_Init () to initialize the hardware before using Tinycrypt if either hardware acceleration or the TRNG is to be used.</p>
<h2><a class="anchor" id="rm-tinycrypt-prng_usage"></a>
Random Number Generation</h2>
<p>There are two Pseudo-random Number Generators (PRNG) provided in TinyCrypt</p>
<ul>
<li>CTR-PRNG which uses AES128 internally in its implementation. Enabling AES128 hardware acceleration will improve the performance of this module.</li>
<li>HMAC-PRNG which uses SHA256 internally in its implementation.</li>
</ul>
<p><b> Both these implementations will only be able to provide a random pseudo-random number sequence if they are seeded with truly random data. The TRNG module that is present in hardware and available in rm_tinycrypt_port must be used to seed these modules.</b> <a class="anchor" id="um_tc_prng_seed"></a>When using CTR-PRNG or HMAC-PRNG, use the <a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga7c2f26b3efb9ca315f40754bfb926eb0" title="Reads requested length of random data from the TRNG. Generate num_req_bytes of random bytes and store...">RM_TINCYRYPT_PORT_TRNG_Read()</a> function to obtain random data from the TRNG hardware and use that to seed the PRNG modules before invoking the pseudo-random number generation. If purely random data is sufficient for the application, then <a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga7c2f26b3efb9ca315f40754bfb926eb0" title="Reads requested length of random data from the TRNG. Generate num_req_bytes of random bytes and store...">RM_TINCYRYPT_PORT_TRNG_Read()</a> can be used directly instead. The hardware TRNG implements the CTR_DRBG spec.</p>
<h2><a class="anchor" id="rm-tinycrypt-csprng_usage"></a>
Default CSPRNG</h2>
<p>The TinyCrypt ECC implementation requires a platform specific implementation of the <a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga09389b89e02115f59a1da9cccc0b09f8" title="Implements the Cryptographically Secure Pseudo-Random Number Generator function required byt TinyCryp...">default_CSPRNG()</a> function. This function has been implemented using the hardware TRNG in the port to support software ECC usage. When using TinyCrypt in S/W mode, it is necessary to implement <a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga09389b89e02115f59a1da9cccc0b09f8" title="Implements the Cryptographically Secure Pseudo-Random Number Generator function required byt TinyCryp...">default_CSPRNG()</a> if using ECC signature generation (ECDSA) or key derivation (ECDH).</p>
<h2><a class="anchor" id="rm-tinycrypt-aes-usage"></a>
AES-128 Usage</h2>
<p>The AES ECB mode implementation is provided in aes_encrypt.decrypt.c. All the other modes of AES operation including CBC, CCN, CMAC and CTR use the ECB mode for the block operation. On the RA2, the ECB mode has been hardware accelerated which improves performance of the other modes as well. Additionally the CBC and CTR modes are also accelerated.</p>
<p>To use the different AES modes, first initialize the hardware (on the RA2) and then use the functions defined in the header file of each AES mode. Note that TinyCrypt does not provide any type of padding or buffering so the data provided to these modes should be multiples of AES block size.</p>
<h2>Usage with RA2A2</h2>
<p>On the RA2A2, the TinyCrypt API has been expanded to support GCM mode operation. Key lengths of 128, 192 and 256 are supported. GCM mode operation is not supported on other MCUs in hardware or software in the TinyCrypt API.</p>
<h2><a class="anchor" id="rm-tinycrypt-memory-usage"></a>
Memory Usage</h2>
<p>TinyCrypt does not use dynamic allocation so there is no heap requirement.</p>
<h2>Limitations</h2>
<h3>Usage with RA4 and RA6 devices</h3>
<p>TinyCrypt (S/W Only) can be used on RA4 and RA6 devices. However, since ECC signature generation (ECDSA) and key derivation (ECDH) requires a random number source, that operation is currently not supported on these devices when using TinyCrypt (S/W Only). In order to support those operations the function <a class="el" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga09389b89e02115f59a1da9cccc0b09f8" title="Implements the Cryptographically Secure Pseudo-Random Number Generator function required byt TinyCryp...">default_CSPRNG()</a> must be implemented in the user code.</p>
<h3>TinyCrypt</h3>
<ul>
<li>No padding is supported; the user is expected to provide adequately padded data depending on the algorithm used.</li>
<li>AES Key generation is not supported.</li>
<li>Key encoding/decoding is not supported.</li>
</ul>
<h2>Using TinyCrypt with TrustZone</h2>
<p>Unlike FSP drivers, TinyCrypt cannot be configured as Non-secure callable in the RA Configurator for a secure project. The reason for this is that in order to achieve the security objective of controlling access to protected keys, both the crypto code as well as the keys must be placed in the secure region. Since the tinyCrypt API requires access to the keys directly during initialization and later via a key handle, allowing non-secure code to use the API by making it Non-secure callable will require the keys to be stored in non-secure memory.</p>
<p>This limitation is identical to that for PSA Crypto. Refer to the documentation of that module on how to create a crypto Non-Secure Callable layer to be used in such situations.</p>
<h1><a class="anchor" id="rm-tinycrypt-examples"></a>
Examples</h1>
<h2>AES-CBC Example</h2>
<p>This is an example on using TinyCrypt to encrypt and decrypt data using an AES-128 key in CBC mode.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define TC_INPUT_PLAINTEXT_SIZE      64U</span></div><div class="line"><span class="preprocessor">#define TF_AES_IV_SIZE               TC_AES_BLOCK_SIZE</span></div><div class="line"><span class="preprocessor">#define TC_OUTPUT_CIPHERTEXT_SIZE    (TC_INPUT_PLAINTEXT_SIZE + TF_AES_IV_SIZE)</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * NIST test vectors from SP 800-38a:</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Block #1</span></div><div class="line"><span class="comment"> * Plaintext 6bc1bee22e409f96e93d7e117393172a</span></div><div class="line"><span class="comment"> * Input Block 6bc0bce12a459991e134741a7f9e1925</span></div><div class="line"><span class="comment"> * Output Block 7649abac8119b246cee98e9b12e9197d</span></div><div class="line"><span class="comment"> * Ciphertext 7649abac8119b246cee98e9b12e9197d</span></div><div class="line"><span class="comment"> * Block #2</span></div><div class="line"><span class="comment"> * Plaintext ae2d8a571e03ac9c9eb76fac45af8e51</span></div><div class="line"><span class="comment"> * Input Block d86421fb9f1a1eda505ee1375746972c</span></div><div class="line"><span class="comment"> * Output Block 5086cb9b507219ee95db113a917678b2</span></div><div class="line"><span class="comment"> * Ciphertext 5086cb9b507219ee95db113a917678b2</span></div><div class="line"><span class="comment"> * Block #3</span></div><div class="line"><span class="comment"> * Plaintext 30c81c46a35ce411e5fbc1191a0a52ef</span></div><div class="line"><span class="comment"> * Input Block 604ed7ddf32efdff7020d0238b7c2a5d</span></div><div class="line"><span class="comment"> * Output Block 73bed6b8e3c1743b7116e69e22229516</span></div><div class="line"><span class="comment"> * Ciphertext 73bed6b8e3c1743b7116e69e22229516</span></div><div class="line"><span class="comment"> * Block #4</span></div><div class="line"><span class="comment"> * Plaintext f69f2445df4f9b17ad2b417be66c3710</span></div><div class="line"><span class="comment"> * Input Block 8521f2fd3c8eef2cdc3da7e5c44ea206</span></div><div class="line"><span class="comment"> * Output Block 3ff1caa1681fac09120eca307586e1a7</span></div><div class="line"><span class="comment"> * Ciphertext 3ff1caa1681fac09120eca307586e1a7</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">const</span> uint8_t cbc_key[TC_AES_KEY_SIZE] =</div><div class="line">{</div><div class="line">    0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c</div><div class="line">};</div><div class="line"></div><div class="line">uint8_t cbc_iv[TC_AES_BLOCK_SIZE] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t cbc_plaintext[TC_INPUT_PLAINTEXT_SIZE] =</div><div class="line">{</div><div class="line">    0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,</div><div class="line">    0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c, 0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,</div><div class="line">    0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11, 0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,</div><div class="line">    0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17, 0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10</div><div class="line">};</div><div class="line"></div><div class="line">uint8_t cbc_expected_ciphertext[TC_OUTPUT_CIPHERTEXT_SIZE] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x76, 0x49, 0xab, 0xac, 0x81, 0x19, 0xb2, 0x46, 0xce, 0xe9, 0x8e, 0x9b, 0x12, 0xe9, 0x19, 0x7d, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x50, 0x86, 0xcb, 0x9b, 0x50, 0x72, 0x19, 0xee, 0x95, 0xdb, 0x11, 0x3a, 0x91, 0x76, 0x78, 0xb2, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x73, 0xbe, 0xd6, 0xb8, 0xe3, 0xc1, 0x74, 0x3b, 0x71, 0x16, 0xe6, 0x9e, 0x22, 0x22, 0x95, 0x16, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x3f, 0xf1, 0xca, 0xa1, 0x68, 0x1f, 0xac, 0x09, 0x12, 0x0e, 0xca, 0x30, 0x75, 0x86, 0xe1, 0xa7  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> tinycrypt_aes128cbc_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">struct </span>tc_aes_key_sched_struct aes_keyschedule;</div><div class="line"></div><div class="line">    uint8_t cbc_encrypted[TC_OUTPUT_CIPHERTEXT_SIZE] = {0U};</div><div class="line">    uint8_t cbc_decrypted[TC_OUTPUT_CIPHERTEXT_SIZE] = {0U};</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_aes128_set_encrypt_key(&amp;aes_keyschedule, cbc_key))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_cbc_mode_encrypt(cbc_encrypted, <span class="keyword">sizeof</span>(cbc_plaintext) + TC_AES_BLOCK_SIZE, cbc_plaintext,</div><div class="line">                                 <span class="keyword">sizeof</span>(cbc_plaintext), cbc_iv, &amp;aes_keyschedule))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;cbc_encrypted[0], &amp;cbc_expected_ciphertext[0], <span class="keyword">sizeof</span>(cbc_encrypted)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_cbc_mode_decrypt(cbc_decrypted, <span class="keyword">sizeof</span>(cbc_encrypted), &amp;cbc_encrypted[TC_AES_BLOCK_SIZE],</div><div class="line">                                 <span class="keyword">sizeof</span>(cbc_encrypted), cbc_encrypted, &amp;aes_keyschedule))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;cbc_plaintext[0], &amp;cbc_decrypted[0], <span class="keyword">sizeof</span>(cbc_plaintext)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Operation successful. */</span></div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            ;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>AES-CTR Example</h2>
<p>This is an example on using TinyCrypt to encrypt and decrypt data using an AES-128 key in CTR mode.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define TC_CTR_INPUT_PLAINTEXT_SIZE      64U</span></div><div class="line"><span class="preprocessor">#define TF_AES_IV_SIZE                   TC_AES_BLOCK_SIZE</span></div><div class="line"><span class="preprocessor">#define TC_CTR_OUTPUT_CIPHERTEXT_SIZE    (TC_CTR_INPUT_PLAINTEXT_SIZE + TF_AES_IV_SIZE)</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * NIST SP 800-38a CTR Test for encryption and decryption.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t ctr_key[TC_AES_KEY_SIZE] =</div><div class="line">{</div><div class="line">    0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c</div><div class="line">};</div><div class="line"></div><div class="line">uint8_t ctr_iv[TC_AES_KEY_SIZE] =</div><div class="line">{</div><div class="line">    0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t ctr_plaintext[64] =</div><div class="line">{</div><div class="line">    0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,</div><div class="line">    0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c, 0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,</div><div class="line">    0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11, 0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,</div><div class="line">    0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17, 0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t ctr_expected_ciphertext[TC_CTR_OUTPUT_CIPHERTEXT_SIZE] =</div><div class="line">{</div><div class="line">    0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff,</div><div class="line">    0x87, 0x4d, 0x61, 0x91, 0xb6, 0x20, 0xe3, 0x26, 0x1b, 0xef, 0x68, 0x64, 0x99, 0x0d, 0xb6, 0xce,</div><div class="line">    0x98, 0x06, 0xf6, 0x6b, 0x79, 0x70, 0xfd, 0xff, 0x86, 0x17, 0x18, 0x7b, 0xb9, 0xff, 0xfd, 0xff,</div><div class="line">    0x5a, 0xe4, 0xdf, 0x3e, 0xdb, 0xd5, 0xd3, 0x5e, 0x5b, 0x4f, 0x09, 0x02, 0x0d, 0xb0, 0x3e, 0xab,</div><div class="line">    0x1e, 0x03, 0x1d, 0xda, 0x2f, 0xbe, 0x03, 0xd1, 0x79, 0x21, 0x70, 0xa0, 0xf3, 0x00, 0x9c, 0xee</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> tinycrypt_aes128ctr_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">struct </span>tc_aes_key_sched_struct aes_keyschedule;</div><div class="line"></div><div class="line">    uint8_t ctr_encrypted[TC_CTR_OUTPUT_CIPHERTEXT_SIZE] = {0U};</div><div class="line">    uint8_t ctr_decrypted[TC_CTR_OUTPUT_CIPHERTEXT_SIZE] = {0U};</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcpy(ctr_encrypted, ctr_iv, <span class="keyword">sizeof</span>(ctr_iv)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_aes128_set_encrypt_key(&amp;aes_keyschedule, ctr_key))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_ctr_mode(&amp;ctr_encrypted[TC_AES_BLOCK_SIZE], <span class="keyword">sizeof</span>(ctr_plaintext), ctr_plaintext, <span class="keyword">sizeof</span>(ctr_plaintext),</div><div class="line">                         ctr_iv, &amp;aes_keyschedule))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;ctr_encrypted[0], &amp;ctr_expected_ciphertext[0], <span class="keyword">sizeof</span>(ctr_encrypted)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcpy(ctr_iv, ctr_encrypted, <span class="keyword">sizeof</span>(ctr_iv)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_ctr_mode(ctr_decrypted, <span class="keyword">sizeof</span>(ctr_decrypted), &amp;ctr_encrypted[TC_AES_BLOCK_SIZE], <span class="keyword">sizeof</span>(ctr_decrypted),</div><div class="line">                         ctr_iv, &amp;aes_keyschedule))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;ctr_plaintext[0], &amp;ctr_decrypted[0], <span class="keyword">sizeof</span>(ctr_plaintext)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Operation successful. */</span></div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            ;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>CTR-PRNG Example</h2>
<p>This is an example on using the CTR_PRNG module in TinyCrypt to obtain random data.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define TC_ENTROPY_SIZE           64U</span></div><div class="line"><span class="preprocessor">#define TC_CTRPRNG_OUTPUT_SIZE    32U</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> tinycrypt_ctr_prng_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    TCCtrPrng_t cprng_ctx;</div><div class="line">    uint8_t     seed[TC_ENTROPY_SIZE];</div><div class="line">    uint8_t     ctr_prng_output_1[TC_CTRPRNG_OUTPUT_SIZE] = {0};</div><div class="line">    uint8_t     ctr_prng_output_2[TC_CTRPRNG_OUTPUT_SIZE] = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the crypto engine. */</span></div><div class="line">    <span class="keywordflow">if</span> (0 != <a class="code" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga61682df07075c19ebb327063d5ba6e8b">RM_TINCYRYPT_PORT_Init</a>())</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Read random data from the TRNG to use as seed for the CTR_PRNG. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FSP_SUCCESS != <a class="code" href="group___r_m___t_i_n_y_c_r_y_p_t___p_o_r_t.html#ga7c2f26b3efb9ca315f40754bfb926eb0">RM_TINCYRYPT_PORT_TRNG_Read</a>(seed, <span class="keyword">sizeof</span>(seed)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Initialize and seed the CTR_PRNG with the random data from the TRNG. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_ctr_prng_init(&amp;cprng_ctx, seed, <span class="keyword">sizeof</span>(seed), 0, 0))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Read random data from the CTR_PRNG. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_ctr_prng_generate(&amp;cprng_ctx, 0, 0, ctr_prng_output_1, <span class="keyword">sizeof</span>(ctr_prng_output_1)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Check that the generated value is not 0. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == memcmp(&amp;ctr_prng_output_1[0], &amp;ctr_prng_output_2[0], <span class="keyword">sizeof</span>(ctr_prng_output_1)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Read random data again from the TRNG. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS !=</div><div class="line">             tc_ctr_prng_generate(&amp;cprng_ctx, 0, 0, ctr_prng_output_2, <span class="keyword">sizeof</span>(ctr_prng_output_2)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Check that the generated value is different than the previous call. */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == memcmp(&amp;ctr_prng_output_1[0], &amp;ctr_prng_output_2[0], <span class="keyword">sizeof</span>(ctr_prng_output_1)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Operation successful. */</span></div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            ;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>AES-CMAC Example</h2>
<p>This is an example on using AES Circuit (Hardware support) to encrypt data using an AES-128 key in CMAC mode. This is also an example on use tc_cmac_setup and tc_cmac_setup_extended.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define MLEN4      64</span></div><div class="line"><span class="preprocessor">#define BUF_LEN    16</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t cmac_key_128[TC_AES_KEY_SIZE] =</div><div class="line">{</div><div class="line">    0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6,</div><div class="line">    0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c</div><div class="line">};</div><div class="line"><span class="keyword">const</span> uint8_t msg[MLEN4] =</div><div class="line">{</div><div class="line">    0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96,</div><div class="line">    0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a,</div><div class="line">    0xae, 0x2d, 0x8a, 0x57, 0x1e, 0x03, 0xac, 0x9c,</div><div class="line">    0x9e, 0xb7, 0x6f, 0xac, 0x45, 0xaf, 0x8e, 0x51,</div><div class="line">    0x30, 0xc8, 0x1c, 0x46, 0xa3, 0x5c, 0xe4, 0x11,</div><div class="line">    0xe5, 0xfb, 0xc1, 0x19, 0x1a, 0x0a, 0x52, 0xef,</div><div class="line">    0xf6, 0x9f, 0x24, 0x45, 0xdf, 0x4f, 0x9b, 0x17,</div><div class="line">    0xad, 0x2b, 0x41, 0x7b, 0xe6, 0x6c, 0x37, 0x10,</div><div class="line">};</div><div class="line"><span class="keyword">const</span> uint8_t tag[BUF_LEN] =</div><div class="line">{</div><div class="line">    0x51, 0xf0, 0xbe, 0xbf, 0x7e, 0x3b, 0x9d, 0x92,</div><div class="line">    0xfc, 0x49, 0x74, 0x17, 0x79, 0x36, 0x3c, 0xfe,</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> tinycrypt_aes128cmac_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">struct </span>tc_cmac_struct          state;</div><div class="line">    <span class="keyword">struct </span>tc_aes_key_sched_struct sched;</div><div class="line">    uint8_t Tag[BUF_LEN];</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_setup(&amp;state, cmac_key_128, &amp;sched))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_init(&amp;state))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_update(&amp;state, msg, <span class="keyword">sizeof</span>(msg)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_final(Tag, &amp;state))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != memcmp(Tag, tag, BUF_LEN))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Operation successful. */</span></div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            ;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/* Below is a example of using tc_cmac_setup_extended instead of tc_cmac_setup*/</span></div><div class="line"><span class="keywordtype">void</span> tinycrypt_aes128cmac_example_setup_extended (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">struct </span>tc_cmac_struct          state;</div><div class="line">    <span class="keyword">struct </span>tc_aes_key_sched_struct sched;</div><div class="line">    uint8_t Tag[BUF_LEN];</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_setup_extended(&amp;state, cmac_key_128, &amp;sched, <span class="keyword">sizeof</span>(cmac_key_128)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_init(&amp;state))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_update(&amp;state, msg, <span class="keyword">sizeof</span>(msg)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != tc_cmac_final(Tag, &amp;state))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TC_CRYPTO_SUCCESS != memcmp(Tag, tag, BUF_LEN))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* Operation successful. */</span></div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            ;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2 class="groupheader">Function Documentation</h2>
<a id="ga61682df07075c19ebb327063d5ba6e8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61682df07075c19ebb327063d5ba6e8b">&#9670;&nbsp;</a></span>RM_TINCYRYPT_PORT_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_TINCYRYPT_PORT_Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the SCE. </p>

</div>
</div>
<a id="ga7c2f26b3efb9ca315f40754bfb926eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c2f26b3efb9ca315f40754bfb926eb0">&#9670;&nbsp;</a></span>RM_TINCYRYPT_PORT_TRNG_Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_TINCYRYPT_PORT_TRNG_Read </td>
          <td>(</td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_rngbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_req_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads requested length of random data from the TRNG. Generate <code>num_req_bytes</code> of random bytes and store them in <code>p_rngbuf</code> buffer. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Random number generation successful </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>NULL input parameter(s). </td></tr>
    <tr><td class="paramname">FSP_ERR_CRYPTO_UNKNOWN</td><td>An unknown error occurred. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See <a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html">Common Error Codes</a> or functions called by this function for other possible return codes. </dd></dl>

</div>
</div>
<a id="ga09389b89e02115f59a1da9cccc0b09f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09389b89e02115f59a1da9cccc0b09f8">&#9670;&nbsp;</a></span>default_CSPRNG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int default_CSPRNG </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implements the Cryptographically Secure Pseudo-Random Number Generator function required byt TinyCrypt. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TC_CRYPTO_SUCCESS</td><td>Random number generation successful </td></tr>
    <tr><td class="paramname">TC_CRYPTO_FAIL</td><td>Random number generation failed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See <a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html">Common Error Codes</a> or functions called by this function for other possible return codes. This function calls:<ul>
<li>RM_TINCYRYPT_PORT_TRNG_Read </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v5.8.0 User's Manual Copyright  (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
