<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Mbed Crypto H/W Acceleration (rm_psa_crypto)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
     });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v6.2.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">

    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text">
      </span>
      <span class="right">
          &nbsp;
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_m___p_s_a___c_r_y_p_t_o.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body.
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len));
            }
          }
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element.
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Mbed Crypto H/W Acceleration (rm_psa_crypto)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> &raquo; <a class="el" href="group___r_e_n_e_s_a_s___s_e_c_u_r_i_t_y___m_o_d_u_l_e_s.html">Security</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf0f37c11be234650bec95ce37e9a4a6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a> (<a class="el" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> *ctx)</td></tr>
<tr class="separator:gaf0f37c11be234650bec95ce37e9a4a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga264d5dd442e32a262d331f8889a0997c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a> (<a class="el" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> *ctx)</td></tr>
<tr class="separator:ga264d5dd442e32a262d331f8889a0997c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3783884f7c0fbb23f8195d005f7e4494"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga3783884f7c0fbb23f8195d005f7e4494">RM_PSA_CRYPTO_TRNG_Read</a> (uint8_t *const p_rngbuf, uint32_t num_req_bytes, uint32_t *p_num_gen_bytes)</td></tr>
<tr class="memdesc:ga3783884f7c0fbb23f8195d005f7e4494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads requested length of random data from the TRNG. Generate <code>nbytes</code> of random bytes and store them in <code>p_rngbuf</code> buffer.  <a href="#ga3783884f7c0fbb23f8195d005f7e4494">More...</a><br /></td></tr>
<tr class="separator:ga3783884f7c0fbb23f8195d005f7e4494"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Hardware acceleration for the mbedCrypto implementation of the Arm PSA Crypto API. </p>
<h1><a class="anchor" id="rm-psa-crypto-overview"></a>
Overview</h1>
<dl class="section note"><dt>Note</dt><dd><b>The PSA Crypto module does not provide any interfaces to the user. This release uses the mbedTLS version 3.6.2 which conforms to the PSA Crypto API 1.0 specification. Consult the Arm documentation at <a href="https://armmbed.github.io/mbed-crypto/psa/#application-programming-interface">https://armmbed.github.io/mbed-crypto/psa/#application-programming-interface</a> for further information.</b> FSP 3.0 onward adopts a change by Arm where mbedCrypto has been integrated back to MbedTLS and the term mbedCrypto has been deprecated. The mbedCrypto term in FSP now refers to the crypto portion of the MbedTLS module.</dd></dl>
<h2>HW Overview</h2>
<table class="doxtable">
<tr>
<th>Crypto Peripheral version </th><th>Devices  </th></tr>
<tr>
<td>RSIP-E51A </td><td>RA8M1, RA8D1, RA8T1 </td></tr>
<tr>
<td>RSIP-E50D </td><td>RA8P1 </td></tr>
<tr>
<td>RSIP-E31A </td><td>RA4C1 </td></tr>
<tr>
<td>RSIP-E11A </td><td>RA4L1 </td></tr>
<tr>
<td>SCE9 </td><td>RA6M4, RA4M3, RA4M2, RA6M5 </td></tr>
<tr>
<td>SCE7 </td><td>RA6M3, RA6M2, RA6M1, RA6T1 </td></tr>
<tr>
<td>SCE5 </td><td>RA4W1, RA4M1 </td></tr>
<tr>
<td>SCE5B </td><td>RA6T2 </td></tr>
<tr>
<td>AES Engine </td><td>RA2A1, RA2E1, RA2E2, RA2L1 </td></tr>
<tr>
<td>AES Engine 2 </td><td>RA2A2 </td></tr>
<tr>
<td>TRNG </td><td>RA0E1, RA0E2, RA2L2, RA4E1, RA4E2, RA4T1, RA6E1, RA6E2, RA6T3, RA8E1, RA8E2 </td></tr>
</table>
<h2><a class="anchor" id="rm-psa-crypto-features"></a>
Features</h2>
<table class="doxtable">
<tr>
<th></th><th></th><th>AES Engine </th><th>AES Engine 2 </th><th>SCE5 </th><th>SCE5_B </th><th>SCE7 </th><th>SCE9 </th><th>RSIP-E11A </th><th>RSIP-E31A </th><th>RSIP-E51A </th><th>RSIP-E50D  </th></tr>
<tr>
<td>TRNG </td><td></td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>Hash </td><td>SHA224, SHA256 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>SHA384, SHA512 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>SHA3-(224/256/384/512) </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td></tr>
<tr>
<td>MAC </td><td>HMAC-SHA224, HMAC-SHA256 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>HMAC-SHA384, HMAC-SHA512 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES128-CMAC </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES192-CMAC </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES256-CMAC </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>AES </td><td>AES128-ECB, CBC, CTR </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES128-XTS </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES128-GCM, GMAC, CCM </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES192-ECB, CBC, CTR </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES192-GCM, GMAC, CCM </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES256-ECB, CBC, CTR </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES256-XTS </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>AES256-GCM, GMAC, CCM </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Key generation - plaintext </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Key generation - wrapped </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>ChaCha </td><td>ChaCha20 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td></tr>
<tr>
<td></td><td>ChaCha20-Poly1305 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td></tr>
<tr>
<td>ECC </td><td>secp256r1 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>secp384r1 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>secp521r1 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Brainpool256r1 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Brainpool384r1 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Key generation - plaintext </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td></tr>
<tr>
<td></td><td>Key generation - wrapped </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td>RSA </td><td>RSA-1024 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>RSA-2048 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>RSA-3072 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>(1) </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>RSA-4096 </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>(1) </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>Yes </td></tr>
<tr>
<td></td><td>Key generation - plaintext </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td></tr>
<tr>
<td></td><td>Key generation - wrapped </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>&ndash; </td><td>Yes </td><td>(2) </td><td>&ndash; </td><td>&ndash; </td><td>(3) </td><td>(3) </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li>Signature verification only</li>
<li>RSA-1024 and RSA-2048 only</li>
<li>RSA-2048, RSA-3072, RSA-4096 only</li>
</ol>
</dd></dl>
<p><a class="anchor" id="um_sha256_hash_calculation"></a><a class="anchor" id="um_sha256_hash_multipart_calculation"></a><a class="anchor" id="um_sha256_hash_multipart_long_message_calculation"></a><a class="anchor" id="um_sha256_hash_read"></a><a class="anchor" id="um_sha256_hash_clone"></a><a class="anchor" id="um_sha224_hash_read"></a><a class="anchor" id="um_sha512_hash_multipart_calculation"></a><a class="anchor" id="um_sha512_hash_multipart_long_message_calculation"></a><a class="anchor" id="um_sha384_hash_multipart_calculation"></a><a class="anchor" id="um_sha384_hash_multipart_long_message_calculation"></a><a class="anchor" id="um_sha3_224_hash_multipart_calculation"></a><a class="anchor" id="um_sha3_256_hash_multipart_calculation"></a><a class="anchor" id="um_sha3_256_hash_multipart_long_message_calculation"></a><a class="anchor" id="um_sha3_384_hash_multipart_calculation"></a><a class="anchor" id="um_sha3_512_hash_multipart_calculation"></a><a class="anchor" id="um_sha3_512_hash_multipart_long_message_calculation"></a><a class="anchor" id="um_sha512_hmac"></a><a class="anchor" id="um_sha384_hmac"></a><a class="anchor" id="um_sha256_hmac"></a><a class="anchor" id="um_sha224_hmac"></a><a class="anchor" id="um_AES_hardware_acceleration"></a><a class="anchor" id="um_AES256_key_generation_plaintext"></a><a class="anchor" id="um_AES128_key_generation_plaintext"></a><a class="anchor" id="um_AES192_key_generation_plaintext"></a><a class="anchor" id="um_AES_cmac"></a><a class="anchor" id="um_AES256_key_generation_wrapped"></a><a class="anchor" id="um_AES128_key_generation_wrapped"></a><a class="anchor" id="um_AES192_key_generation_wrapped"></a><a class="anchor" id="um_AES_pkcs7_padding"></a><a class="anchor" id="um_AES128_encryption_decryption"></a><a class="anchor" id="um_AES192_encryption_decryption"></a><a class="anchor" id="um_AES256_encryption_decryption"></a><a class="anchor" id="um_AES_cbc"></a><a class="anchor" id="um_AES_ccm"></a><a class="anchor" id="um_AES_gcm"></a><a class="anchor" id="um_AES_multipart_ctr"></a><a class="anchor" id="um_AES_xts"></a><a class="anchor" id="um_AES256_key_generation_plaintext_export"></a><a class="anchor" id="um_AES128_key_generation_plaintext_export"></a><a class="anchor" id="um_AES192_key_generation_plaintext_export"></a><a class="anchor" id="um_AES256_key_generation_wrapped_export"></a><a class="anchor" id="um_AES128_key_generation_wrapped_export"></a><a class="anchor" id="um_AES192_key_generation_wrapped_export"></a><a class="anchor" id="um_ECC_key_generation_256K1"></a><a class="anchor" id="um_ECC_key_generation_256R1"></a><a class="anchor" id="um_ECC_key_generation_BP256R1"></a><a class="anchor" id="um_ECC_key_generation_384R1"></a><a class="anchor" id="um_ECC_key_generation_BP384R1"></a><a class="anchor" id="um_ECC_key_generation_256K1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_256R1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_BP256R1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_384R1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_BP384R1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_521R1Wrapped"></a><a class="anchor" id="um_ECC_key_generation_25519Wrapped"></a><a class="anchor" id="um_ECC_key_export_256R1Wrapped"></a><a class="anchor" id="um_ECC_key_export_256K1Wrapped"></a><a class="anchor" id="um_ECC_key_export_BrainPool256R1Wrapped"></a><a class="anchor" id="um_ECC_key_export_384R1Wrapped"></a><a class="anchor" id="um_ECC_key_export_BrainPool384R1Wrapped"></a><a class="anchor" id="um_ECC_key_export_521R1Wrapped"></a><a class="anchor" id="um_ECC_key_export_256R1"></a><a class="anchor" id="um_ECC_key_export_256K1"></a><a class="anchor" id="um_ECC_key_export_BrainPool256R1"></a><a class="anchor" id="um_ECC_key_export_384R1"></a><a class="anchor" id="um_ECC_key_export_BrainPool384R1"></a><a class="anchor" id="um_ECC_sign_verify_smaller_hash"></a><a class="anchor" id="um_ECC_key_import_256R1"></a><a class="anchor" id="um_ECC_key_import_256K1"></a><a class="anchor" id="um_ECC_key_import_BrainPool256R1"></a><a class="anchor" id="um_ECC_key_import_384R1"></a><a class="anchor" id="um_ECC_key_import_521R1"></a><a class="anchor" id="um_ECC_key_import_BrainPool384R1"></a><a class="anchor" id="um_ECC_ECDH_support"></a><a class="anchor" id="um_RSA_key_generation"></a><a class="anchor" id="um_RSA_1024_key_generation"></a><a class="anchor" id="um_RSA_1024_key_generationWrapped"></a><a class="anchor" id="um_RSA_key_generationWrapped"></a><a class="anchor" id="um_RSA_3072_key_generationWrapped"></a><a class="anchor" id="um_RSA_4096_key_generationWrapped"></a><a class="anchor" id="um_RSA_1024_key_import_verify"></a><a class="anchor" id="um_RSA_3072_key_import_verify"></a><a class="anchor" id="um_RSA_4096_key_import_verify"></a><a class="anchor" id="um_RSA_PKCS1V15_encrypt_decrypt"></a><a class="anchor" id="um_RSA_OAEP_encrypt_decrypt"></a><a class="anchor" id="um_RSA_key_export_import"></a><a class="anchor" id="um_RSA_key_import"></a><a class="anchor" id="um_RSA_key_import_e3"></a><a class="anchor" id="um_RSA_key_export_import_wrapped"></a><a class="anchor" id="um_psa_random_number_generation"></a><a class="anchor" id="um_RNG_hardware_acceleration"></a><a class="anchor" id="um_AES_persistent_key"></a><a class="anchor" id="um_RSA_persistent_key"></a><a class="anchor" id="um_CHACHA20_hw_procedure_1_block_uint8_t"></a><a class="anchor" id="um_CHACHA20_hw_procedure_multiple_block"></a><a class="anchor" id="um_CHACHA20_hw_procedure_decrypt_multiple_block"></a><a class="anchor" id="um_CHACHA20_hw_procedure_decrypt_multiple_block_with_final"></a><a class="anchor" id="um_CHACHA20_crypt"></a><a class="anchor" id="um_CHACHA20_crypt_stream"></a><a class="anchor" id="um_CHACHA20_crypt_stream_unaligned_data"></a><a class="anchor" id="um_CHACHA20_cipher"></a><a class="anchor" id="um_POLY1305_mac"></a><a class="anchor" id="um_CHACHAPOLY"></a><a class="anchor" id="um_CHACHAPOLY_raw_encrypt_decrypt"></a><a class="anchor" id="um_CHACHAPOLY_raw_encrypt_decrypt_with_update_final"></a><a class="anchor" id="um_CHACHAPOLY_state_check"></a><a class="anchor" id="um_CHACHAPOLY_cipher"></a><a class="anchor" id="um_CHACHAPOLY_stream_encrypt_decrypt"></a><a class="anchor" id="um_PQC_mlkem_encap"></a><a class="anchor" id="um_PQC_mlkem_decap"></a><a class="anchor" id="um_PQC_mlkem_keygen"></a><a class="anchor" id="um_PQC_mlkem_512_gen"></a><a class="anchor" id="um_PQC_mlkem_768_gen"></a><a class="anchor" id="um_PQC_mlkem_512_import"></a><a class="anchor" id="um_PQC_mlkem_768_import"></a><a class="anchor" id="um_PQC_mldsa_sign"></a><a class="anchor" id="um_PQC_mldsa_verify"></a><a class="anchor" id="um_PQC_mldsa_keygen"></a><a class="anchor" id="um_PQC_mldsa_44_sign"></a><a class="anchor" id="um_PQC_mldsa_65_sign"></a><a class="anchor" id="um_PQC_mldsa_44_import"></a><a class="anchor" id="um_PQC_mldsa_65_import"></a> </p>
<h1><a class="anchor" id="rm-psa-crypto-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for mbedCrypto</h2>
The following build time configurations are defined in arm/mbedtls/config.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Key Format  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">AES</td><td>MCU Specific Options</td><td></td><td>Select AES key formats used </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">ECC</td><td>MCU Specific Options</td><td></td><td>Select ECC key formats used </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">RSA</td><td>MCU Specific Options</td><td></td><td>Select RSA key formats used </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Hash  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">SHA256/224</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_SHA256_ALT and MBEDTLS_SHA256_PROCESS_ALT. </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">SHA512/384</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_SHA512_ALT and MBEDTLS_SHA512_PROCESS_ALT. </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">SHA3_224/256/384/512</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_SHA3_ALT and MBEDTLS_SHA3_PROCESS_ALT. </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Cipher  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">AES</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_AES_ALT, MBEDTLS_AES_SETKEY_ENC_ALT, MBEDTLS_AES_SETKEY_DEC_ALT, MBEDTLS_AES_ENCRYPT_ALT and MBEDTLS_AES_DECRYPT_ALT </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Public Key Cryptography (PKC)  </td></tr>
<tr class="tree_lvl_3">
<td class="tree_lvl_3" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Public Key Cryptography (PKC) &gt; RSA 3072  </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Key Generation</td><td>MCU Specific Options</td><td></td><td>Enables RSA 3072 Key Generation. </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Signing</td><td>MCU Specific Options</td><td></td><td>Enables RSA 3072 Key Signing. </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Verification</td><td>MCU Specific Options</td><td></td><td>Enables RSA 3072 Verify. </td></tr>
<tr class="tree_lvl_3">
<td class="tree_lvl_3" colspan="4"><span class="chevron-collapsed"></span> Hardware Acceleration &gt; Public Key Cryptography (PKC) &gt; RSA 4096  </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Key Generation</td><td>MCU Specific Options</td><td></td><td>Enables RSA 4096 Key Generation. </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Signing</td><td>MCU Specific Options</td><td></td><td>Enables RSA 4096 Key Signing. </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">Verification</td><td>MCU Specific Options</td><td></td><td>Enables RSA 4096 Verify. </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">ECC</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_ECP_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">ECDSA </td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_ECDSA_SIGN_ALT and MBEDTLS_ECDSA_VERIFY_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">ECDH </td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_ECDH_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">RSA 1024</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_RSA_1024_ALT. RSA 1024 Key Generation, Signing and Verification are also enabled.  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">RSA 2048</td><td>MCU Specific Options</td><td></td><td>Defines MBEDTLS_RSA_ALT. RSA 2048 Key Generation, Signing and Verification are also enabled.  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">TRNG</td><td>Enabled</td><td>Enabled </td><td>Defines MBEDTLS_ENTROPY_HARDWARE_ALT. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">Crypto Engine Initialization</td><td>Enabled</td><td>Enabled </td><td>MBEDTLS_PLATFORM_SETUP_TEARDOWN_ALT </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Platform  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Platform &gt; Alternate  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_SETBUF_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_SETBUF_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_EXIT_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_EXIT_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_TIME_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_TIME_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_FPRINTF_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_FPRINTF_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_PRINTF_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_PRINTF_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_SNPRINTF_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_SNPRINTF_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_VSNPRINTF_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_VSNPRINTF_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_NV_SEED_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_NV_SEED_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_MS_TIME_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_MS_TIME_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_ZEROIZE_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_ZEROIZE_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PLATFORM_GMTIME_R_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_GMTIME_R_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HAVE_ASM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HAVE_ASM </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_NO_UDBL_DIVISION</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_NO_UDBL_DIVISION </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_NO_64BIT_MULTIPLICATION</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_NO_64BIT_MULTIPLICATION </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HAVE_SSE2</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HAVE_SSE2 </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HAVE_TIME</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HAVE_TIME </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HAVE_TIME_DATE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HAVE_TIME_DATE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_MEMORY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PLATFORM_MEMORY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_NO_STD_FUNCTIONS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_NO_STD_FUNCTIONS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_TIMING_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_TIMING_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_NO_PLATFORM_ENTROPY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_NO_PLATFORM_ENTROPY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ENTROPY_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PLATFORM_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_CALLOC</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_CALLOC </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_CALLOC value</td><td>Manual Entry</td><td>calloc </td><td>MBEDTLS_PLATFORM_STD_CALLOC value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_FREE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_FREE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_FREE value</td><td>Manual Entry</td><td>free </td><td>MBEDTLS_PLATFORM_STD_FREE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_SETBUF</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_SETBUF </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_SETBUF value</td><td>Manual Entry</td><td>setbuf </td><td>MBEDTLS_PLATFORM_STD_SETBUF value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_EXIT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT value</td><td>Manual Entry</td><td>exit </td><td>MBEDTLS_PLATFORM_STD_EXIT value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_TIME</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_TIME </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_TIME value</td><td>Manual Entry</td><td>time </td><td>MBEDTLS_PLATFORM_STD_TIME value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_FPRINTF</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_FPRINTF </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_FPRINTF value</td><td>Manual Entry</td><td>fprintf </td><td>MBEDTLS_PLATFORM_STD_FPRINTF value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_PRINTF</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_PRINTF </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_PRINTF value</td><td>Manual Entry</td><td>printf </td><td>MBEDTLS_PLATFORM_STD_PRINTF value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_SNPRINTF</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_SNPRINTF </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_SNPRINTF value</td><td>Manual Entry</td><td>snprintf </td><td>MBEDTLS_PLATFORM_STD_SNPRINTF value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT_SUCCESS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_EXIT_SUCCESS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT_SUCCESS value</td><td>Manual Entry</td><td>0 </td><td>MBEDTLS_PLATFORM_STD_EXIT_SUCCESS value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT_FAILURE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_EXIT_FAILURE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_EXIT_FAILURE value</td><td>Manual Entry</td><td>1 </td><td>MBEDTLS_PLATFORM_STD_EXIT_FAILURE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_READ</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_NV_SEED_READ </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_READ value</td><td>Manual Entry</td><td>mbedtls_platform_std_nv_seed_read </td><td>MBEDTLS_PLATFORM_STD_NV_SEED_READ value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_WRITE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_NV_SEED_WRITE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_WRITE value</td><td>Manual Entry</td><td>mbedtls_platform_std_nv_seed_write </td><td>MBEDTLS_PLATFORM_STD_NV_SEED_WRITE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_FILE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_STD_NV_SEED_FILE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_STD_NV_SEED_FILE value</td><td>Manual Entry</td><td></td><td>MBEDTLS_PLATFORM_STD_NV_SEED_FILE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_CALLOC_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_CALLOC_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_CALLOC_MACRO value</td><td>Manual Entry</td><td>calloc </td><td>MBEDTLS_PLATFORM_CALLOC_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_FREE_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_FREE_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_FREE_MACRO value</td><td>Manual Entry</td><td>free </td><td>MBEDTLS_PLATFORM_FREE_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_EXIT_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_EXIT_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_EXIT_MACRO value</td><td>Manual Entry</td><td>exit </td><td>MBEDTLS_PLATFORM_EXIT_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_SETBUF_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PLATFORM_SETBUF_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_SETBUF_MACRO value</td><td>Manual Entry</td><td>dummy_setbuf </td><td>MBEDTLS_PLATFORM_SETBUF_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_TIME_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_TIME_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_TIME_MACRO value</td><td>Manual Entry</td><td>time </td><td>MBEDTLS_PLATFORM_TIME_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_TIME_TYPE_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_TIME_TYPE_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_TIME_TYPE_MACRO value</td><td>Manual Entry</td><td>time_t </td><td>MBEDTLS_PLATFORM_TIME_TYPE_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_MS_TIME_TYPE_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_MS_TIME_TYPE_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_MS_TIME_TYPE_MACRO value</td><td>Manual Entry</td><td>int64_t </td><td>MBEDTLS_PLATFORM_MS_TIME_TYPE_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PRINTF_MS_TIME</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PRINTF_MS_TIME </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PRINTF_MS_TIME value</td><td>Manual Entry</td><td>PRId64 </td><td>MBEDTLS_PRINTF_MS_TIME value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_FPRINTF_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_FPRINTF_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_FPRINTF_MACRO value</td><td>Manual Entry</td><td>fprintf </td><td>MBEDTLS_PLATFORM_FPRINTF_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_PRINTF_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_PRINTF_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_PRINTF_MACRO value</td><td>Manual Entry</td><td>printf </td><td>MBEDTLS_PLATFORM_PRINTF_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_SNPRINTF_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_SNPRINTF_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_SNPRINTF_MACRO value</td><td>Manual Entry</td><td>snprintf </td><td>MBEDTLS_PLATFORM_SNPRINTF_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_VSNPRINTF_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_VSNPRINTF_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_VSNPRINTF_MACRO value</td><td>Manual Entry</td><td>vsnprintf </td><td>MBEDTLS_PLATFORM_VSNPRINTF_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_NV_SEED_READ_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_NV_SEED_READ_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_NV_SEED_READ_MACRO value</td><td>Manual Entry</td><td>mbedtls_platform_std_nv_seed_read </td><td>MBEDTLS_PLATFORM_NV_SEED_READ_MACRO value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_NV_SEED_WRITE_MACRO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PLATFORM_NV_SEED_WRITE_MACRO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PLATFORM_NV_SEED_WRITE_MACRO value</td><td>Manual Entry</td><td>mbedtls_platform_std_nv_seed_write </td><td>MBEDTLS_PLATFORM_NV_SEED_WRITE_MACRO value </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> General  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_DRIVERS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_DRIVERS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_DEPRECATED_WARNING</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DEPRECATED_WARNING </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_DEPRECATED_REMOVED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_DEPRECATED_REMOVED </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CHECK_RETURN_WARNING</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CHECK_RETURN_WARNING </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ERROR_STRERROR_DUMMY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ERROR_STRERROR_DUMMY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MEMORY_DEBUG</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MEMORY_DEBUG </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MEMORY_BACKTRACE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MEMORY_BACKTRACE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_CLIENT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_CLIENT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_SPM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_SPM </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_KEY_STORE_DYNAMIC</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_KEY_STORE_DYNAMIC </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_ASSUME_EXCLUSIVE_BUFFERS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_ASSUME_EXCLUSIVE_BUFFERS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SELF_TEST</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SELF_TEST </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_THREADING_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_THREADING_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_THREADING_PTHREAD</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_THREADING_PTHREAD </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_USE_PSA_CRYPTO</td><td>Undefine</td><td>Undefine </td><td>MBEDTLS_USE_PSA_CRYPTO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_VERSION_FEATURES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_VERSION_FEATURES </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ERROR_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ERROR_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MEMORY_BUFFER_ALLOC_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MEMORY_BUFFER_ALLOC_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PSA_CRYPTO_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_SE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_SE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_THREADING_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_THREADING_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_TIMING_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_TIMING_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_VERSION_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_VERSION_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MEMORY_ALIGN_MULTIPLE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MEMORY_ALIGN_MULTIPLE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MEMORY_ALIGN_MULTIPLE value</td><td>Manual Entry</td><td>4 </td><td>MBEDTLS_MEMORY_ALIGN_MULTIPLE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CHECK_RETURN</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CHECK_RETURN </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_IGNORE_RETURN</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_IGNORE_RETURN </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_CONFIG</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_CONFIG </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Cipher  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Cipher &gt; Alternate  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ARIA_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ARIA_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_CAMELLIA_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CAMELLIA_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_CCM_ALT</td><td>MCU Specific Options</td><td></td><td>MBEDTLS_CCM_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_CHACHA20_ALT</td><td>MCU Specific Options</td><td></td><td>MBEDTLS_CHACHA20_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_CHACHAPOLY_ALT</td><td>MCU Specific Options</td><td></td><td>MBEDTLS_CHACHAPOLY_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_CMAC_ALT</td><td>MCU Specific Options</td><td></td><td>MBEDTLS_CMAC_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_DES_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DES_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_GCM_ALT</td><td>MCU Specific Options</td><td></td><td>MBEDTLS_GCM_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_NIST_KW_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_NIST_KW_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_DES_SETKEY_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DES_SETKEY_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_DES_CRYPT_ECB_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DES_CRYPT_ECB_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_DES3_CRYPT_ECB_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DES3_CRYPT_ECB_ALT </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Cipher &gt; AES  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_AES_ROM_TABLES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_AES_ROM_TABLES </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_AES_FEWER_TABLES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_AES_FEWER_TABLES </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_AES_ONLY_128_BIT_KEY_LENGTH</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_AES_ONLY_128_BIT_KEY_LENGTH </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CAMELLIA_SMALL_MEMORY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CAMELLIA_SMALL_MEMORY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_MODE_CBC</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_MODE_CBC </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_MODE_CFB</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_MODE_CFB </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_MODE_CTR</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_MODE_CTR </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_MODE_OFB</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CIPHER_MODE_OFB </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_MODE_XTS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CIPHER_MODE_XTS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_NULL_CIPHER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CIPHER_NULL_CIPHER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_PADDING_PKCS7</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_PADDING_PKCS7 </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_PADDING_ONE_AND_ZEROS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_PADDING_ONE_AND_ZEROS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_PADDING_ZEROS_AND_LEN</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_PADDING_ZEROS_AND_LEN </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_PADDING_ZEROS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_PADDING_ZEROS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_AES_C</td><td>Define</td><td>Define </td><td>MBEDTLS_AES_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_BLOCK_CIPHER_NO_DECRYPT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_BLOCK_CIPHER_NO_DECRYPT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CAMELLIA_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CAMELLIA_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ARIA_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ARIA_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CCM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CCM_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CHACHA20_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CHACHA20_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CHACHAPOLY_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CHACHAPOLY_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CIPHER_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CIPHER_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_DES_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DES_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_GCM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_GCM_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_GCM_LARGE_TABLE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_GCM_LARGE_TABLE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_NIST_KW_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_NIST_KW_C </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC)  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; DHM  </td></tr>
<tr class="tree_lvl_3">
<td class="tree_lvl_3" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; DHM &gt; Alternate  </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_DHM_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DHM_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_DHM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_DHM_C </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; ECC  </td></tr>
<tr class="tree_lvl_3">
<td class="tree_lvl_3" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; ECC &gt; Alternate  </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECJPAKE_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECJPAKE_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECDSA_GENKEY_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDSA_GENKEY_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_INTERNAL_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_INTERNAL_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_RANDOMIZE_JAC_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_RANDOMIZE_JAC_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_ADD_MIXED_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_ADD_MIXED_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DOUBLE_JAC_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DOUBLE_JAC_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_NORMALIZE_JAC_MANY_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_NORMALIZE_JAC_MANY_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_NORMALIZE_JAC_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_NORMALIZE_JAC_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DOUBLE_ADD_MXZ_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DOUBLE_ADD_MXZ_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_RANDOMIZE_MXZ_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_RANDOMIZE_MXZ_ALT </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_NORMALIZE_MXZ_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_NORMALIZE_MXZ_ALT </td></tr>
<tr class="tree_lvl_3">
<td class="tree_lvl_3" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; ECC &gt; Curves  </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP192R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP192R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP224R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP224R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP256R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ECP_DP_SECP256R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP384R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP384R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP521R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP521R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP192K1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP192K1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP224K1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP224K1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_SECP256K1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_SECP256K1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_BP256R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_BP256R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_BP384R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_BP384R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_BP512R1_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_BP512R1_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_CURVE25519_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_CURVE25519_ENABLED </td></tr>
<tr class="tree_lvl_3_item">
<td class="tree_lvl_3_cell">MBEDTLS_ECP_DP_CURVE448_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_DP_CURVE448_ENABLED </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDH_GEN_PUBLIC_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDH_GEN_PUBLIC_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDH_COMPUTE_SHARED_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDH_COMPUTE_SHARED_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_NO_FALLBACK</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_NO_FALLBACK </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_NIST_OPTIM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_NIST_OPTIM </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_RESTARTABLE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_RESTARTABLE </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDSA_DETERMINISTIC</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDSA_DETERMINISTIC </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PK_PARSE_EC_COMPRESSED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PK_PARSE_EC_COMPRESSED </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PK_PARSE_EC_EXTENDED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PK_PARSE_EC_EXTENDED </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDH_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDH_C </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDSA_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ECDSA_C </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ECP_C </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECJPAKE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECJPAKE_C </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_WINDOW_SIZE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_WINDOW_SIZE </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_WINDOW_SIZE value</td><td>Manual Entry</td><td>6 </td><td>MBEDTLS_ECP_WINDOW_SIZE value </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_FIXED_POINT_OPTIM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECP_FIXED_POINT_OPTIM </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECP_FIXED_POINT_OPTIM value</td><td>Manual Entry</td><td>1 </td><td>MBEDTLS_ECP_FIXED_POINT_OPTIM value </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_ECDH_VARIANT_EVEREST_ENABLED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ECDH_VARIANT_EVEREST_ENABLED </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Public Key Cryptography (PKC) &gt; RSA  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_PK_RSA_ALT_SUPPORT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PK_RSA_ALT_SUPPORT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RSA_NO_CRT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_RSA_NO_CRT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RSA_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_RSA_C </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RSA_GEN_KEY_MIN_BITS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_RSA_GEN_KEY_MIN_BITS </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RSA_GEN_KEY_MIN_BITS value</td><td>Manual Entry</td><td>1024 </td><td>MBEDTLS_RSA_GEN_KEY_MIN_BITS value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_GENPRIME</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_GENPRIME </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PKCS1_V15</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PKCS1_V15 </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PKCS1_V21</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PKCS1_V21 </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ASN1_PARSE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ASN1_PARSE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ASN1_WRITE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_ASN1_WRITE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_BASE64_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_BASE64_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_BIGNUM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_BIGNUM_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_LMS_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_LMS_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_LMS_PRIVATE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_LMS_PRIVATE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_OID_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_OID_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PEM_PARSE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PEM_PARSE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PEM_WRITE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PEM_WRITE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PK_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PK_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PK_PARSE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PK_PARSE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PK_WRITE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PK_WRITE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PKCS5_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PKCS5_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PKCS7_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PKCS7_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PKCS12_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PKCS12_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MPI_WINDOW_SIZE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MPI_WINDOW_SIZE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MPI_WINDOW_SIZE value</td><td>Manual Entry</td><td>6 </td><td>MBEDTLS_MPI_WINDOW_SIZE value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MPI_MAX_SIZE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MPI_MAX_SIZE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MPI_MAX_SIZE value</td><td>Manual Entry</td><td>1024 </td><td>MBEDTLS_MPI_MAX_SIZE value </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Hash  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Hash &gt; Alternate  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_MD5_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MD5_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RIPEMD160_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_RIPEMD160_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_SHA1_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA1_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_MD5_PROCESS_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MD5_PROCESS_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_RIPEMD160_PROCESS_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_RIPEMD160_PROCESS_ALT </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_SHA1_PROCESS_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA1_PROCESS_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA256_SMALLER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA256_SMALLER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA512_SMALLER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA512_SMALLER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MD_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_MD_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MD5_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_MD5_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_RIPEMD160_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_RIPEMD160_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA1_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_SHA1_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA3_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA3_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA224_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_SHA224_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA256_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_SHA256_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA384_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA384_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_SHA512_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_SHA512_C </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Message Authentication Code (MAC)  </td></tr>
<tr class="tree_lvl_2">
<td class="tree_lvl_2" colspan="4"><span class="chevron-collapsed"></span> Message Authentication Code (MAC) &gt; Alternate  </td></tr>
<tr class="tree_lvl_2_item">
<td class="tree_lvl_2_cell">MBEDTLS_POLY1305_ALT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_POLY1305_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CMAC_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CMAC_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HKDF_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_HKDF_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HMAC_DRBG_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_POLY1305_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_POLY1305_C </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Storage  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_FS_IO</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_FS_IO </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_STORAGE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_STORAGE_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_ITS_FILE_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_ITS_FILE_C </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> RNG  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_NO_DEFAULT_ENTROPY_SOURCES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_NO_DEFAULT_ENTROPY_SOURCES </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_FORCE_SHA256</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ENTROPY_FORCE_SHA256 </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_NV_SEED</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ENTROPY_NV_SEED </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_EXTERNAL_RNG </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_INJECT_ENTROPY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_INJECT_ENTROPY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_CTR_DRBG_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_C_ALT</td><td>Define</td><td>Define </td><td>MBEDTLS_CTR_DRBG_C_ALT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_ENTROPY_LEN</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>RNG|MBEDTLS_CTR_DRBG_ENTROPY_LEN </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_ENTROPY_LEN value</td><td>Manual Entry</td><td>48 </td><td>RNG value|MBEDTLS_CTR_DRBG_ENTROPY_LEN </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_RESEED_INTERVAL</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>RNG|MBEDTLS_CTR_DRBG_RESEED_INTERVAL </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_RESEED_INTERVAL value</td><td>Manual Entry</td><td>10000 </td><td>RNG value|MBEDTLS_CTR_DRBG_RESEED_INTERVAL </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_INPUT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CTR_DRBG_MAX_INPUT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_INPUT value</td><td>Manual Entry</td><td>256 </td><td>MBEDTLS_CTR_DRBG_MAX_INPUT value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_REQUEST</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CTR_DRBG_MAX_REQUEST </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_REQUEST value</td><td>Manual Entry</td><td>1024 </td><td>MBEDTLS_CTR_DRBG_MAX_REQUEST value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_SEED_INPUT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CTR_DRBG_MAX_SEED_INPUT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_MAX_SEED_INPUT value</td><td>Manual Entry</td><td>384 </td><td>MBEDTLS_CTR_DRBG_MAX_SEED_INPUT value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_CTR_DRBG_USE_128_BIT_KEY</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_CTR_DRBG_USE_128_BIT_KEY </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_RESEED_INTERVAL</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HMAC_DRBG_RESEED_INTERVAL </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_RESEED_INTERVAL value</td><td>Manual Entry</td><td>10000 </td><td>MBEDTLS_HMAC_DRBG_RESEED_INTERVAL value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_INPUT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HMAC_DRBG_MAX_INPUT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_INPUT value</td><td>Manual Entry</td><td>256 </td><td>MBEDTLS_HMAC_DRBG_MAX_INPUT value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_REQUEST</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HMAC_DRBG_MAX_REQUEST </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_REQUEST value</td><td>Manual Entry</td><td>1024 </td><td>MBEDTLS_HMAC_DRBG_MAX_REQUEST value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_SEED_INPUT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_HMAC_DRBG_MAX_SEED_INPUT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_HMAC_DRBG_MAX_SEED_INPUT value</td><td>Manual Entry</td><td>384 </td><td>MBEDTLS_HMAC_DRBG_MAX_SEED_INPUT value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MAX_SOURCES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ENTROPY_MAX_SOURCES </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MAX_SOURCES value</td><td>Manual Entry</td><td>20 </td><td>MBEDTLS_ENTROPY_MAX_SOURCES value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MAX_GATHER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ENTROPY_MAX_GATHER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MAX_GATHER value</td><td>Manual Entry</td><td>128 </td><td>MBEDTLS_ENTROPY_MAX_GATHER value </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MIN_HARDWARE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ENTROPY_MIN_HARDWARE </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ENTROPY_MIN_HARDWARE value</td><td>Manual Entry</td><td>32 </td><td>MBEDTLS_ENTROPY_MIN_HARDWARE value </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Key Configuration  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_KEY_ID_ENCODES_OWNER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_KEY_ID_ENCODES_OWNER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_CRYPTO_BUILTIN_KEYS</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_CRYPTO_BUILTIN_KEYS </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">PSA_CRYPTO_DRIVER_TFM_BUILTIN_KEY_LOADER</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>PSA_CRYPTO_DRIVER_TFM_BUILTIN_KEY_LOADER </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_KEY_SLOT_COUNT</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_PSA_KEY_SLOT_COUNT </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_KEY_SLOT_COUNT value</td><td>Manual Entry</td><td>32 </td><td>MBEDTLS_PSA_KEY_SLOT_COUNT value </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Post Quantum Cryptography (PQC)  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_MLKEM_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_MLKEM_C </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_ML_DSA_C</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Undefine </td><td>MBEDTLS_ML_DSA_C </td></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> HMAC  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">MBEDTLS_PSA_HMAC_DRBG_MD_TYPE</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Define</li>
<li>
Undefine</li>
</ul>
</td><td>Define </td><td>MBEDTLS_PSA_HMAC_DRBG_MD_TYPE </td></tr>
</table>
</p>
<h2><a class="anchor" id="rm-psa-crypto-sha256-configuration"></a>
SHA256 Configuration</h2>
<p>To enable hardware acceleration for the SHA256/224 calculation, the macro MBEDTLS_SHA256_ALT and MBEDTLS_SHA256_PROCESS_ALT must be defined in the configuration file. By default SHA256 is enabled. SHA256 can be disabled, but SHA512 then needs to be enabled (software version) because the PSA implementation uses it for the entropy accumulator. This can be done using the RA Configuration editor.</p>
<h2><a class="anchor" id="rm-psa-crypto-aes-configuration"></a>
AES Configuration</h2>
<p>To enable hardware acceleration for the AES128/256 operation, the macro MBEDTLS_AES_SETKEY_ENC_ALT, MBEDTLS_AES_SETKEY_DEC_ALT, MBEDTLS_AES_ENCRYPT_ALT and MBEDTLS_AES_DECRYPT_ALT must be defined in the configuration file. By default AES is enabled. AES cannot be disabled because the PSA implementation requires it for the CTR_DRBG random number generator. This can be done using the RA Configuration editor.</p>
<dl class="section note"><dt>Note</dt><dd><b>Only AES XTS 128 is currently supported. RA2 devices support acceleration for ECB part alone, while other devices support full AES XTS hardware acceleration.</b></dd></dl>
<h2><a class="anchor" id="rm-psa-crypto-ecc-configuration"></a>
ECC Configuration</h2>
<p>To enable hardware acceleration for the ECC Key Generation operation, the macro MBEDTLS_ECP_ALT must be defined in the configuration file. For ECDSA, the macros MBEDTLS_ECDSA_SIGN_ALT and MBEDTLS_ECDSA_VERIFY_ALT must be defined. By default ECC, ECDSA and ECDHE are enabled. To disable ECC, undefine MBEDTLS_ECP_C, MBEDTLS_ECDSA_C and MBEDTLS_ECDH_C. This can be done using the RA Configuration editor.</p>
<h2><a class="anchor" id="rm-psa-crypto-rsa-configuration"></a>
RSA Configuration</h2>
<p>To enable hardware acceleration for the RSA2048 operation, the macro MBEDTLS_RSA_ALT must be defined in the configuration file. By default RSA is enabled. To disable RSA, undefine MBEDTLS_RSA_C, MBEDTLS_PK_C, MBEDTLS_PK_PARSE_C, MBEDTLS_PK_WRITE_C. This can be done using the RA Configuration editor.</p>
<h2><a class="anchor" id="rm-psa-crypto-pqc-configuration"></a>
Post Quantum Cryptography (PQC) Configuration</h2>
<h3><a class="anchor" id="rm-psa-crypto-pqc-mlkem-configuration"></a>
ML-KEM Configuration</h3>
<p>To enable software only PQC ML-KEM key generation, encapsulation, and decapsulation operations, the macro MBEDTLS_MLKEM_C must be defined in the configuration file. By default, PQC ML-KEM is disabled as the PQC stack is optional. This can be done using the RA Configuration editor.</p>
<h3><a class="anchor" id="rm-psa-crypto-pqc-mldsa-configuration"></a>
ML-DSA Configuration</h3>
<p>To enable software only PQC ML-DSA key generation, signing, and verification operations, the macro MBEDTLS_ML_DSA_C must be defined in the configuration file. By default, PQC ML-DSA is disabled as the PQC stack is optional. This can be done using the RA Configuration editor.</p>
<h2><a class="anchor" id="rm-psa-crypto-wrapped-key-configuration"></a>
Wrapped Key Usage</h2>
<p>To use the Secure Crypto Engine to generate and use wrapped keys, use PSA_KEY_TYPE_AES_WRAPPED or PSA_KEY_TYPE_ECC_KEY_PAIR_WRAPPED(curve) or PSA_KEY_TYPE_RSA_KEY_PAIR when setting the key type attribute. Setting the key's type attribute using this value will cause the SCE to use wrapped key mode for all operations related to that key. The user can use the export functionality to save the wrapped keys to user ROM and import it later for usage. This mode requires that Wrapped Key functionality for the algorithm is enabled in the project configuration. </p><dl class="section note"><dt>Note</dt><dd><b>On the SCE9 devices, only the RSA public key can be exported. A file system must be used to store the internally generated private key.</b></dd></dl>
<h2><a class="anchor" id="rm-psa-crypto-persistent-key-storage"></a>
Persistent Key Storage</h2>
<p>Persistent key storage can be enabled by defining MBEDTLS_FS_IO, MBEDTLS_PSA_CRYPTO_STORAGE_C, and MBEDTLS_PSA_ITS_FILE_C. The key lifetime must also be specified as PSA_KEY_LIFETIME_PERSISTENT. A lower level storage module must be added in the RA Configuration editor and initialized in the code before generating persistent keys. Persistent storage supports the use of plaintext and vendor keys. Refer to the lower level storage module documentation for information on how it should be initialized. To generate a persistent key the key must be assigned a unique id prior to calling generate using the psa_set_key_id api.<a class="anchor" id="um_PSA_ITS_persistent_storage"></a> </p><div class="fragment"><div class="line">    <span class="keywordflow">if</span> (PSA_KEY_LIFETIME_IS_PERSISTENT(lifetime))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Set the id to a positive integer. */</span></div><div class="line">        psa_set_key_id(&amp;attributes, (psa_key_id_t) 5);</div><div class="line">    }</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="rm-psa-crypto-platform-configuration"></a>
Platform Configuration</h2>
<p>To run the mbedCrypto implementation of the PSA Crypto API on the MCU, the macro MBEDTLS_PLATFORM_SETUP_TEARDOWN_ALT must be defined in the configuration file. This enables code that will initialize the SCE. Parameter checking (General|MBEDTLS_CHECK_PARAMS) is enabled by default. To reduce code size, disable parameter checking.</p>
<h2><a class="anchor" id="rm-psa-crypto-entropy-configuration"></a>
Random Number Configuration</h2>
<p>To run the mbedCrypto implementation of the PSA Crypto API on the MCU, the macro MBEDTLS_ENTROPY_HARDWARE_ALT must be defined in the configuration file. This enables using the TRNG as an entropy source. None of the other cryptographic operations (even in software only mode) will work without this feature.</p>
<h1><a class="anchor" id="rm-psa-crypto-usage-notes"></a>
Usage Notes</h1>
<h2><a class="anchor" id="rm-psa-crypto-hardware-init"></a>
Hardware Initialization</h2>
<p><a class="el" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup()</a> must be invoked before using the PSA Crypto API to ensure that the SCE peripheral is initialized.</p>
<h2><a class="anchor" id="rm-psa-crypto-memory-usage"></a>
Memory Usage</h2>
<p>In general, depending on the mbedCrypto features being used a heap size of 0x1000 to 0x5000 bytes is required. The total allocated heap should be the <b>sum</b> of the heap requirements of the individual algorithms:</p>
<table class="doxtable">
<tr>
<th>Algorithm </th><th>Required Heap (bytes)  </th></tr>
<tr>
<td>SHA256/224 </td><td>None </td></tr>
<tr>
<td>AES </td><td>0x200 </td></tr>
<tr>
<td>Hardware ECC </td><td>0x400 </td></tr>
<tr>
<td>Software ECC </td><td>0x1800 </td></tr>
<tr>
<td>RSA </td><td>0x1500 </td></tr>
</table>
<p>A minimum stack of 0x1000 is required where the module is used. This is either the main stack in a bare metal application or the task stack of the task used for crypto operations.</p>
<h2>Limitations</h2>
<ul>
<li>Only little endian mode is supported.</li>
</ul>
<h3>Stdio Buffering</h3>
<p>The MBEDTLS_PLATFORM_SETBUF_MACRO was introduced in mbedTLS 3.2.1 to prevent stdio read/write functions from buffering stream data to reduce the likelihood of key leakage by setting the buffer argument in setbuf() to NULL. FSP uses a dummy_setbuf() function in rm_psa_crypto.c to prevent build errors; since FSP uses LittleFS by default (where the usage of a buffer is mandatory) this function does not perform any action. Setting the cache size in LittleFS to the minimum supported by the Data Flash (4) can minimize but not remove the likelihood of key data leakage. The dummy function can be replaced with a user-defined function by defining a different value for MBEDTLS_PLATFORM_SETBUF_MACRO_value in the FSP configurator.</p>
<h3>Post Quantum Cryptography (PQC)</h3>
<ul>
<li>The PSA API Specificiation v1.3 supports ML-KEM and ML-DSA however MbedTLS currently does not provide an implementation. The implementation in the FSP release is thus likely to change and may cause backward compatibility issues when MbedTLS officially supports it.</li>
<li>ASN.1 encoding not implemented. Keys are currently implemented in raw bytes.</li>
</ul>
<h4>ML-DSA</h4>
<ul>
<li>The FIPS204 Standard allows the user to provide an optional context string for ML-DSA signature generation and verification. The current implementation does not allow the user to provide such a string. Internally this field is set to a value of 0 with a length of 0.</li>
<li>The data format for import and export of the key pair is a byte array of the 32 byte seed value.</li>
<li>Only ML-DSA-44 and ML-DSA-65 supported. ML-DSA-87 not supported.</li>
<li>Only <code>PSA_ALG_HASH_ML_DSA</code> supported. <code>PSA_ALG_ML_DSA</code> requires PSA to offer a SHAKE-256 implementation.</li>
<li>The current implementation of ML-DSA is too big for devices with less than 64KB of RAM.</li>
<li>There is a known runtime issue when IAR toolchain is used for ML-DSA.</li>
</ul>
<h4>ML-KEM</h4>
<ul>
<li>Only ML-KEM-512 and ML-KEM-768 supported. ML-KEM-1024 not supported.</li>
<li>Key derivation not supported.</li>
<li>The data format for import and export of the key pair is the concatenation of the two 32 byte seed values: <code>d || z</code></li>
</ul>
<h2>SCE9 Usage</h2>
<p>The SCE9 is used in Compatibility Mode for mbedCrypto acceleration. The crypto capabilities in this mode on the SCE9 are different which results in the below usage limitations with mbedCrypto:</p>
<ul>
<li>The module includes <b>both</b> wrapped and plaintext keys code irrespective of whether the application requires it.</li>
<li>Plaintext key generation is not supported for RSA and ECC; only wrapped keys can be generated.</li>
<li>If ECDH is used, only wrapped key will be generated on SCE9 and will not return an error even if the user context is somehow set for plain key. This may be relevant only if the psa_key_agreement() function with plaintext key on SCE9 is attempted.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><b>For a detailed description of the different SCE9 operating modes, refer to Application Note R11AN0498.</b></dd></dl>
<h2>Using PSA Crypto with TrustZone</h2>
<p>Unlike FSP drivers, PSA Crypto cannot be configured as Non-secure callable in the RA Configurator for a secure project. The reason for this is that in order to achieve the security objective of controlling access to protected keys, both the PSA Crypto code as well as the keys must be placed in the secure region. Since the PSA Crypto API requires access to the keys directly during initialization and later via a key handle, allowing non-secure code to use the API by making it Non-secure callable will require the keys to be stored in non-secure memory.</p>
<p>This section will provide a short explanation of how to add PSA Crypto to a secure project and have it usable by the non-secure project without exposing the keys. In this example the secure project will contain an RSA private key and the non-secure project is expected to be able to perform sign and verify operations using that key.</p>
<div class="image">
<object type="image/svg+xml" data="mbedcrypto-nsc.svg">mbedcrypto-nsc.svg</object>
<div class="caption">
PSA Crypto Non-secure callable example</div></div>
<ul>
<li>Secure project<ul>
<li>During secure project boot-up, psa_crypto_init() is called.</li>
<li>The RSA private key is programmed into secure flash either at the factory or by calling psa_generate_key() in persistent mode. Note that the data-flash area used by the LittleFS will have to be in the secure region if the key is generated as a persistent.</li>
<li>psa_import_key()/psa_open_key() are called with the resultant handle held in secure RAM.</li>
<li>The Non-secure callable section contains the following <b>user-defined</b> functions</li>
<li>verify_with_my_rsa_key(input_signature, input_hash, verification_result)</li>
<li>The implementation of this function in secure region will call psa_verify_hash() and return the result via verification_result.</li>
<li>sign_with_my_rsa_key(input_hash, output_signature)</li>
<li>The implementation of this function in secure region will call psa_sign_hash() and return the signature via output_signature.</li>
</ul>
</li>
<li><p class="startli">Non-secure project</p><ul>
<li>Calls verify_with_my_rsa_key() to verify a signature. The implementation will use the public key that is present in the secure project.</li>
<li>Calls sign_with_my_rsa_key() to generate a signature. The implementation will use the private key that is present on the secure project.</li>
</ul>
<p class="startli">For more details on how to add user-code to the Non-secure callable region refer to the "Security Design with Arm TrustZone - IP Protection (R11AN0467EU0100)" Application Note.</p>
</li>
</ul>
<h1><a class="anchor" id="rm-psa-crypto-examples"></a>
Examples</h1>
<h2>Hash Example</h2>
<p>This is an example on calculating the SHA256 hash using the PSA Crypto API.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> uint8_t NIST_SHA256ShortMsgLen200[] =</div><div class="line">{</div><div class="line">    0x2e, 0x7e, 0xa8, 0x4d, 0xa4, 0xbc, 0x4d, 0x7c, 0xfb, 0x46, 0x3e, 0x3f, 0x2c, 0x86, 0x47, 0x05,</div><div class="line">    0x7a, 0xff, 0xf3, 0xfb, 0xec, 0xec, 0xa1, 0xd2, 00</div><div class="line">};</div><div class="line"><span class="keyword">const</span> uint8_t NIST_SHA256ShortMsgLen200_expected[] =</div><div class="line">{</div><div class="line">    0x76, 0xe3, 0xac, 0xbc, 0x71, 0x88, 0x36, 0xf2, 0xdf, 0x8a, 0xd2, 0xd0, 0xd2, 0xd7, 0x6f, 0x0c,</div><div class="line">    0xfa, 0x5f, 0xea, 0x09, 0x86, 0xbe, 0x91, 0x8f, 0x10, 0xbc, 0xee, 0x73, 0x0d, 0xf4, 0x41, 0xb9</div><div class="line">};</div><div class="line"><span class="keywordtype">void</span> psa_crypto_sha256_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    psa_algorithm_t      alg               = PSA_ALG_SHA_256;</div><div class="line">    psa_hash_operation_t operation         = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               expected_hash_len = PSA_HASH_LENGTH(alg);</div><div class="line">    uint8_t              actual_hash[PSA_HASH_MAX_SIZE];</div><div class="line">    <span class="keywordtype">size_t</span>               actual_hash_len;</div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE and the TRNG */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_hash_setup(&amp;operation, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Hash setup failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_hash_update(&amp;operation, NIST_SHA256ShortMsgLen200, <span class="keyword">sizeof</span>(NIST_SHA256ShortMsgLen200)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Hash calculation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_hash_finish(&amp;operation, &amp;actual_hash[0], <span class="keyword">sizeof</span>(actual_hash), &amp;actual_hash_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Reading calculated hash failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;actual_hash[0], &amp;NIST_SHA256ShortMsgLen200_expected[0], actual_hash_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Hash compare of calculated value with expected value failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(&amp;expected_hash_len, &amp;actual_hash_len, <span class="keyword">sizeof</span>(expected_hash_len)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Hash size compare of calculated value with expected value failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* SHA256 calculation succeeded */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* De-initialize the platform. This is currently a placeholder function which does not do anything. */</span></div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line"></div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>AES Example</h2>
<p>This is an example on using the PSA Crypto API to generate an AES256 key, encrypting and decrypting multi-block data and using PKCS7 padding.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> psa_status_t cipher_operation (psa_cipher_operation_t * operation,</div><div class="line">                                      <span class="keyword">const</span> uint8_t          * input,</div><div class="line">                                      <span class="keywordtype">size_t</span>                   input_size,</div><div class="line">                                      <span class="keywordtype">size_t</span>                   part_size,</div><div class="line">                                      uint8_t                * output,</div><div class="line">                                      <span class="keywordtype">size_t</span>                   output_size,</div><div class="line">                                      <span class="keywordtype">size_t</span>                 * output_len)</div><div class="line">{</div><div class="line">    psa_status_t status;</div><div class="line">    <span class="keywordtype">size_t</span>       bytes_to_write = 0;</div><div class="line">    <span class="keywordtype">size_t</span>       bytes_written  = 0;</div><div class="line">    <span class="keywordtype">size_t</span>       len            = 0;</div><div class="line"></div><div class="line">    *output_len = 0;</div><div class="line">    <span class="keywordflow">while</span> (bytes_written != input_size)</div><div class="line">    {</div><div class="line">        bytes_to_write = (input_size - bytes_written &gt; part_size ?</div><div class="line">                          part_size :</div><div class="line">                          input_size - bytes_written);</div><div class="line"></div><div class="line">        status = psa_cipher_update(operation,</div><div class="line">                                   input + bytes_written,</div><div class="line">                                   bytes_to_write,</div><div class="line">                                   output + *output_len,</div><div class="line">                                   output_size - *output_len,</div><div class="line">                                   &amp;len);</div><div class="line">        <span class="keywordflow">if</span> (PSA_SUCCESS != status)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">return</span> status;</div><div class="line">        }</div><div class="line"></div><div class="line">        bytes_written += bytes_to_write;</div><div class="line">        *output_len   += len;</div><div class="line">    }</div><div class="line"></div><div class="line">    status = psa_cipher_finish(operation, output + *output_len, output_size - *output_len, &amp;len);</div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != status)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span> status;</div><div class="line">    }</div><div class="line"></div><div class="line">    *output_len += len;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> status;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_crypto_aes256cbcmultipart_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">enum</span></div><div class="line">    {</div><div class="line">        block_size = PSA_BLOCK_CIPHER_BLOCK_LENGTH(PSA_KEY_TYPE_AES), </div><div class="line">        key_bits   = 256,</div><div class="line">        input_size = 100,</div><div class="line">        part_size  = 10,</div><div class="line">    };</div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx         = {0};</div><div class="line">    <span class="keyword">const</span> psa_algorithm_t    alg         = PSA_ALG_CBC_PKCS7;</div><div class="line">    psa_cipher_operation_t   operation_1 = PSA_CIPHER_OPERATION_INIT;</div><div class="line">    psa_cipher_operation_t   operation_2 = PSA_CIPHER_OPERATION_INIT;</div><div class="line">    <span class="keywordtype">size_t</span> iv_len = 0;</div><div class="line"></div><div class="line">    psa_key_handle_t     key_handle        = 0;</div><div class="line">    <span class="keywordtype">size_t</span>               encrypted_length  = 0;</div><div class="line">    <span class="keywordtype">size_t</span>               decrypted_length  = 0;</div><div class="line">    uint8_t              iv[block_size]    = {0};</div><div class="line">    uint8_t              input[input_size] = {0};</div><div class="line">    uint8_t              encrypted_data[input_size + block_size] = {0};</div><div class="line">    uint8_t              decrypted_data[input_size + block_size] = {0};</div><div class="line">    psa_key_attributes_t attributes = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_lifetime_t   lifetime;</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCRYPT | PSA_KEY_USAGE_DECRYPT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, alg);</div><div class="line"></div><div class="line">    <span class="comment">/* To use wrapped keys instead of plaintext use PSA_KEY_TYPE_AES_WRAPPED. */</span></div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_AES);</div><div class="line">    psa_set_key_bits(&amp;attributes, key_bits);</div><div class="line"></div><div class="line">    lifetime = PSA_KEY_LIFETIME_VOLATILE;</div><div class="line"></div><div class="line">    <span class="comment">/* To use persistent keys:</span></div><div class="line"><span class="comment">     *......Use a lifetime value of PSA_KEY_LIFETIME_PERSISTENT</span></div><div class="line"><span class="comment">     * -    The file system must be initialized prior to calling the generate/import key functions.</span></div><div class="line"><span class="comment">     * -    Refer to the littlefs example to see how to format and mount the filesystem. */</span></div><div class="line">    psa_set_key_lifetime(&amp;attributes, lifetime);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_KEY_LIFETIME_IS_PERSISTENT(lifetime))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Set the id to a positive integer. */</span></div><div class="line">        psa_set_key_id(&amp;attributes, (psa_key_id_t) 5);</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_random(input, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Random number generation for input data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating AES 256 key and allocating to key slot failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_encrypt_setup(&amp;operation_1, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the encryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_generate_iv(&amp;operation_1, iv, <span class="keyword">sizeof</span>(iv), &amp;iv_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating the random IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_1, input, input_size, part_size, encrypted_data, <span class="keyword">sizeof</span>(encrypted_data),</div><div class="line">                              &amp;encrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Encryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_1))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the encryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_decrypt_setup(&amp;operation_2, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the decryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_set_iv(&amp;operation_2, iv, <span class="keyword">sizeof</span>(iv)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Setting the IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_2, encrypted_data, encrypted_length, part_size, decrypted_data,</div><div class="line">                              <span class="keyword">sizeof</span>(decrypted_data), &amp;decrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Decryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the decryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(input, decrypted_data, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Comparing the input data with decrypted data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Destroying the key handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All the operations succeeded */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Close the SCE */</span></div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_crypto_aes128xtsmultipart_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">enum</span></div><div class="line">    {</div><div class="line">        block_size = PSA_BLOCK_CIPHER_BLOCK_LENGTH(PSA_KEY_TYPE_AES), </div><div class="line">        key_bits   = 256,</div><div class="line">        input_size = 32,</div><div class="line">        part_size  = 16,</div><div class="line">    };</div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx         = {0};</div><div class="line">    <span class="keyword">const</span> psa_algorithm_t    alg         = PSA_ALG_XTS;</div><div class="line">    psa_cipher_operation_t   operation_1 = PSA_CIPHER_OPERATION_INIT;</div><div class="line">    psa_cipher_operation_t   operation_2 = PSA_CIPHER_OPERATION_INIT;</div><div class="line">    <span class="keywordtype">size_t</span> iv_len = 0;</div><div class="line"></div><div class="line">    psa_key_handle_t     key_handle                 = 0;</div><div class="line">    <span class="keywordtype">size_t</span>               encrypted_length           = 0;</div><div class="line">    <span class="keywordtype">size_t</span>               decrypted_length           = 0;</div><div class="line">    uint8_t              iv[block_size]             = {0};</div><div class="line">    uint8_t              input[input_size]          = {0};</div><div class="line">    uint8_t              encrypted_data[input_size] = {0};</div><div class="line">    uint8_t              decrypted_data[input_size] = {0};</div><div class="line">    psa_key_attributes_t attributes                 = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_lifetime_t   lifetime;</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCRYPT | PSA_KEY_USAGE_DECRYPT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, alg);</div><div class="line"></div><div class="line">    <span class="comment">/* To use wrapped keys instead of plaintext use PSA_KEY_TYPE_AES_WRAPPED. */</span></div><div class="line"></div><div class="line">    <span class="comment">/* When using XTS mode, since there are two keys used, the key_bits value is twice the AES key length.</span></div><div class="line"><span class="comment">     * For AES 128 XTS mode, the key_bits value is 256. MbedTLS only supports AES 128 currently. */</span></div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_AES);</div><div class="line">    psa_set_key_bits(&amp;attributes, key_bits);</div><div class="line"></div><div class="line">    lifetime = PSA_KEY_LIFETIME_VOLATILE;</div><div class="line"></div><div class="line">    <span class="comment">/* To use persistent keys:</span></div><div class="line"><span class="comment">     *......Use a lifetime value of PSA_KEY_LIFETIME_PERSISTENT</span></div><div class="line"><span class="comment">     * -    The file system must be initialized prior to calling the generate/import key functions.</span></div><div class="line"><span class="comment">     * -    Refer to the littlefs example to see how to format and mount the filesystem. */</span></div><div class="line">    psa_set_key_lifetime(&amp;attributes, lifetime);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_KEY_LIFETIME_IS_PERSISTENT(lifetime))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Set the id to a positive integer. */</span></div><div class="line">        psa_set_key_id(&amp;attributes, (psa_key_id_t) 5);</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_random(input, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Random number generation for input data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating AES 256 key and allocating to key slot failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_encrypt_setup(&amp;operation_1, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the encryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_generate_iv(&amp;operation_1, iv, <span class="keyword">sizeof</span>(iv), &amp;iv_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating the random IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_1, input, <span class="keyword">sizeof</span>(input), part_size, encrypted_data, <span class="keyword">sizeof</span>(encrypted_data),</div><div class="line">                              &amp;encrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Encryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_1))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the encryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_decrypt_setup(&amp;operation_2, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the decryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_set_iv(&amp;operation_2, iv, <span class="keyword">sizeof</span>(iv)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Setting the IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_2, encrypted_data, encrypted_length, part_size, decrypted_data,</div><div class="line">                              <span class="keyword">sizeof</span>(decrypted_data), &amp;decrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Decryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the decryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(input, decrypted_data, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Comparing the input data with decrypted data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Destroying the key handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All the operations succeeded */</span></div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/* Close the SCE */</span></div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>AES-CCM Example</h2>
<p>This is an example on using the PSA Crypto API to generate an AES256 key, encrypting and decrypting multi-block data and using PKCS7 padding using AES-CCM.</p>
<div class="fragment"><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_random(input, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Random plaintext input generation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key generation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* AES-CCM Encryption */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             psa_aead_encrypt(key_handle, PSA_ALG_CCM, nonce, <span class="keyword">sizeof</span>(nonce), additional_data, <span class="keyword">sizeof</span>(additional_data),</div><div class="line">                              input, <span class="keyword">sizeof</span>(input), encrypt, <span class="keyword">sizeof</span>(encrypt), &amp;output_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* AES-CCM Encryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* AES-CCM Decryption */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             psa_aead_decrypt(key_handle, PSA_ALG_CCM, nonce, <span class="keyword">sizeof</span>(nonce), additional_data, <span class="keyword">sizeof</span>(additional_data),</div><div class="line">                              encrypt, output_len, decrypt, <span class="keyword">sizeof</span>(decrypt), &amp;output_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* AES-CCM Decryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0U != memcmp(input, decrypt, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* The decrypted result did not match the plaintext input */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All operations were successful */</span></div><div class="line">    }</div><div class="line"></div></div><!-- fragment --> <h2>AES-XTS Example</h2>
<p>This is an example on using the PSA Crypto API to generate an AES128 XTS key, encrypting and decrypting multi-block data.</p>
<div class="fragment"><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_random(input, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Random number generation for input data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating AES 256 key and allocating to key slot failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_encrypt_setup(&amp;operation_1, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the encryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_generate_iv(&amp;operation_1, iv, <span class="keyword">sizeof</span>(iv), &amp;iv_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Generating the random IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_1, input, <span class="keyword">sizeof</span>(input), part_size, encrypted_data, <span class="keyword">sizeof</span>(encrypted_data),</div><div class="line">                              &amp;encrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Encryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_1))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the encryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_decrypt_setup(&amp;operation_2, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Initializing the decryption (with PKCS7 padding) operation handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_set_iv(&amp;operation_2, iv, <span class="keyword">sizeof</span>(iv)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Setting the IV failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">             cipher_operation(&amp;operation_2, encrypted_data, encrypted_length, part_size, decrypted_data,</div><div class="line">                              <span class="keyword">sizeof</span>(decrypted_data), &amp;decrypted_length))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Decryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_abort(&amp;operation_2))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Terminating the decryption operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 != memcmp(input, decrypted_data, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Comparing the input data with decrypted data failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Destroying the key handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All the operations succeeded */</span></div><div class="line">    }</div><div class="line"></div></div><!-- fragment --> <h2>CMAC Example</h2>
<p>This is an example on using the PSA Crypto API to generate an AES256 key, followed by generation and verification of MAC for random data of known length.</p>
<div class="fragment"><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_random(input, <span class="keyword">sizeof</span>(input)))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Random number generation failure */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key generation failure */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="comment">/* Steps to generate the MAC */</span></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_sign_setup(&amp;operation, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC Sign setup failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_update(&amp;operation, input, input_size))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC update failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_sign_finish(&amp;operation, AES_CMAC_mac, <span class="keyword">sizeof</span>(AES_CMAC_mac), &amp;mac_ret))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC Sign operation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All the operations succeeded for MAC generation */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Steps to verify the generated MAC */</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_verify_setup(&amp;verify_operation, key_handle, alg))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC verification setup failure */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_update(&amp;verify_operation, input, input_size))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC update failure */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PSA_SUCCESS != psa_mac_verify_finish(&amp;verify_operation, AES_CMAC_mac, mac_ret))</div><div class="line">    {</div><div class="line">        <span class="comment">/* MAC verification failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">/* All the operations succeeded for MAC verification */</span></div><div class="line">    }</div><div class="line"></div></div><!-- fragment --> <h2>ECC Example</h2>
<p>This is an example on using the PSA Crypto API to generate an ECC-P256R1 key, signing and verifying data after hashing it first using SHA256. </p><dl class="section note"><dt>Note</dt><dd>Unlike RSA, ECDSA does not have any padding schemes. Thus the hash argument for the ECC sign operation MUST have a size larger than or equal to the curve size; i.e. for PSA_ECC_CURVE_SECP256R1 the payload size must be at least 256/8 bytes. nist.fips.186-4: " A hash function that provides a lower security strength than the security strength associated with the bit length of 'n' ordinarily should not be used, since this would reduce the security strength of the digital signature process to a level no greater than that provided by the hash function."</dd></dl>
<div class="fragment"><div class="line"><span class="preprocessor">#define ECC_256_BIT_LENGTH       256</span></div><div class="line"><span class="preprocessor">#define ECC_256_EXPORTED_SIZE    500</span></div><div class="line">uint8_t exportedECC_SECP256R1Key[ECC_256_EXPORTED_SIZE];</div><div class="line"><span class="keywordtype">size_t</span>  exportedECC_SECP256R1Keylength = 0;</div><div class="line"><span class="keywordtype">void</span> psa_ecc256R1_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"><span class="comment">/* This example generates an ECC-P256R1 keypair, performs signing and verification operations.</span></div><div class="line"><span class="comment"> * It then exports the generated key into ASN1 DER format to a RAM array which can then be programmed to flash.</span></div><div class="line"><span class="comment"> * It then re-imports that key, and performs signing and verification operations. */</span></div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            payload[] = <span class="stringliteral">&quot;ASYMMETRIC_INPUT_FOR_SIGN......&quot;</span>;</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature1[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature2[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">size_t</span>                   signature_length1 = 0;</div><div class="line">    <span class="keywordtype">size_t</span>                   signature_length2 = 0;</div><div class="line">    psa_key_attributes_t     attributes        = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t     read_attributes   = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx               = {0};</div><div class="line">    psa_key_handle_t         ecc_key_handle    = {0};</div><div class="line"></div><div class="line">    psa_hash_operation_t hash_operation = {0};</div><div class="line">    uint8_t              payload_hash[PSA_HASH_MAX_SIZE];</div><div class="line">    <span class="keywordtype">size_t</span>               payload_hash_len;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_HASH | PSA_KEY_USAGE_VERIFY_HASH | PSA_KEY_USAGE_EXPORT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_ECDSA(PSA_ALG_SHA_256));</div><div class="line"></div><div class="line">    <span class="comment">/* To use wrapped keys instead of plaintext:</span></div><div class="line"><span class="comment">     * - Use PSA_KEY_TYPE_ECC_KEY_PAIR_WRAPPED(PSA_ECC_FAMILY_SECP_R1).*/</span></div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ECC_KEY_PAIR(PSA_ECC_FAMILY_SECP_R1));</div><div class="line">    psa_set_key_bits(&amp;attributes, ECC_256_BIT_LENGTH);</div><div class="line"></div><div class="line">    <span class="comment">/* To use persistent keys instead of volatile:</span></div><div class="line"><span class="comment">     * -     Use PSA_KEY_LIFETIME_PERSISTENT.</span></div><div class="line"><span class="comment">     * -    The file system must be initialized prior to calling the generate/import key functions.</span></div><div class="line"><span class="comment">     * -    Refer to the littlefs example to see how to format and mount the filesystem. */</span></div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate ECC P256R1 Key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;ecc_key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Test the key information */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_get_key_attributes(ecc_key_handle, &amp;read_attributes))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Calculate the hash of the message */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_hash_setup(&amp;hash_operation, PSA_ALG_SHA_256))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_hash_update(&amp;hash_operation, payload, <span class="keyword">sizeof</span>(payload)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_hash_finish(&amp;hash_operation, &amp;payload_hash[0], <span class="keyword">sizeof</span>(payload_hash), &amp;payload_hash_len))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the private key</span></div><div class="line"><span class="comment">     * NOTE: The hash argument (payload_hash here) MUST have a size equal to the curve size;</span></div><div class="line"><span class="comment">     * i.e. for SECP256R1 the payload size must be 256/8 bytes.</span></div><div class="line"><span class="comment">     * Similarly for SECP384R1 the payload size must be 384/8 bytes.</span></div><div class="line"><span class="comment">     * nist.fips.186-4: &quot; A hash function that provides a lower security strength than</span></div><div class="line"><span class="comment">     * the security strength associated with the bit length of &#39;n&#39; ordinarily should not be used, since this</span></div><div class="line"><span class="comment">     * would reduce the security strength of the digital signature process to a level no greater than that</span></div><div class="line"><span class="comment">     * provided by the hash function.&quot; */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(ecc_key_handle, PSA_ALG_ECDSA(PSA_ALG_SHA_256), payload_hash, payload_hash_len, signature1,</div><div class="line">                      <span class="keyword">sizeof</span>(signature1), &amp;signature_length1))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature1 using the public key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(ecc_key_handle, PSA_ALG_ECDSA(PSA_ALG_SHA_256), payload_hash, payload_hash_len, signature1,</div><div class="line">                        signature_length1))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Export the key. The exported key can then be save to flash for later usage.  */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_export_key(ecc_key_handle, exportedECC_SECP256R1Key, <span class="keyword">sizeof</span>(exportedECC_SECP256R1Key),</div><div class="line">                       &amp;exportedECC_SECP256R1Keylength))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key and handle */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(ecc_key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Import the previously exported key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_import_key(&amp;attributes, exportedECC_SECP256R1Key, exportedECC_SECP256R1Keylength, &amp;ecc_key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the private key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(ecc_key_handle, PSA_ALG_ECDSA(PSA_ALG_SHA_256), payload_hash, payload_hash_len, signature2,</div><div class="line">                      <span class="keyword">sizeof</span>(signature2), &amp;signature_length2))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify signature2 using the public key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(ecc_key_handle, PSA_ALG_ECDSA(PSA_ALG_SHA_256), payload_hash, payload_hash_len, signature2,</div><div class="line">                        signature_length2))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Signatures cannot be compared since ECC signatures vary for the same data unless Deterministic ECC is used which is not supported by the HW.</span></div><div class="line"><span class="comment">     * Only the verification operation can be used to validate signatures. */</span></div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>RSA Example</h2>
<p>This is an example on using the PSA Crypto API to generate an RSA2048 key, encrypting and decrypting multi-block data and using PKCS7 padding.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define RSA_2048_BIT_LENGTH       2048</span></div><div class="line"><span class="preprocessor">#define RSA_2048_EXPORTED_SIZE    1210</span></div><div class="line"></div><div class="line"><span class="comment">/* The RSA 2048 key pair export in der format is roughly as follows</span></div><div class="line"><span class="comment"> * RSA private keys:</span></div><div class="line"><span class="comment"> *  RSAPrivateKey ::= SEQUENCE {   ---------------------------------------  1 + 3</span></div><div class="line"><span class="comment"> *      version           Version, ---------------------------------------  1 + 1 + 1</span></div><div class="line"><span class="comment"> *      modulus           INTEGER, ---------------- n  -------------------  1 + 3 + 256 + 1</span></div><div class="line"><span class="comment"> *      publicExponent    INTEGER, ---------------- e  -------------------  1 + 4</span></div><div class="line"><span class="comment"> *      privateExponent   INTEGER, ---------------- d  -------------------  1 + 3 + 256 (276 for Wrapped)</span></div><div class="line"><span class="comment"> *      prime1            INTEGER, ---------------- p  -------------------  1 + 3 + (256 / 2)</span></div><div class="line"><span class="comment"> *      prime2            INTEGER, ---------------- q  -------------------  1 + 3 + (256 / 2)</span></div><div class="line"><span class="comment"> *      exponent1         INTEGER, ---------------- d mod (p-1)  ---------  1 + 2 + (256 / 2) (4 for Wrapped)</span></div><div class="line"><span class="comment"> *      exponent2         INTEGER, ---------------- d mod (q-1)  ---------  1 + 2 + (256 / 2) (4 for Wrapped)</span></div><div class="line"><span class="comment"> *      coefficient       INTEGER, ---------------- (inverse of q) mod p -  1 + 2 + (256 / 2) (4 for Wrapped)</span></div><div class="line"><span class="comment"> *      otherPrimeInfos   OtherPrimeInfos OPTIONAL ------------------------ 0 (not supported)</span></div><div class="line"><span class="comment"> *  }</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line">uint8_t exportedRSA2048Key[RSA_2048_EXPORTED_SIZE];</div><div class="line"><span class="keywordtype">size_t</span>  exportedRSA2048Keylength = 0;</div><div class="line"><span class="keywordtype">void</span> psa_rsa2048_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"><span class="comment">/* This example generates an RSA2048 keypair, performs signing and verification operations.</span></div><div class="line"><span class="comment"> * It then exports the generated key into ASN1 DER format to a RAM array which can then be programmed to flash.</span></div><div class="line"><span class="comment"> * It then re-imports that key, and performs signing and verification operations. */</span></div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_key_handle_t         key_handle = {0};</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            payload[]  = <span class="stringliteral">&quot;ASYMMETRIC_INPUT_FOR_SIGN&quot;</span>;</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature1[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature2[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               signature_length1 = 0;</div><div class="line">    <span class="keywordtype">size_t</span>               signature_length2 = 0;</div><div class="line">    psa_key_attributes_t attributes        = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t read_attributes   = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_HASH | PSA_KEY_USAGE_VERIFY_HASH | PSA_KEY_USAGE_EXPORT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_RSA_PKCS1V15_SIGN_RAW);</div><div class="line"></div><div class="line">    <span class="comment">/* To use wrapped keys instead of plaintext:</span></div><div class="line"><span class="comment">     * - Use PSA_KEY_TYPE_RSA_KEY_PAIR_WRAPPED. */</span></div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_RSA_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, RSA_2048_BIT_LENGTH);</div><div class="line"></div><div class="line">    <span class="comment">/* To use persistent keys instead of volatile:</span></div><div class="line"><span class="comment">     * -    Use PSA_KEY_LIFETIME_PERSISTENT.</span></div><div class="line"><span class="comment">     * -    The file system must be initialized prior to calling the generate/import key functions.</span></div><div class="line"><span class="comment">     * -    Refer to the littlefs example to see how to format and mount the filesystem. */</span></div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate RSA 2048 Key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Test the key information */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_get_key_attributes(key_handle, &amp;read_attributes))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the private key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature1,</div><div class="line">                      <span class="keyword">sizeof</span>(signature1), &amp;signature_length1))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature1 using the public key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature1,</div><div class="line">                        signature_length1))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Export the key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_export_key(key_handle, exportedRSA2048Key, <span class="keyword">sizeof</span>(exportedRSA2048Key), &amp;exportedRSA2048Keylength))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key and handle */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Import the previously exported key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_import_key(&amp;attributes, exportedRSA2048Key, exportedRSA2048Keylength, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the private key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature2,</div><div class="line">                      <span class="keyword">sizeof</span>(signature2), &amp;signature_length2))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify signature2 using the public key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature2,</div><div class="line">                        signature_length2))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Compare signatures to verify that the same signature was generated */</span></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(signature2, signature1, signature_length2))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    mbedtls_psa_crypto_free();</div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/* Generated using &quot;openssl genrsa -out example_private_key.pem 2048&quot; */</span></div><div class="line"><span class="keyword">const</span> uint8_t RSAKeydata[] = <span class="stringliteral">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;MIIEowIBAAKCAQEAplaPU68h4hW/eAlH2hbQl1WjoDT1znCk0O9cnE9lAnB26IUi&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;78wUAxuTZSlrlKez9FGGIVbUMTy7dTw0ZBanogrKCaAMaRFz5LRv4I8RQzsDxxqe&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;nud9Y6mVRWb9hyutL/yBwDd6jzAwcviAhcatTv0E5wpEJ6ezMDyaiSCbn84hfb0T&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;ZPXQVGhmjii3f0FfFWW9ce70qkuwdkvO6HBrOGVi2++b11As+Uh/7pxyOb7wpE7K&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;X64nohaCtXgNnV8Hr+LOPQRHEbGTCPOfx1davKEIYFvm8hVxqv20csMD5uc8AJCd&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;0cdom13KcOpVXCnrFPNJt0lITOcH/fBzp4xoaQIDAQABAoIBAGc56qKVWeKzempk&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;4AlRBUwVYoEGvNDLiQz8rq12fAoCf1iXXvIP5Q90qokqJlBPrtbdTO8dsnuH5BHC&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;NgUzJf7i0TUd9PWzVgfFjnR+dMkTM6n5NB0LLf6OfEtguc+L5GOWQXNnOpDn5/lB&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;jIj4ng8Z6FP1RAyT/xjdU03sRYfq5OPlDZ8+ck7WwQ8VxSBKsJcZVv+K4r64Vmr1&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;MO1zfBYuwafi4oO9Z9x89Iil9GBcYuCvhLvDoWhnTUxlOTfz+Jt+qwlmVimEz6xs&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;6ew1Ox7e6SInly3IAXe9E84yP9MDmiGkCrVr8s8GUybZ5t/yeZ3g5lPYSQ/FiuHY&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;kvJCH4ECgYEA2IthRDkElOQGqJ9T/LjgcIVLQs0F6i7zZWg6UKv18EmG7uHd6tsZ&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;byFfFiBat80rq6q4AUx2OOE7+LI5MxIvgRgLk14WV8H2OKK/lfxOFb6a4feGM7bH&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;VdERQSMNeGq0bP9IOPxU1EvFp0Vfv7cfGsQhcAPgA8up61jWREhI+fECgYEAxKVT&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;9pKinIwgjsHgmxalaNbnRf+bcqtdS98SB2MuICg8ubcBSrjm4wtGe3oCX/PbM1GV&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;FvEDKl4TyeWFIH4MStsyDHYxwoV2C01bBHEtHTYBnjeIShMruIomsG9GeTrNmyzg&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;dVdSg5/lxYOxuZSXvfcbyIMsW29ddgeICu9RHfkCgYBaljQibhfUkW+Xqs9fsZdy&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;etB5KXuH9AwuJ+P9S3KfCqM/240SaoXBT5yPjQlmSpYyQkCnim0Kbm7AIw56pujo&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;gD6Xb4y5OZLfLnYnMF0aC5qPXRTvHU9WPxeQwDEqZrkDv+der3BtPyV4TDU55klE&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;0TeLvJNCAzkaExfPiM2+gQKBgQC5ceBYq7hGQa+CcTvLhfO/hsrbrE2AOjLllhx+&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;cv3QvaFm0jqZqP20J7H0R/9tVZ7mKo2a8Pa3QbkPsS92kOguv7/XGK+cbhgAWJb4&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;/XI6FfA4sM4KbUHR6hbKVGX1dYroR831WsAp+OTK+4LjLEpdj2fYFDwEjmVpJXka&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;Ns4coQKBgGESrtpJF7OQG4xcXwR2ZiJESPvMKVmtvxRzDrc9gmoiIIIKx1fimwCv&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;RtOz1bQcXMRw21+ZAZpen3ahWh63KC0KxMSNBJTXdczlf2uprVkSPtmAjV4qBgwv&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;tqjmP0lnGc9wkJsVvGmMAAfQOWgxs9h/VH/b+6biEkzaaZLOyABV&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;-----END RSA PRIVATE KEY-----\n&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">/* Expected signature below is calculated using the mbedCrypto software version */</span></div><div class="line"><span class="keyword">const</span> uint8_t RSAExpectedSignature[256] =</div><div class="line">{</div><div class="line">    0x25, 0xC0, 0x15, 0x64, 0xD3, 0xF7, 0xC1, 0xB7, 0xA8, 0x9B, 0x56, 0x1C, 0xB5, 0xA4, 0xA5, 0x0D, 0x61, 0x52, 0x32,</div><div class="line">    0x0C, 0x4E, 0xE8, 0xCA, 0x4B, 0x9E, 0xA2, 0x4D, 0x35, 0x0E, 0xB1, 0xA1, 0x5B, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x5B, 0xD8, 0xC1, 0x93, 0x28, 0x60, 0x90, 0x18, 0x37, 0x88, 0x66, 0xD4, 0xED, 0x37, 0x6B, 0xEC, 0x48, 0xFF, 0x3D,</div><div class="line">    0xFB, 0x99, 0xB7, 0xEF, 0x3C, 0x8D, 0x25, 0xE9, 0xF3, 0xCF, 0x02, 0x7C, 0x7D, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xB9, 0x4D, 0x2F, 0x2F, 0x1E, 0x30, 0x48, 0x54, 0x18, 0xE4, 0x51, 0xD5, 0xC1, 0xB7, 0x3B, 0x0D, 0xE4, 0xB4, 0x19,</div><div class="line">    0x7B, 0x9B, 0xF4, 0x35, 0x82, 0xCC, 0x91, 0x4C, 0x10, 0xE9, 0xB6, 0xF1, 0x0A, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x23, 0xEB, 0x7D, 0x51, 0x47, 0x36, 0xFE, 0x13, 0xAF, 0x3C, 0x23, 0x9F, 0x7E, 0xFC, 0xCF, 0x7A, 0x7C, 0x2D, 0xDB,</div><div class="line">    0xD9, 0xDA, 0xEB, 0xF7, 0xB5, 0x6B, 0x8D, 0xE0, 0x18, 0x9A, 0x5B, 0xB7, 0x0A, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xA3, 0x4E, 0xE1, 0xB7, 0xF7, 0xD1, 0x94, 0xD5, 0x7A, 0xD3, 0x27, 0xE2, 0x1F, 0x3A, 0xEB, 0xF0, 0x83, 0x10, 0x52,</div><div class="line">    0x51, 0x5F, 0x58, 0xF8, 0x81, 0x42, 0x48, 0x83, 0x2D, 0xF0, 0xA9, 0x7D, 0x79, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x2B, 0xF1, 0x68, 0xC2, 0x22, 0xC0, 0x0C, 0x72, 0x63, 0x37, 0xBF, 0xEC, 0x72, 0x97, 0xD4, 0xA5, 0x91, 0x2E, 0x1F,</div><div class="line">    0xA3, 0x78, 0x9A, 0xCE, 0xFE, 0x27, 0x7F, 0x2B, 0x85, 0x7D, 0x22, 0x2C, 0x0D, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x1E, 0x10, 0xB7, 0xFF, 0x9A, 0xA7, 0x99, 0xD2, 0xB9, 0x40, 0x53, 0xB3, 0xA9, 0x52, 0x5D, 0xBD, 0xC8, 0x12, 0x8D,</div><div class="line">    0x39, 0xD7, 0x97, 0x03, 0xD2, 0x80, 0x21, 0xC3, 0xA7, 0x8B, 0xE3, 0x3D, 0xF0, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4D, 0x4C, 0x4D, 0xC4, 0xC7, 0xE5, 0xE4, 0x35, 0x75, 0xAA, 0x45, 0x3B, 0x9C, 0x64, 0xC1, 0x94, 0x6E, 0x15, 0x0A,</div><div class="line">    0xE8, 0x84, 0xCD, 0xFC, 0x7A, 0xBC, 0x5C, 0x8C, 0xA8, 0x95, 0x07, 0x79, 0x4E, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_rsa2048_pem_format_import_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"><span class="comment">/* This example imports an RSA2048 keypair of PEM format, performs signing and verification operations. */</span></div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_key_handle_t         key_handle = {0};</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            payload[]  = <span class="stringliteral">&quot;ASYMMETRIC_INPUT_FOR_SIGN&quot;</span>;</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               signature_length = 0U;</div><div class="line">    psa_key_attributes_t attributes       = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t read_attributes  = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_HASH | PSA_KEY_USAGE_VERIFY_HASH);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_RSA_PKCS1V15_SIGN_RAW);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_RSA_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, RSA_2048_BIT_LENGTH);</div><div class="line"></div><div class="line">    <span class="comment">/* Import the private key (This includes both the private and public key) */</span></div><div class="line">    mbedtls_pk_context ctx_rsa;</div><div class="line">    mbedtls_pk_init(&amp;ctx_rsa);</div><div class="line"></div><div class="line">    <span class="comment">/* For keys other than ASN format, mbedtls_pk_parse_key and mbedtls_pk_import_into_psa APIs must be called instead of psa_import_key */</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        mbedtls_pk_parse_key(&amp;ctx_rsa, RSAKeydata, <span class="keyword">sizeof</span>(RSAKeydata), NULL, 0, mbedtls_psa_get_random,</div><div class="line">                             MBEDTLS_PSA_RANDOM_STATE))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != mbedtls_pk_import_into_psa(&amp;ctx_rsa, &amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    mbedtls_pk_free(&amp;ctx_rsa);</div><div class="line"></div><div class="line">    <span class="comment">/* Test the key information */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_get_key_attributes(key_handle, &amp;read_attributes))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature, <span class="keyword">sizeof</span>(signature),</div><div class="line">                      &amp;signature_length))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(signature, &amp;RSAExpectedSignature, <span class="keyword">sizeof</span>(RSAExpectedSignature)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), RSAExpectedSignature,</div><div class="line">                        <span class="keyword">sizeof</span>(RSAExpectedSignature)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key and handle */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    mbedtls_psa_crypto_free();</div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2>CHACHA20 Example</h2>
<p>This is an example on using the PSA Crypto API to import an ChaCha20 key, encrypting and decrypting single block data.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* Test vector from http://www.rfc-editor.org/rfc/rfc8439.html#section-2.8.2 */</span></div><div class="line"><span class="keyword">const</span> uint8_t chacha_key[] =</div><div class="line">{</div><div class="line">    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x88, 0x89, 0x8a, 0x8b, 0x8c, 0x8d, 0x8e, 0x8f, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x98, 0x99, 0x9a, 0x9b, 0x9c, 0x9d, 0x9e, 0x9f  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chacha_iv[] =</div><div class="line">{</div><div class="line">    0x07, 0x00, 0x00, 0x00,                        <span class="comment">/* 32-bit common part */</span></div><div class="line">    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47 <span class="comment">/* 64-bit IV */</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chacha_plaintext[] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x20, 0x21, 0x22, 0x23                                                                          <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chacha_ciphertext[] =</div><div class="line">{</div><div class="line">    0x9F, 0x7A, 0xEB, 0x5E, 0x05, 0xF8, 0x46, 0xBD, 0x1D, 0xEB, 0x85, 0xF0, 0x3A, 0x8C, 0x04, 0xA1, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xD1, 0xD1, 0x9A, 0x2C, 0x1D, 0x14, 0x78, 0xC9, 0xC5, 0x93, 0xCA, 0x9C, 0x49, 0x9F, 0x1D, 0xBA, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x6E, 0xBF, 0xE9, 0x1B                                                                          <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chacha_mac[] =</div><div class="line">{</div><div class="line">    0xC8, 0xB3, 0xFA, 0xDC, 0xF9, 0x1F, 0x78, 0x97, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xCD, 0xD7, 0x54, 0xE2, 0xFC, 0x0B, 0xE1, 0xE5  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>import_key_items_symmetric_s</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> uint8_t * key;</div><div class="line">    <span class="keywordtype">size_t</span>          key_size;</div><div class="line">    <span class="keyword">const</span> uint8_t * nonce_iv;          <span class="comment">// Nomenclature &#39;nonce&#39; OR &#39;iv&#39; depends on the algorithm. Eg: This is Nonce for CCM and IV for GCM.</span></div><div class="line">    <span class="keywordtype">size_t</span>          nonce_iv_size;</div><div class="line">    <span class="keyword">const</span> uint8_t * aad;</div><div class="line">    <span class="keywordtype">size_t</span>          aad_size;</div><div class="line">    <span class="keyword">const</span> uint8_t * mac;</div><div class="line">    <span class="keywordtype">size_t</span>          mac_size;</div><div class="line">    <span class="keyword">const</span> uint8_t * plaintext;</div><div class="line">    <span class="keywordtype">size_t</span>          plaintext_size;</div><div class="line">    <span class="keyword">const</span> uint8_t * ciphertext;</div><div class="line">    <span class="keywordtype">size_t</span>          ciphertext_size;</div><div class="line">} import_key_items_symmetric_t;</div><div class="line"></div><div class="line"><span class="keyword">const</span> import_key_items_symmetric_t chacha_testdata =</div><div class="line">{</div><div class="line">    chacha_key,</div><div class="line">    <span class="keyword">sizeof</span>(chacha_key),</div><div class="line">    chacha_iv,</div><div class="line">    <span class="keyword">sizeof</span>(chacha_iv),</div><div class="line">    NULL,</div><div class="line">    0,</div><div class="line">    chacha_mac,</div><div class="line">    16,</div><div class="line">    chacha_plaintext,</div><div class="line">    <span class="keyword">sizeof</span>(chacha_plaintext),</div><div class="line">    chacha_ciphertext,</div><div class="line">    <span class="keyword">sizeof</span>(chacha_ciphertext),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_crypto_chacha20_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_key_handle_t         key_handle = 0;</div><div class="line">    <span class="keywordtype">size_t</span>  encr_len = 0;</div><div class="line">    <span class="keywordtype">size_t</span>  decr_len = 0;</div><div class="line">    uint8_t encrypt[200];              <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    uint8_t decrypt[200];              <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    import_key_items_symmetric_t * p_import_key_items = (import_key_items_symmetric_t *) &amp;chacha_testdata;</div><div class="line">    psa_key_attributes_t           attributes         = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    <span class="keyword">const</span> psa_algorithm_t          alg                = PSA_ALG_STREAM_CIPHER;</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCRYPT | PSA_KEY_USAGE_DECRYPT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, alg);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_CHACHA20);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line">    psa_set_key_bits(&amp;attributes, 256); <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_KEY_LIFETIME_IS_PERSISTENT(PSA_KEY_LIFETIME_VOLATILE))</div><div class="line">    {</div><div class="line">        psa_set_key_id(&amp;attributes, (psa_key_id_t) 2);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_import_key(&amp;attributes, p_import_key_items-&gt;key, p_import_key_items-&gt;key_size, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_cipher_encrypt(key_handle, alg, p_import_key_items-&gt;plaintext, p_import_key_items-&gt;plaintext_size, encrypt,</div><div class="line">                           <span class="keyword">sizeof</span>(encrypt), &amp;encr_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Encryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_cipher_decrypt(key_handle, alg, encrypt, encr_len, decrypt, <span class="keyword">sizeof</span>(decrypt), &amp;decr_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Decryption failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (p_import_key_items-&gt;plaintext_size == decr_len)</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(p_import_key_items-&gt;plaintext, decrypt, p_import_key_items-&gt;plaintext_size))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Destroying the key handle failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>CHACHA20-POLY1305 Example</h2>
<p>This is an example on using the PSA Crypto API to import an ChaCha20 key, encrypting/decrypting single block data and generates the MAC (authentication tag)</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> uint8_t chachapoly_key[] =</div><div class="line">{</div><div class="line">    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x88, 0x89, 0x8a, 0x8b, 0x8c, 0x8d, 0x8e, 0x8f, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x98, 0x99, 0x9a, 0x9b, 0x9c, 0x9d, 0x9e, 0x9f  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chachapoly_iv[] =</div><div class="line">{</div><div class="line">    0x07, 0x00, 0x00, 0x00,                        <span class="comment">/* 32-bit common part */</span></div><div class="line">    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47 <span class="comment">/* 64-bit IV */</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chachapoly_plaintext[] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x20, 0x21, 0x22, 0x23                                                                          <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chachapoly_ciphertext[] =</div><div class="line">{</div><div class="line">    0x9F, 0x7A, 0xEB, 0x5E, 0x05, 0xF8, 0x46, 0xBD, 0x1D, 0xEB, 0x85, 0xF0, 0x3A, 0x8C, 0x04, 0xA1, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xD1, 0xD1, 0x9A, 0x2C, 0x1D, 0x14, 0x78, 0xC9, 0xC5, 0x93, 0xCA, 0x9C, 0x49, 0x9F, 0x1D, 0xBA, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x6E, 0xBF, 0xE9, 0x1B                                                                          <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t chachapoly_mac[] =</div><div class="line">{</div><div class="line">    0xC8, 0xB3, 0xFA, 0xDC, 0xF9, 0x1F, 0x78, 0x97, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xCD, 0xD7, 0x54, 0xE2, 0xFC, 0x0B, 0xE1, 0xE5  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// typedef struct import_key_items_symmetric_s</span></div><div class="line"><span class="comment">// {</span></div><div class="line"><span class="comment">// const uint8_t * key;</span></div><div class="line"><span class="comment">// size_t          key_size;</span></div><div class="line"><span class="comment">// const uint8_t * nonce_iv;          // Nomenclature &#39;nonce&#39; OR &#39;iv&#39; depends on the algorithm. Eg: This is Nonce for CCM and IV for GCM.</span></div><div class="line"><span class="comment">// size_t          nonce_iv_size;</span></div><div class="line"><span class="comment">// const uint8_t * aad;</span></div><div class="line"><span class="comment">// size_t          aad_size;</span></div><div class="line"><span class="comment">// const uint8_t * mac;</span></div><div class="line"><span class="comment">// size_t          mac_size;</span></div><div class="line"><span class="comment">// const uint8_t * plaintext;</span></div><div class="line"><span class="comment">// size_t          plaintext_size;</span></div><div class="line"><span class="comment">// const uint8_t * ciphertext;</span></div><div class="line"><span class="comment">// size_t          ciphertext_size;</span></div><div class="line"><span class="comment">// } import_key_items_symmetric_t;</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> import_key_items_symmetric_t chachapoly_testdata =</div><div class="line">{</div><div class="line">    chachapoly_key,</div><div class="line">    <span class="keyword">sizeof</span>(chachapoly_key),</div><div class="line">    chachapoly_iv,</div><div class="line">    <span class="keyword">sizeof</span>(chachapoly_iv),</div><div class="line">    NULL,</div><div class="line">    0,</div><div class="line">    chachapoly_mac,</div><div class="line">    16,</div><div class="line">    chachapoly_plaintext,</div><div class="line">    <span class="keyword">sizeof</span>(chachapoly_plaintext),</div><div class="line">    chachapoly_ciphertext,</div><div class="line">    <span class="keyword">sizeof</span>(chachapoly_ciphertext),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_crypto_chachapoly_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keyword">enum</span></div><div class="line">    {</div><div class="line">        block_size = 16,</div><div class="line">        part_size  = block_size,</div><div class="line">    };</div><div class="line">    <span class="keyword">const</span> psa_algorithm_t    alg        = PSA_ALG_CHACHA20_POLY1305;</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_key_handle_t         key_handle = 0;</div><div class="line">    <span class="keywordtype">size_t</span>  encr_len = 0;</div><div class="line">    <span class="keywordtype">size_t</span>  decr_len = 0;</div><div class="line">    uint8_t encrypt[200];              <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    uint8_t decrypt[200];              <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    import_key_items_symmetric_t * p_import_key_items = (import_key_items_symmetric_t *) &amp;chachapoly_testdata;</div><div class="line">    psa_key_attributes_t           attributes         = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCRYPT | PSA_KEY_USAGE_DECRYPT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, alg);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_CHACHA20);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line">    psa_set_key_bits(&amp;attributes, 256); <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_KEY_LIFETIME_IS_PERSISTENT(PSA_KEY_LIFETIME_VOLATILE))</div><div class="line">    {</div><div class="line">        psa_set_key_id(&amp;attributes, (psa_key_id_t) 2);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_import_key(&amp;attributes, p_import_key_items-&gt;key, p_import_key_items-&gt;key_size, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_aead_encrypt(key_handle, alg, p_import_key_items-&gt;nonce_iv, p_import_key_items-&gt;nonce_iv_size, NULL, 0,</div><div class="line">                         p_import_key_items-&gt;plaintext, p_import_key_items-&gt;plaintext_size, encrypt, <span class="keyword">sizeof</span>(encrypt),</div><div class="line">                         &amp;encr_len))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (p_import_key_items-&gt;plaintext_size + p_import_key_items-&gt;mac_size != encr_len)</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(p_import_key_items-&gt;ciphertext, encrypt, p_import_key_items-&gt;plaintext_size))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 !=</div><div class="line">        memcmp(p_import_key_items-&gt;mac, &amp;encrypt[p_import_key_items-&gt;plaintext_size], p_import_key_items-&gt;mac_size))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_aead_decrypt(key_handle, alg, p_import_key_items-&gt;nonce_iv, p_import_key_items-&gt;nonce_iv_size, NULL, 0,</div><div class="line">                         encrypt, encr_len, decrypt, <span class="keyword">sizeof</span>(decrypt), &amp;decr_len))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (p_import_key_items-&gt;plaintext_size != decr_len)</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(p_import_key_items-&gt;plaintext, decrypt, p_import_key_items-&gt;plaintext_size))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>ML-KEM Example</h2>
<p>This is an example on using the PSA Crypto API to generate an MLKEM-512 key, encapsulating and decapsulating ciphertext.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_mlkem512_keygen_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx                  = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               bits                     = PSA_KEY_BITS_ML_KEM_512;</div><div class="line">    psa_key_handle_t     key_handle               = 0;</div><div class="line">    psa_key_id_t         output_key_handle        = 0;</div><div class="line">    psa_key_id_t         decap_output_key_handle  = 0;</div><div class="line">    psa_key_attributes_t attributes               = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t shared_secret_attributes = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    uint8_t              ciphertext[PSA_ML_KEM_CIPHERTEXT_SIZE(PSA_KEY_BITS_ML_KEM_512)];</div><div class="line">    <span class="keywordtype">size_t</span>               ciphertext_len = PSA_ML_KEM_CIPHERTEXT_SIZE(PSA_KEY_BITS_ML_KEM_512);</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCAPSULATE | PSA_KEY_USAGE_DECAPSULATE);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_ML_KEM);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ML_KEM_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, bits);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key generation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;shared_secret_attributes, PSA_KEY_USAGE_ENCAPSULATE | PSA_KEY_USAGE_DECAPSULATE);</div><div class="line">    psa_set_key_algorithm(&amp;shared_secret_attributes, PSA_ALG_ML_KEM);</div><div class="line">    psa_set_key_type(&amp;shared_secret_attributes, PSA_KEY_TYPE_RAW_DATA);</div><div class="line">    psa_set_key_bits(&amp;shared_secret_attributes, PSA_BYTES_TO_BITS(PSA_ML_KEM_SHARED_SECRET_SIZE));</div><div class="line">    psa_set_key_lifetime(&amp;shared_secret_attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_encapsulate(key_handle, PSA_ALG_ML_KEM, &amp;shared_secret_attributes, &amp;output_key_handle, &amp;ciphertext[0],</div><div class="line">                        ciphertext_len, &amp;ciphertext_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key encapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_decapsulate(key_handle, PSA_ALG_ML_KEM, &amp;ciphertext[0], ciphertext_len, &amp;shared_secret_attributes,</div><div class="line">                        &amp;decap_output_key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key decapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/* Two 32-byte seed values, d and z, concatenated */</span></div><div class="line">uint8_t mlkem_import_keypair[PSA_KEY_EXPORT_ML_KEM_KEY_PAIR_MAX_SIZE] =</div><div class="line">{</div><div class="line">    0x1E, 0xB4, 0x40, 0x0A, 0x01, 0x62, 0x9D, 0x51, 0x79, 0x74, 0xE2, 0xCD, 0x85, 0xB9, 0xDE, 0xF5, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x90, 0x82, 0xDE, 0x50, 0x8E, 0x6F, 0x9C, 0x2B, 0x0E, 0x34, 0x1E, 0x12, 0x96, 0x59, 0x55, 0xCA, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x1A, 0x39, 0x41, 0x11, 0x16, 0x38, 0x03, 0xFE, 0x2E, 0x85, 0x19, 0xC3, 0x35, 0xA6, 0x86, 0x75, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x56, 0x33, 0x8E, 0xAD, 0xAF, 0xA2, 0x2B, 0x5F, 0xC5, 0x57, 0x43, 0x05, 0x60, 0xCC, 0xD6, 0x93  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_mlkem512_keypair_import_export_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx                  = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               bits                     = PSA_KEY_BITS_ML_KEM_512;</div><div class="line">    psa_key_handle_t     key_handle               = 0;</div><div class="line">    psa_key_id_t         output_key_handle        = 0;</div><div class="line">    psa_key_id_t         decap_output_key_handle  = 0;</div><div class="line">    psa_key_attributes_t attributes               = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t shared_secret_attributes = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    uint8_t              ciphertext[PSA_ML_KEM_CIPHERTEXT_SIZE(PSA_KEY_BITS_ML_KEM_512)];</div><div class="line">    <span class="keywordtype">size_t</span>               ciphertext_len = PSA_ML_KEM_CIPHERTEXT_SIZE(PSA_KEY_BITS_ML_KEM_512);</div><div class="line">    uint8_t              export_keypair[PSA_KEY_GEN_ML_KEM_KEY_PAIR_MAX_SIZE(PSA_KEY_BITS_ML_KEM_512)];</div><div class="line">    <span class="keywordtype">size_t</span>               export_keypair_len = 0;</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_ENCAPSULATE | PSA_KEY_USAGE_DECAPSULATE | PSA_KEY_USAGE_EXPORT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_ML_KEM);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ML_KEM_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, bits);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="comment">/* Import key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_import_key(&amp;attributes, &amp;mlkem_import_keypair[0], PSA_KEY_GEN_ML_KEM_KEY_PAIR_MAX_SIZE(bits), &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key generation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;shared_secret_attributes, PSA_KEY_USAGE_ENCAPSULATE | PSA_KEY_USAGE_DECAPSULATE);</div><div class="line">    psa_set_key_algorithm(&amp;shared_secret_attributes, PSA_ALG_ML_KEM);</div><div class="line">    psa_set_key_type(&amp;shared_secret_attributes, PSA_KEY_TYPE_RAW_DATA);</div><div class="line">    psa_set_key_bits(&amp;shared_secret_attributes, PSA_BYTES_TO_BITS(PSA_ML_KEM_SHARED_SECRET_SIZE));</div><div class="line">    psa_set_key_lifetime(&amp;shared_secret_attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_encapsulate(key_handle, PSA_ALG_ML_KEM, &amp;shared_secret_attributes, &amp;output_key_handle, &amp;ciphertext[0],</div><div class="line">                        ciphertext_len, &amp;ciphertext_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key encapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_decapsulate(key_handle, PSA_ALG_ML_KEM, &amp;ciphertext[0], ciphertext_len, &amp;shared_secret_attributes,</div><div class="line">                        &amp;decap_output_key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key decapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Export the key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_export_key(key_handle, &amp;export_keypair[0], PSA_KEY_GEN_ML_KEM_KEY_PAIR_MAX_SIZE(bits), &amp;export_keypair_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key pair export failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Make sure the exported key pair matches the imported buffer */</span></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(mlkem_import_keypair, export_keypair, export_keypair_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Exported key does not match imported key */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>ML-DSA Example</h2>
<p>This is an example on using the PSA Crypto API to generate an MLDSA-44 key, sign and verify a message.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define MLDSA_MESSAGE_LEN    512U</span></div><div class="line"><span class="keyword">static</span> uint8_t mldsa_test_message[MLDSA_MESSAGE_LEN] =</div><div class="line">{</div><div class="line">    0xF0, 0xA4, 0xA1, 0x8C, 0xCF, 0x98, 0x2E, 0x89, 0x1F, 0x3E, 0x91, 0x73, 0x27, 0x90, 0x1F, 0x73, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x83, 0x90, 0xE1, 0x7A, 0xB9, 0x5F, 0xF1, 0xFB, 0x7C, 0x76, 0x83, 0x50, 0x38, 0x88, 0x9F, 0x73, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xAF, 0x0D, 0x24, 0x49, 0x76, 0xDB, 0x62, 0x21, 0x94, 0xFA, 0xDA, 0x41, 0x14, 0x9E, 0x53, 0x4A, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xCD, 0x96, 0xB9, 0x23, 0x38, 0x52, 0x98, 0x14, 0xEE, 0x18, 0x68, 0x32, 0xB9, 0xC3, 0x83, 0xF9, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x80, 0xA5, 0x11, 0x7B, 0xDB, 0xED, 0x09, 0x3D, 0xB3, 0x1A, 0xCD, 0x52, 0x73, 0xDF, 0x13, 0xE5, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xA8, 0x3D, 0x14, 0xBB, 0x82, 0x1F, 0x18, 0xC1, 0x88, 0xFF, 0x36, 0x80, 0x19, 0x16, 0x3C, 0x61, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4C, 0x4D, 0x20, 0x27, 0x83, 0xFC, 0x88, 0xE2, 0x52, 0x3C, 0x42, 0x51, 0x14, 0x21, 0x14, 0x25, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x98, 0x81, 0x48, 0xF5, 0x25, 0xD0, 0x47, 0xA0, 0xCD, 0x95, 0x77, 0x63, 0xCF, 0x5B, 0x79, 0xF6, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x6B, 0xE1, 0x73, 0x87, 0x04, 0xAC, 0x66, 0xF1, 0x33, 0x39, 0x8B, 0xC9, 0xC0, 0xE5, 0x57, 0x00, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x63, 0x06, 0xDB, 0x92, 0x0C, 0xA8, 0x43, 0xC0, 0xD5, 0x24, 0xD4, 0xEA, 0xED, 0xBC, 0x1B, 0xDE, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x05, 0x03, 0x37, 0x6B, 0x22, 0x77, 0x2B, 0x74, 0x14, 0x55, 0x9D, 0x68, 0x90, 0x1C, 0xC5, 0xA1, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x80, 0x65, 0x20, 0xEB, 0x39, 0x7F, 0xFA, 0xA2, 0x4D, 0x96, 0xFF, 0x2F, 0x20, 0x7B, 0x47, 0xD1, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xA2, 0x1C, 0xE6, 0x86, 0x87, 0xD7, 0x65, 0x83, 0xF2, 0x15, 0x11, 0x07, 0x4B, 0x90, 0x56, 0xD4, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x54, 0xF5, 0x65, 0x35, 0x8D, 0xBE, 0xFA, 0xEC, 0x8A, 0xBE, 0x43, 0x88, 0xFB, 0x1D, 0x8A, 0x25, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x5D, 0xE8, 0xF9, 0xE7, 0xF1, 0x1A, 0x96, 0xE6, 0x9A, 0xAD, 0xA9, 0x34, 0x6C, 0x84, 0x61, 0x90, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x1E, 0xFA, 0x4D, 0xAA, 0xA1, 0xA4, 0xBA, 0x9B, 0x04, 0xD8, 0xA1, 0x1E, 0xBD, 0x00, 0x31, 0x9B, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4A, 0x7D, 0x8B, 0xAC, 0x21, 0x74, 0xCF, 0xA2, 0xA0, 0x06, 0xD9, 0x48, 0x59, 0xFE, 0xC5, 0x2B, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xDC, 0x01, 0x88, 0x2C, 0xB9, 0xD4, 0xA3, 0xE8, 0x95, 0x1A, 0x5C, 0xC1, 0xBD, 0x36, 0xEC, 0x74, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xF6, 0x03, 0x33, 0x31, 0xB0, 0x3E, 0x92, 0xA7, 0x27, 0x07, 0x7F, 0x44, 0x8D, 0x4F, 0xB5, 0x60, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x9A, 0x5E, 0x55, 0xAA, 0x75, 0x28, 0x9F, 0x7D, 0xAF, 0x3B, 0xEA, 0xB3, 0x1C, 0xF7, 0xAA, 0x1F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4B, 0x66, 0x98, 0x0F, 0x5F, 0x5F, 0x8A, 0x31, 0xAC, 0xFE, 0x55, 0x58, 0x52, 0x52, 0x24, 0x7F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xCD, 0x78, 0xB9, 0x67, 0x56, 0x38, 0xDB, 0x8E, 0x12, 0x92, 0x91, 0x3A, 0x6F, 0x3E, 0xA5, 0x7C, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x60, 0xD1, 0x97, 0xB1, 0xCF, 0x83, 0xD8, 0x53, 0xC6, 0xAB, 0xE3, 0x50, 0xB7, 0xB1, 0x10, 0x40, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x76, 0x5A, 0xF1, 0xC1, 0x74, 0x0A, 0xF1, 0xE3, 0x18, 0x68, 0x92, 0x37, 0xB3, 0x50, 0xDD, 0x8F, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4F, 0x0C, 0x0A, 0x63, 0x93, 0x9A, 0xDA, 0xBF, 0x39, 0x2D, 0x71, 0x47, 0x1B, 0xF3, 0xF7, 0xA5, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xCA, 0x44, 0x8A, 0x4D, 0xCD, 0xF4, 0x89, 0x6A, 0x34, 0x2B, 0x4B, 0xA9, 0x42, 0x12, 0x81, 0x37, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xF3, 0xFF, 0x44, 0xAE, 0x57, 0xDB, 0x85, 0x00, 0xA7, 0xBF, 0xB6, 0xFD, 0x74, 0x25, 0x0E, 0x63, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x12, 0xD5, 0x4A, 0x35, 0x88, 0xD0, 0x8E, 0x93, 0xBA, 0x62, 0x3E, 0x18, 0x9B, 0x81, 0x7E, 0xEF, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x2B, 0xE6, 0x6D, 0x2A, 0x57, 0x09, 0x7B, 0x14, 0x7A, 0x13, 0x1D, 0x5C, 0x88, 0x43, 0xCC, 0x73, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x43, 0xE6, 0x2B, 0xC0, 0x02, 0xAD, 0x1E, 0x60, 0x29, 0x9B, 0xB7, 0xD2, 0xF0, 0xFF, 0x14, 0xC5, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x1B, 0x3E, 0x41, 0x41, 0x98, 0x52, 0x4A, 0x3D, 0x96, 0x4C, 0xE2, 0xA6, 0x31, 0xB7, 0x2F, 0x71, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x34, 0x2E, 0x17, 0xAF, 0x47, 0x99, 0x2E, 0x6C, 0x27, 0x06, 0x7C, 0xA1, 0x47, 0x11, 0x61, 0x5C  <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_mkdsa44_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_algorithm_t          alg        = PSA_ALG_HASH_ML_DSA(PSA_ALG_SHAKE256);</div><div class="line">    psa_key_handle_t         key_handle = 0;</div><div class="line">    psa_key_attributes_t     attributes = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    <span class="keywordtype">size_t</span>  sign_len;</div><div class="line">    uint8_t sign[PSA_ML_DSA_SIGNATURE_SIZE(PSA_KEY_BITS_ML_DSA_44)];</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Platform initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        <span class="comment">/* PSA Crypto Initialization failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes,</div><div class="line">                            PSA_KEY_USAGE_SIGN_MESSAGE | PSA_KEY_USAGE_VERIFY_MESSAGE | PSA_KEY_USAGE_EXPORT);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_HASH_ML_DSA(PSA_ALG_SHAKE256));</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ML_DSA_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, PSA_KEY_BITS_ML_DSA_44);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_generate_key(&amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key generation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_message(key_handle, alg, mldsa_test_message, <span class="keyword">sizeof</span>(mldsa_test_message), sign, <span class="keyword">sizeof</span>(sign),</div><div class="line">                         &amp;sign_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key encapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_message(key_handle, alg, mldsa_test_message, <span class="keyword">sizeof</span>(mldsa_test_message), sign, sign_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key decapsulation failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/* The 32-byte seed value */</span></div><div class="line">uint8_t mldsa_import_keypair[PSA_KEY_EXPORT_ML_DSA_KEY_PAIR_MAX_SIZE] =</div><div class="line">{</div><div class="line">    0x4B, 0xE7, 0xA0, 0x1A, 0x99, 0xA5, 0xE5, 0xBC, 0xFE, 0x3C, 0x06, 0x78, 0x5D, 0x8E, 0x4E, 0xC6, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x64, 0x08, 0x22, 0x27, 0xD8, 0x67, 0x04, 0xE9, 0xE4, 0x48, 0x62, 0x62, 0x3A, 0x05, 0xC8, 0xB3, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_mldsa44_keypair_import_export_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    psa_key_id_t         key_handle = 0;</div><div class="line">    psa_key_attributes_t attributes = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    uint8_t              sign[PSA_ML_DSA_SIGNATURE_SIZE(PSA_KEY_BITS_ML_DSA_44)] __ALIGNED(4);</div><div class="line">    <span class="keywordtype">size_t</span>               sign_len;</div><div class="line">    uint8_t              public_key[PSA_KEY_GEN_ML_DSA_PUB_KEY_SIZE(PSA_KEY_BITS_ML_DSA_44)];</div><div class="line">    <span class="keywordtype">size_t</span>               public_key_len = 0;</div><div class="line">    psa_algorithm_t      alg            = PSA_ALG_HASH_ML_DSA(PSA_ALG_SHAKE256);</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_MESSAGE | PSA_KEY_USAGE_VERIFY_MESSAGE);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, alg);</div><div class="line">    psa_set_key_lifetime(&amp;attributes, PSA_KEY_LIFETIME_VOLATILE);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ML_DSA_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, PSA_KEY_BITS_ML_DSA_44);</div><div class="line"></div><div class="line">    <span class="comment">/* Import key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_import_key(&amp;attributes, &amp;mldsa_import_keypair[0],</div><div class="line">                       PSA_KEY_GEN_ML_DSA_KEY_PAIR_MAX_SIZE(PSA_KEY_BITS_ML_DSA_44), &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key import failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign the message */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_message(key_handle, alg, mldsa_test_message, <span class="keyword">sizeof</span>(mldsa_test_message), sign, <span class="keyword">sizeof</span>(sign),</div><div class="line">                         &amp;sign_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Sign message failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_message(key_handle, alg, mldsa_test_message, <span class="keyword">sizeof</span>(mldsa_test_message), sign, sign_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Verify message failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Export public key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_export_public_key(key_handle, &amp;public_key[0], PSA_KEY_GEN_ML_DSA_PUB_KEY_SIZE(PSA_KEY_BITS_ML_DSA_44),</div><div class="line">                              &amp;public_key_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Public key export failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy key pair */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key destroy failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Import public key */</span></div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_ML_DSA_PUBLIC_KEY);</div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_import_key(&amp;attributes, &amp;public_key[0], public_key_len, &amp;key_handle))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Key import failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify signature */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_message(key_handle, alg, mldsa_test_message, <span class="keyword">sizeof</span>(mldsa_test_message), sign, sign_len))</div><div class="line">    {</div><div class="line">        <span class="comment">/* Verify message failed */</span></div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2>Migrating to MbedTLS 3.6.0</h2>
<p>MBEDTLS_PSA_ASSUME_EXCLUSIVE_BUFFERS macro is disabled by default to handle shared memory in a secure manner. Note that this increases heap memory usage and code size. The macro can be enabled if all buffers passed to any PSA function reside in memory that is accessible only to the PSA function during its execution or if it possible otherwise for the user to conclude that the user buffers passed into PSA are secure from modification. Refer to <a href="https://github.com/Mbed-TLS/mbedtls-docs/blob/main/security-advisories/mbedtls-security-advisory-2024-03.md">https://github.com/Mbed-TLS/mbedtls-docs/blob/main/security-advisories/mbedtls-security-advisory-2024-03.md</a> for more details.</p>
<p>psa_import_key() now only accepts RSA keys in the PSA standard formats. Applications that need other formats like: PKCS#8, SubjectPublicKey, PEM can call mbedtls_pk_parse_{public,}key() followed by mbedtls_pk_import_into_psa().</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">/* Generated using &quot;openssl genrsa -out example_private_key.pem 2048&quot; */</span></div><div class="line"><span class="keyword">const</span> uint8_t RSAKeydata[] = <span class="stringliteral">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;MIIEowIBAAKCAQEAplaPU68h4hW/eAlH2hbQl1WjoDT1znCk0O9cnE9lAnB26IUi&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;78wUAxuTZSlrlKez9FGGIVbUMTy7dTw0ZBanogrKCaAMaRFz5LRv4I8RQzsDxxqe&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;nud9Y6mVRWb9hyutL/yBwDd6jzAwcviAhcatTv0E5wpEJ6ezMDyaiSCbn84hfb0T&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;ZPXQVGhmjii3f0FfFWW9ce70qkuwdkvO6HBrOGVi2++b11As+Uh/7pxyOb7wpE7K&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;X64nohaCtXgNnV8Hr+LOPQRHEbGTCPOfx1davKEIYFvm8hVxqv20csMD5uc8AJCd&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;0cdom13KcOpVXCnrFPNJt0lITOcH/fBzp4xoaQIDAQABAoIBAGc56qKVWeKzempk&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;4AlRBUwVYoEGvNDLiQz8rq12fAoCf1iXXvIP5Q90qokqJlBPrtbdTO8dsnuH5BHC&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;NgUzJf7i0TUd9PWzVgfFjnR+dMkTM6n5NB0LLf6OfEtguc+L5GOWQXNnOpDn5/lB&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;jIj4ng8Z6FP1RAyT/xjdU03sRYfq5OPlDZ8+ck7WwQ8VxSBKsJcZVv+K4r64Vmr1&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;MO1zfBYuwafi4oO9Z9x89Iil9GBcYuCvhLvDoWhnTUxlOTfz+Jt+qwlmVimEz6xs&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;6ew1Ox7e6SInly3IAXe9E84yP9MDmiGkCrVr8s8GUybZ5t/yeZ3g5lPYSQ/FiuHY&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;kvJCH4ECgYEA2IthRDkElOQGqJ9T/LjgcIVLQs0F6i7zZWg6UKv18EmG7uHd6tsZ&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;byFfFiBat80rq6q4AUx2OOE7+LI5MxIvgRgLk14WV8H2OKK/lfxOFb6a4feGM7bH&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;VdERQSMNeGq0bP9IOPxU1EvFp0Vfv7cfGsQhcAPgA8up61jWREhI+fECgYEAxKVT&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;9pKinIwgjsHgmxalaNbnRf+bcqtdS98SB2MuICg8ubcBSrjm4wtGe3oCX/PbM1GV&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;FvEDKl4TyeWFIH4MStsyDHYxwoV2C01bBHEtHTYBnjeIShMruIomsG9GeTrNmyzg&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;dVdSg5/lxYOxuZSXvfcbyIMsW29ddgeICu9RHfkCgYBaljQibhfUkW+Xqs9fsZdy&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;etB5KXuH9AwuJ+P9S3KfCqM/240SaoXBT5yPjQlmSpYyQkCnim0Kbm7AIw56pujo&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;gD6Xb4y5OZLfLnYnMF0aC5qPXRTvHU9WPxeQwDEqZrkDv+der3BtPyV4TDU55klE&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;0TeLvJNCAzkaExfPiM2+gQKBgQC5ceBYq7hGQa+CcTvLhfO/hsrbrE2AOjLllhx+&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;cv3QvaFm0jqZqP20J7H0R/9tVZ7mKo2a8Pa3QbkPsS92kOguv7/XGK+cbhgAWJb4&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;/XI6FfA4sM4KbUHR6hbKVGX1dYroR831WsAp+OTK+4LjLEpdj2fYFDwEjmVpJXka&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;Ns4coQKBgGESrtpJF7OQG4xcXwR2ZiJESPvMKVmtvxRzDrc9gmoiIIIKx1fimwCv&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;RtOz1bQcXMRw21+ZAZpen3ahWh63KC0KxMSNBJTXdczlf2uprVkSPtmAjV4qBgwv&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;tqjmP0lnGc9wkJsVvGmMAAfQOWgxs9h/VH/b+6biEkzaaZLOyABV&quot;</span></div><div class="line">                             <span class="stringliteral">&quot;-----END RSA PRIVATE KEY-----\n&quot;</span>;</div><div class="line"></div><div class="line"><span class="comment">/* Expected signature below is calculated using the mbedCrypto software version */</span></div><div class="line"><span class="keyword">const</span> uint8_t RSAExpectedSignature[256] =</div><div class="line">{</div><div class="line">    0x25, 0xC0, 0x15, 0x64, 0xD3, 0xF7, 0xC1, 0xB7, 0xA8, 0x9B, 0x56, 0x1C, 0xB5, 0xA4, 0xA5, 0x0D, 0x61, 0x52, 0x32,</div><div class="line">    0x0C, 0x4E, 0xE8, 0xCA, 0x4B, 0x9E, 0xA2, 0x4D, 0x35, 0x0E, 0xB1, 0xA1, 0x5B, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x5B, 0xD8, 0xC1, 0x93, 0x28, 0x60, 0x90, 0x18, 0x37, 0x88, 0x66, 0xD4, 0xED, 0x37, 0x6B, 0xEC, 0x48, 0xFF, 0x3D,</div><div class="line">    0xFB, 0x99, 0xB7, 0xEF, 0x3C, 0x8D, 0x25, 0xE9, 0xF3, 0xCF, 0x02, 0x7C, 0x7D, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xB9, 0x4D, 0x2F, 0x2F, 0x1E, 0x30, 0x48, 0x54, 0x18, 0xE4, 0x51, 0xD5, 0xC1, 0xB7, 0x3B, 0x0D, 0xE4, 0xB4, 0x19,</div><div class="line">    0x7B, 0x9B, 0xF4, 0x35, 0x82, 0xCC, 0x91, 0x4C, 0x10, 0xE9, 0xB6, 0xF1, 0x0A, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x23, 0xEB, 0x7D, 0x51, 0x47, 0x36, 0xFE, 0x13, 0xAF, 0x3C, 0x23, 0x9F, 0x7E, 0xFC, 0xCF, 0x7A, 0x7C, 0x2D, 0xDB,</div><div class="line">    0xD9, 0xDA, 0xEB, 0xF7, 0xB5, 0x6B, 0x8D, 0xE0, 0x18, 0x9A, 0x5B, 0xB7, 0x0A, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0xA3, 0x4E, 0xE1, 0xB7, 0xF7, 0xD1, 0x94, 0xD5, 0x7A, 0xD3, 0x27, 0xE2, 0x1F, 0x3A, 0xEB, 0xF0, 0x83, 0x10, 0x52,</div><div class="line">    0x51, 0x5F, 0x58, 0xF8, 0x81, 0x42, 0x48, 0x83, 0x2D, 0xF0, 0xA9, 0x7D, 0x79, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x2B, 0xF1, 0x68, 0xC2, 0x22, 0xC0, 0x0C, 0x72, 0x63, 0x37, 0xBF, 0xEC, 0x72, 0x97, 0xD4, 0xA5, 0x91, 0x2E, 0x1F,</div><div class="line">    0xA3, 0x78, 0x9A, 0xCE, 0xFE, 0x27, 0x7F, 0x2B, 0x85, 0x7D, 0x22, 0x2C, 0x0D, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x1E, 0x10, 0xB7, 0xFF, 0x9A, 0xA7, 0x99, 0xD2, 0xB9, 0x40, 0x53, 0xB3, 0xA9, 0x52, 0x5D, 0xBD, 0xC8, 0x12, 0x8D,</div><div class="line">    0x39, 0xD7, 0x97, 0x03, 0xD2, 0x80, 0x21, 0xC3, 0xA7, 0x8B, 0xE3, 0x3D, 0xF0, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">    0x4D, 0x4C, 0x4D, 0xC4, 0xC7, 0xE5, 0xE4, 0x35, 0x75, 0xAA, 0x45, 0x3B, 0x9C, 0x64, 0xC1, 0x94, 0x6E, 0x15, 0x0A,</div><div class="line">    0xE8, 0x84, 0xCD, 0xFC, 0x7A, 0xBC, 0x5C, 0x8C, 0xA8, 0x95, 0x07, 0x79, 0x4E, <span class="comment">// NOLINT(readability-magic-numbers)</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> psa_rsa2048_pem_format_import_example (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line"><span class="comment">/* This example imports an RSA2048 keypair of PEM format, performs signing and verification operations. */</span></div><div class="line"></div><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx        = {0};</div><div class="line">    psa_key_handle_t         key_handle = {0};</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            payload[]  = <span class="stringliteral">&quot;ASYMMETRIC_INPUT_FOR_SIGN&quot;</span>;</div><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>            signature[PSA_SIGNATURE_MAX_SIZE] = {0};</div><div class="line">    <span class="keywordtype">size_t</span>               signature_length = 0U;</div><div class="line">    psa_key_attributes_t attributes       = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line">    psa_key_attributes_t read_attributes  = PSA_KEY_ATTRIBUTES_INIT;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_crypto_init())</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Set key attributes */</span></div><div class="line">    psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_HASH | PSA_KEY_USAGE_VERIFY_HASH);</div><div class="line">    psa_set_key_algorithm(&amp;attributes, PSA_ALG_RSA_PKCS1V15_SIGN_RAW);</div><div class="line">    psa_set_key_type(&amp;attributes, PSA_KEY_TYPE_RSA_KEY_PAIR);</div><div class="line">    psa_set_key_bits(&amp;attributes, RSA_2048_BIT_LENGTH);</div><div class="line"></div><div class="line">    <span class="comment">/* Import the private key (This includes both the private and public key) */</span></div><div class="line">    mbedtls_pk_context ctx_rsa;</div><div class="line">    mbedtls_pk_init(&amp;ctx_rsa);</div><div class="line"></div><div class="line">    <span class="comment">/* For keys other than ASN format, mbedtls_pk_parse_key and mbedtls_pk_import_into_psa APIs must be called instead of psa_import_key */</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        mbedtls_pk_parse_key(&amp;ctx_rsa, RSAKeydata, <span class="keyword">sizeof</span>(RSAKeydata), NULL, 0, mbedtls_psa_get_random,</div><div class="line">                             MBEDTLS_PSA_RANDOM_STATE))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != mbedtls_pk_import_into_psa(&amp;ctx_rsa, &amp;attributes, &amp;key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    mbedtls_pk_free(&amp;ctx_rsa);</div><div class="line"></div><div class="line">    <span class="comment">/* Test the key information */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_get_key_attributes(key_handle, &amp;read_attributes))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Sign message using the key */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_sign_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), signature, <span class="keyword">sizeof</span>(signature),</div><div class="line">                      &amp;signature_length))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(signature, &amp;RSAExpectedSignature, <span class="keyword">sizeof</span>(RSAExpectedSignature)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS !=</div><div class="line">        psa_verify_hash(key_handle, PSA_ALG_RSA_PKCS1V15_SIGN_RAW, payload, <span class="keyword">sizeof</span>(payload), RSAExpectedSignature,</div><div class="line">                        <span class="keyword">sizeof</span>(RSAExpectedSignature)))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Destroy the key and handle */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != psa_destroy_key(key_handle))</div><div class="line">    {</div><div class="line">        debugger_break();</div><div class="line">    }</div><div class="line"></div><div class="line">    mbedtls_psa_crypto_free();</div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2 class="groupheader">Function Documentation</h2>
<a id="gaf0f37c11be234650bec95ce37e9a4a6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf0f37c11be234650bec95ce37e9a4a6b">&#9670;&nbsp;</a></span>mbedtls_platform_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_platform_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function initializes the SCE and the TRNG. It <b>must</b> be invoked before the crypto library can be used. This implementation is used if MBEDTLS_PLATFORM_SETUP_TEARDOWN_ALT is defined.</p>
<p>Example: </p><div class="fragment"><div class="line">    <a class="code" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> ctx = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Setup the platform; initialize the SCE and the TRNG */</span></div><div class="line">    <span class="keywordflow">if</span> (PSA_SUCCESS != <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup</a>(&amp;ctx))</div></div><!-- fragment --> <dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Initialization was successful. </td></tr>
    <tr><td class="paramname">MBEDTLS_ERR_PLATFORM_HW_ACCEL_FAILED</td><td>SCE Initialization error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga264d5dd442e32a262d331f8889a0997c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga264d5dd442e32a262d331f8889a0997c">&#9670;&nbsp;</a></span>mbedtls_platform_teardown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_platform_teardown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__platform__context.html">mbedtls_platform_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This implementation is used if MBEDTLS_PLATFORM_SETUP_TEARDOWN_ALT is defined. It is intended to de-initialize any items that were initialized in the <a class="el" href="group___r_m___p_s_a___c_r_y_p_t_o.html#gaf0f37c11be234650bec95ce37e9a4a6b">mbedtls_platform_setup()</a> function, but currently is only a placeholder function.</p>
<p>Example: </p><div class="fragment"><div class="line"></div><div class="line">    <span class="comment">/* De-initialize the platform. This is currently a placeholder function which does not do anything. */</span></div><div class="line">    <a class="code" href="group___r_m___p_s_a___c_r_y_p_t_o.html#ga264d5dd442e32a262d331f8889a0997c">mbedtls_platform_teardown</a>(&amp;ctx);</div><div class="line"></div></div><!-- fragment --> <dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">N/A</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3783884f7c0fbb23f8195d005f7e4494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3783884f7c0fbb23f8195d005f7e4494">&#9670;&nbsp;</a></span>RM_PSA_CRYPTO_TRNG_Read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> RM_PSA_CRYPTO_TRNG_Read </td>
          <td>(</td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_rngbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_req_bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>p_num_gen_bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads requested length of random data from the TRNG. Generate <code>nbytes</code> of random bytes and store them in <code>p_rngbuf</code> buffer. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FSP_SUCCESS</td><td>Random number generation successful </td></tr>
    <tr><td class="paramname">FSP_ERR_ASSERTION</td><td>NULL input parameter(s). </td></tr>
    <tr><td class="paramname">FSP_ERR_CRYPTO_UNKNOWN</td><td>An unknown error occurred. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>See <a class="el" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html">Common Error Codes</a> or functions called by this function for other possible return codes. This function calls:<ul>
<li>s_generate_16byte_random_data </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v6.2.0 User's Manual Copyright © (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
