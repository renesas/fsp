<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Secure Crypto Engine (r_sce_protected_cavp)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show();
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
     });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v6.3.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">

    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text">
      </span>
      <span class="right">
          &nbsp;
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___s_c_e___p_r_o_t_e_c_t_e_d___c_a_v_p.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body.
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len));
            }
          }
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element.
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Secure Crypto Engine (r_sce_protected_cavp)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> &raquo; <a class="el" href="group___r_e_n_e_s_a_s___s_e_c_u_r_i_t_y___m_o_d_u_l_e_s.html">Security</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>Driver for the CAVP Certified Secure Crypto Engine (SCE) on RA MCUs. </p>
<h1><a class="anchor" id="r-sce-protected-cavp-version"></a>
Version</h1>
<p>v1.1.0</p>
<p>The version that appears on the Components tab of the FSP Configuration editor is v1.1.0+fsp.&lt;fsp_version&gt;. The &lt;fsp_version&gt; metadata reflects tooling support files only and does not indicate any changes to the CAVP certified code. See <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html#module-versioning">Module Versioning</a> for more information about component versioning in FSP.</p>
<h1><a class="anchor" id="r-sce-protected-cavp-functions"></a>
Functions</h1>
<p>The specifications of this module comply with the Secure Crypto Engine (r_sce_protected) of FSP v5.5.0.<br />
For more information about the features of this module, see the "Renesas Flexible Software Package (FSP) v5.5.0 User's Manual." The documentation can be obtained from the following link:<br />
</p><dl class="section see"><dt>See also</dt><dd><a href="https://www.renesas.com/en/software-tool/flexible-software-package-fsp">https://www.renesas.com/en/software-tool/flexible-software-package-fsp</a></dd></dl>
<h1><a class="anchor" id="r-sce-protected-cavp-overview"></a>
Overview</h1>
<p>This module provides SCE CAVP Certified functions.</p>
<h2>HW Overview</h2>
<p>SCE9 Protected Mode CAVP certification has been obtained using the RA6M4 as the target processor. </p><table class="doxtable">
<tr>
<th>Crypto Peripheral version </th><th>Devices  </th></tr>
<tr>
<td>SCE9 (Protected mode) </td><td>RA4M2, RA4M3, RA6M4, RA6M5 </td></tr>
</table>
<h2><a class="anchor" id="r-sce-protected-cavp-features"></a>
Features</h2>
<p>The SCE module supports for the following features.</p>
<ul>
<li>Cryptography<ul>
<li>Symmetric Encryption/Decryption<ul>
<li>AES<ul>
<li>ECB 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_ecb"></a></li>
<li>CBC 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_cbc"></a></li>
<li>GCM 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_gcm"></a></li>
<li>CCM 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_ccm"></a></li>
</ul>
</li>
</ul>
</li>
<li>Asymmetric Encryption/Decryption<ul>
<li>RSA<ul>
<li>RSAES-PKCS1-V1_5 1024/2048bit<a class="anchor" id="um_sce_protected_cavp_rsa_rsaes_pkcs"></a></li>
<li>RSAES-PKCS1-V1_5 3072/4096bit (Encryption only)</li>
<li>RSASSA-PKCS1-V1_5 1024/2048bit<a class="anchor" id="um_sce_protected_cavp_rsa_rsassa_pkcs"></a></li>
<li>RSASSA-PKCS1-V1_5 3072/4096bit (Verification only)</li>
</ul>
</li>
<li>ECC<ul>
<li>ECDSA secp192r1/secp224r1/secp256r1/secp384r1<a class="anchor" id="um_sce_protected_cavp_ecc_ecdsa"></a></li>
<li>ECDH secp256r1<a class="anchor" id="um_sce_protected_cavp_ecc_ecdh"></a></li>
</ul>
</li>
</ul>
</li>
<li>Hash Functions<ul>
<li>SHA-2<ul>
<li>SHA-256<a class="anchor" id="um_sce_protected_cavp_sha"></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Message Authentication Code<ul>
<li>HMAC-SHA256bit<a class="anchor" id="um_sce_protected_cavp_sha_hmac"></a></li>
<li>AES-CMAC 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_cmac"></a></li>
</ul>
</li>
<li>Key Support<ul>
<li>AES 128/256bit</li>
<li>AES Key Wrap/Key Unwrap 128/256bit<a class="anchor" id="um_sce_protected_cavp_aes_rfc3394"></a></li>
<li>RSA 1024/2048bit</li>
<li>RSA 3072/4096bit (public key only)</li>
<li>ECC secp192r1/secp224r1/secp256r1/secp384r1</li>
<li>HMAC-SHA256bit</li>
</ul>
</li>
<li>TRNG</li>
<li>TLS<ul>
<li>SSL / TLS support function (TLS1.2 compliant)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="r-sce-protected-cavp-configuration"></a>
Configuration</h1>
<h2><a class="anchor" id="r-sce-protected-cavp-clock-configuration"></a>
Clock Configuration</h2>
<p>This module does not require a specific clock configuration.</p>
<h2><a class="anchor" id="r-sce-protected-cavp-pin-configuration"></a>
Pin Configuration</h2>
<p>This module does not use I/O pins.</p>
<h1><a class="anchor" id="r-sce-protected-cavp-usage_notes"></a>
Usage Notes</h1>
<h2>Getting Started: Creating a SCE Protected Mode Project</h2>
<p>Start by creating a new project in e&sup2; studio or RASC. On the Stacks tab, add New &gt; Security &gt; SCE Protected Mode(CAVP Certified). For information on how to install and update secure keys, refer to the Application Note R11AN0496.</p>
<h2>Reducing intialization time</h2>
<p>The SCE intialization sequence can be modified to support a smaller subset of features and allow for a shorter intialization period. This is particularly useful in cases where startup time is important and the cryptographic features that are required are known in advance. The current fast boot configuration option supports the cryptographic primitives required by MCUBoot including:</p>
<ul>
<li>RSA 3K/4K signature verification</li>
<li>ECC P256 signature verification</li>
<li>SHA224/256 and GHASH calcuation</li>
</ul>
<h2><a class="anchor" id="r-sce-protected-cavp-limitations"></a>
Limitations</h2>
<h2><a class="anchor" id="r-sce-protected-cavp-ecdsa-secp384r1"></a>
Usage of R_SCE_ECDSA_secp384r1_SignatureGenerate/Verify</h2>
<p>The SCE does not support SHA-384 in hardware, so the APIs listed below require the user to create a SHA-384 function for signature generation and verification. To use the APIs listed below, enable SCE_USER_SHA_384_ENABLED on RA Smart Configurator and prepare a function called SCE_USER_SHA_384_FUNCTION. The interface of SCE_USER_SHA_384_FUNCTION, which is called by the following APIs, is described below.</p>
<ul>
<li>R_SCE_ECDSA_secp384r1_SignatureGenerate()</li>
<li>R_SCE_ECDSA_secp384r1_SignatureVerify()</li>
</ul>
<h3><a class="anchor" id="r-sce-protected-cavp-user-sha384"></a>
SCE_USER_SHA_384_FUNCTION()</h3>
<div class="fragment"><div class="line">uint32_t SCE_USER_SHA_384_FUNCTION(uint8_t * message, uint8_t * digest, uint32_t message_length)</div></div><!-- fragment --><p> SHA-384 hash calculation is performed for an area extending the number of bytes specified by the argument message_length from the address specified by the argument message. The calculation result should be stored at the address specified by the argument digest. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] Start address of message </td></tr>
    <tr><td class="paramname">digest</td><td>[in,out] address for storing hash calculation result (48 bytes) </td></tr>
    <tr><td class="paramname">message_length</td><td>[in] Effective byte count of message </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Hash value stored successfully. </td></tr>
    <tr><td class="paramname">others</td><td>Storing of hash value failed.</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="r-sce-protected-cavp-examples"></a>
Examples</h1>
<h2><a class="anchor" id="r-sce-protected-cavp-examples-aes"></a>
AES Example</h2>
<p>This is an example of AES-256 encryption and decryption.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keyword">static</span> uint8_t plain[BLOCK * 2] =</div><div class="line">{</div><div class="line">    0x52, 0x65, 0x6e, 0x65, 0x73, 0x61, 0x73, 0x20, 0x45, 0x6c, 0x65, 0x63, 0x74, 0x72, 0x6f, 0x6e,</div><div class="line">    0x69, 0x63, 0x73, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x00</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_sce_example_aes ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__aes__handle__t">sce_aes_handle_t</a>      handle;</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__aes__wrapped__key__t">sce_aes_wrapped_key_t</a> wrapped_key;</div><div class="line">    uint8_t               cipher_calculated[32] = {0};</div><div class="line">    uint8_t               plain_calculated[32]  = {0};</div><div class="line">    uint32_t              dummy;</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power on */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gae41c48db65491a6884039929b6734557">R_SCE_Open</a>(&amp;sce_ctrl, &amp;sce_cfg);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a random key */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga86fd7ad53a0726704a77076fceca99a8">R_SCE_AES256_WrappedKeyGenerate</a>(&amp;wrapped_key);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plain text */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga53552c43038b3a2a520d7b61ef338a43">R_SCE_AES256ECB_EncryptInit</a>(&amp;handle, &amp;wrapped_key);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga8001d3425d9403d8c544e25c2fdccec3">R_SCE_AES256ECB_EncryptUpdate</a>(&amp;handle, plain, cipher_calculated, BLOCK * 2);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga4a87b2b932b7363a5ca5178e696c3a2e">R_SCE_AES256ECB_EncryptFinal</a>(&amp;handle, cipher_calculated, &amp;dummy);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a cipher text using same key as Encryption */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga9b059c071bb0155eae66efae07d07880">R_SCE_AES256ECB_DecryptInit</a>(&amp;handle, &amp;wrapped_key);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga8f7f119ce740c426e84d8a7892134d20">R_SCE_AES256ECB_DecryptUpdate</a>(&amp;handle, cipher_calculated, plain_calculated, BLOCK * 2);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gaa130e8167e75b10f42e8f25f6fca573e">R_SCE_AES256ECB_DecryptFinal</a>(&amp;handle, plain_calculated, &amp;dummy);</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power off */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga633b4dec690ed17a15556201b746a652">R_SCE_Close</a>(&amp;sce_ctrl);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare plain and plain_calculated */</span></div><div class="line">    <span class="keywordflow">if</span> (memcmp(plain, plain_calculated, BLOCK * 2))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* plain and plain_calculated are different (incorrect) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* plain and plain_calculated are the same (correct) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-sce-protected-cavp-examples-ecc"></a>
ECC Example</h2>
<p>This is an example of ECC secp-256 signature generate and verify.</p>
<div class="fragment"><div class="line">uint8_t ecc256_data_msg[] =</div><div class="line">{</div><div class="line">    <span class="charliteral">&#39;s&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;m&#39;</span>, <span class="charliteral">&#39;p&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;e&#39;</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_sce_example_ecc ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__ecc__wrapped__pair__key__t">sce_ecc_wrapped_pair_key_t</a> wrapped_pair_key;</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__byte__data__t">sce_ecdsa_byte_data_t</a>      message_hash =</div><div class="line">    {</div><div class="line">        0</div><div class="line">    };</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__byte__data__t">sce_ecdsa_byte_data_t</a> signature;</div><div class="line">    uint8_t               out_data[HW_SCE_ECDSA_DATA_BYTE_SIZE];</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>             return_code;</div><div class="line"></div><div class="line">    message_hash.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0a826455f9e93c277a66a4cb56f36e90">data_length</a> = <span class="keyword">sizeof</span>(ecc256_data_msg);</div><div class="line">    message_hash.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>       = (uint8_t *) ecc256_data_msg;</div><div class="line">    signature.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>          = out_data;</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power on */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gae41c48db65491a6884039929b6734557">R_SCE_Open</a>(&amp;sce_ctrl, &amp;sce_cfg);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a random pair key */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga64c128e77e8ed5de25657da052e57788">R_SCE_ECC_secp256r1_WrappedKeyPairGenerate</a>(&amp;wrapped_pair_key);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a Signature */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga670f2fe3afb0b0392a3f8dccab71379a">R_SCE_ECDSA_secp256r1_SignatureGenerate</a>(&amp;message_hash, &amp;signature, &amp;wrapped_pair_key.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0d6e19b7e0fbf5cefec3514d4608472f">priv_key</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Verify Signature and Public wrapped key */</span></div><div class="line">    return_code = <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga199c50da1b50db60f224ba4c2c27430c">R_SCE_ECDSA_secp256r1_SignatureVerify</a>(&amp;signature, &amp;message_hash, &amp;wrapped_pair_key.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a65f7b65b8beed037fa6f1feb6464d515">pub_key</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power off */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga633b4dec690ed17a15556201b746a652">R_SCE_Close</a>(&amp;sce_ctrl);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (FSP_SUCCESS != return_code)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* Verify Fail */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* Verify Success */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-sce-protected-cavp-examples-rsa"></a>
RSA Example</h2>
<p>This is an example of RSA-2048 encryption and decryption.</p>
<div class="fragment"><div class="line">uint8_t rsa_msg[256] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div><div class="line">    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,</div><div class="line">    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f,</div><div class="line">    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3b, 0x3c, 0x3d, 0x3e, 0x3f,</div><div class="line">    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4a, 0x4b, 0x4c, 0x4d, 0x4e, 0x4f,</div><div class="line">    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5a, 0x5b, 0x5c, 0x5d, 0x5e, 0x5f,</div><div class="line">    0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f,</div><div class="line">    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x7b, 0x7c, 0x7d, 0x7e, 0x7f,</div><div class="line">    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8a, 0x8b, 0x8c, 0x8d, 0x8e, 0x8f,</div><div class="line">    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, 0x98, 0x99, 0x9a, 0x9b, 0x9c, 0x9d, 0x9e, 0x9f,</div><div class="line">    0xa0, 0xa1, 0xa2, 0xa3, 0xa4, 0xa5, 0xa6, 0xa7, 0xa8, 0xa9, 0xaa, 0xab, 0xac, 0xad, 0xae, 0xaf,</div><div class="line">    0xb0, 0xb1, 0xb2, 0xb3, 0xb4, 0xb5, 0xb6, 0xb7, 0xb8, 0xb9, 0xba, 0xbb, 0xbc, 0xbd, 0xbe, 0xbf,</div><div class="line">    0xc0, 0xc1, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7, 0xc8, 0xc9, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xcf,</div><div class="line">    0xd0, 0xd1, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7, 0xd8, 0xd9, 0xda, 0xdb, 0xdc, 0xdd, 0xde, 0xdf,</div><div class="line">    0xe0, 0xe1, 0xe2, 0xe3, 0xe4, 0xe5, 0xe6, 0xe7, 0xe8, 0xe9, 0xea, 0xeb, 0xec, 0xed, 0xee, 0xef,</div><div class="line">    0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_sce_example_rsa () {</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__rsa2048__wrapped__pair__key__t">sce_rsa2048_wrapped_pair_key_t</a> wrapped_pair_key;</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__byte__data__t">sce_rsa_byte_data_t</a>            plain;</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__byte__data__t">sce_rsa_byte_data_t</a>            plain_dec;</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__byte__data__t">sce_rsa_byte_data_t</a>            cipher;</div><div class="line"></div><div class="line">    uint8_t enc_cipher[HW_SCE_RSA_2048_DATA_BYTE_SIZE];</div><div class="line">    uint8_t dec_plain[HW_SCE_RSA_2048_DATA_BYTE_SIZE];</div><div class="line"></div><div class="line">    plain.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0a826455f9e93c277a66a4cb56f36e90">data_length</a>     = <span class="keyword">sizeof</span>(rsa_msg) - PADDING_MINIMUM_BYTE_SIZE;</div><div class="line">    plain.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>           = (uint8_t *) rsa_msg;</div><div class="line">    plain_dec.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0a826455f9e93c277a66a4cb56f36e90">data_length</a> = <span class="keyword">sizeof</span>(dec_plain);</div><div class="line">    plain_dec.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>       = dec_plain;</div><div class="line">    cipher.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0a826455f9e93c277a66a4cb56f36e90">data_length</a>    = <span class="keyword">sizeof</span>(enc_cipher);</div><div class="line">    cipher.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>          = enc_cipher;</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power on */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gae41c48db65491a6884039929b6734557">R_SCE_Open</a>(&amp;sce_ctrl, &amp;sce_cfg);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a random key */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga67bd2c40cd9ae1f4c66e2891aa104a58">R_SCE_RSA2048_WrappedKeyPairGenerate</a>(&amp;wrapped_pair_key);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plain data */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga681ac993c84c05de3df6c30a3c02f1bc">R_SCE_RSAES_PKCS2048_Encrypt</a>(&amp;plain, &amp;cipher, &amp;wrapped_pair_key.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a47309d37ab0683cb9303cff246272917">pub_key</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a plain data */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga086c4e23ac239c29f825cb17fca0a9f7">R_SCE_RSAES_PKCS2048_Decrypt</a>(&amp;cipher, &amp;plain_dec, &amp;wrapped_pair_key.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a2a0fd14433a3fe0267dccbf840f64b60">priv_key</a>);</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power off */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga633b4dec690ed17a15556201b746a652">R_SCE_Close</a>(&amp;sce_ctrl);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare plain_dec and plain */</span></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(plain_dec.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>, plain.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#ae978efab01e01b8fda8166c3a5241a3d">pdata</a>, plain_dec.<a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#a0a826455f9e93c277a66a4cb56f36e90">data_length</a>))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* plain_dec and plain are different (incorrect) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* plain_dec and plain are the same (correct) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-sce-protected-cavp-examples-hash"></a>
HASH Example</h2>
<p>This is an example of calculating the SHA256 hash.</p>
<div class="fragment"><div class="line">uint8_t message[] =</div><div class="line">{</div><div class="line">    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div><div class="line">    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,</div><div class="line">};</div><div class="line"></div><div class="line">uint8_t hash[] =</div><div class="line">{</div><div class="line">    0x63, 0x0d, 0xcd, 0x29, 0x66, 0xc4, 0x33, 0x66, 0x91, 0x12, 0x54, 0x48, 0xbb, 0xb2, 0x5b, 0x4f,</div><div class="line">    0xf4, 0x12, 0xa4, 0x9c, 0x73, 0x2d, 0xb2, 0xc8, 0xab, 0xc1, 0xb8, 0x58, 0x1b, 0xd7, 0x10, 0xdd</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_sce_example_hash ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d___a_p_i.html#structsce__sha__md5__handle__t">sce_sha_md5_handle_t</a> handle;</div><div class="line">    uint8_t              digest[HW_SCE_SHA256_HASH_LENGTH_BYTE_SIZE] = {0};</div><div class="line">    uint32_t             digest_length = 0;</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power on */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gae41c48db65491a6884039929b6734557">R_SCE_Open</a>(&amp;sce_ctrl, &amp;sce_cfg);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a message text */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga6c29336d0f2461f4aed8c2ed7380f08b">R_SCE_SHA256_Init</a>(&amp;handle);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga78f4c36e6a2c6690b2de417f7c699a46">R_SCE_SHA256_Update</a>(&amp;handle, &amp;message, HW_SCE_SHA256_HASH_LENGTH_BYTE_SIZE);</div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#gaa966b4971aeadafe887261209124b5fe">R_SCE_SHA256_Final</a>(&amp;handle, &amp;digest, &amp;digest_length);</div><div class="line"></div><div class="line">    <span class="comment">/* SCE power off */</span></div><div class="line">    <a class="code" href="group___s_c_e___p_r_o_t_e_c_t_e_d.html#ga633b4dec690ed17a15556201b746a652">R_SCE_Close</a>(&amp;sce_ctrl);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare digest and hash */</span></div><div class="line">    <span class="keywordflow">if</span> (0 != memcmp(digest, hash, digest_length))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* digest and hash are different (incorrect) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">while</span> (1)</div><div class="line">        {</div><div class="line">            <span class="comment">/* digest and hash are the same (correct) */</span></div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v6.3.0 User's Manual Copyright Â© (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
