<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: Renesas Secure IP (r_rsip_e51a_protected_cavp)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/javascript" src="search/lunr.js"></script>
    <link href="search/lunrsearch.css" rel="stylesheet" type="text/css">
    <script src="search/lunr_index.js"></script>
    <script src="search/lunrclient.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(document).ready(function() {
        $("tr.tree_lvl_1").nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
		$("tr.tree_lvl_1").data("expanded","0");
		$("tr.tree_lvl_2").data("expanded","0");
		$("tr.tree_lvl_3").data("expanded","0");
		$("tr.tree_lvl_4").data("expanded","0");
		$("tr.tree_lvl_5").data("expanded","0");
        $("tr.tree_lvl_1").click(function() {
		    var lvl_1_is_open = $(this).data("expanded");
		    if (lvl_1_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2, tr.tree_lvl_1_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed"); 
				$(this).nextUntil("tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_2,tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_2").click(function() {
		    var lvl_2_is_open = $(this).data("expanded");
		    if (lvl_2_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3, tr.tree_lvl_2_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_3,tr.tree_lvl_4,tr.tree_lvl_5").data("expanded","0");
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_3").click(function() {
		    var lvl_3_is_open = $(this).data("expanded");
		    if (lvl_3_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_3_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).nextUntil("tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_4, tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        });
		$("tr.tree_lvl_4").click(function() {
		    var lvl_4_is_open = $(this).data("expanded");
		    if (lvl_4_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5, tr.tree_lvl_4_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();
                $(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");	
				$(this).nextUntil("tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5").data("expanded","0");				
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
		$("tr.tree_lvl_5").click(function() {
		    var lvl_5_is_open = $(this).data("expanded");
		    if (lvl_5_is_open == "0") {
                $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4,tr.tree_lvl_3,tr.tree_lvl_2,tr.tree_lvl_1,tr.tree_none", "tr.tree_lvl_5_item").show(); 
                $(this).find("span").removeClass("chevron-collapsed").addClass("chevron-expanded");
				$(this).data("expanded","1");
			} else {
			    $(this).nextUntil("tr.tree_lvl_5,tr.tree_lvl_4_item,tr.tree_lvl_4,tr.tree_lvl_3_item,tr.tree_lvl_3,tr.tree_lvl_2_item,tr.tree_lvl_2,tr.tree_lvl_1_item,tr.tree_lvl_1,tr.tree_none").hide();                
				$(this).find("span").removeClass("chevron-expanded").addClass("chevron-collapsed");
				$(this).data("expanded","0");
			    }
        }); 
     }); 
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v5.8.0</span>
   </div>
  </td>
   <td>        <br /><div id="MSearchBox" class="MSearchBoxInactive">
 
    <form id="lunrSearchForm" name="lunrSearchForm">
      <span class="left" >
          <img id="MSearchSelect" src="search/mag_sel.png"
               alt=""/>
         <input class="search-input" id="MSearchField" name="q" placeholder="Search" type="text"> 
      </span>
      <span class="right">
          &nbsp; 
      </span>
        <!--<input type="submit" value="Search">-->
    </form>
</div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_s_i_p___e51_a___p_r_o_t_e_c_t_e_d___c_a_v_p.html','');});
</script>

<script src="search/mark.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() { 
    var options = {         // allows highlighting across element boundaries.
      "acrossElements": true
    };
    var bodyText = $("div.contents").text(); // try contents instead of body. 
    // If using body: Problem may be that text inside <script> tags is included in .text() - but not in cheerio?
    // If using div.contents - works 
    var fullURL = $(location).attr('href');
    var splitURL = fullURL.split("?");  // Get param string: content after "?" in URL
    if (splitURL.length > 1) {          // If any content after "?"
      var paramStr = splitURL[1];
      var params = paramStr.split("&"); // Split params on "&"
      for (i = 0; i < params.length; i++) {
        var paramPair = params[i].split("=");
        if (paramPair[0] == "pos") {     // If any param starts "pos", get the content after "="
          posStr = paramPair[1];
          var splitPos = posStr.split(",");
          var termArray = [];
        // termArray will have the search terms
            for (i=0; i < splitPos.length; i += 2) {
            start = splitPos[i];
            len = splitPos[i+1]; // Needs error detection! Vulnerable if non-even # of pos entries
            term = bodyText.substr(start,len);
            if (termArray.includes(term) == false) {     // List all unique terms
                termArray.push(bodyText.substr(start,len)); 
            }
          } 
    //      console.log(termArray);
          var context = document.querySelector("div.contents");
          var instance = new Mark(context);
          for(i=0;i<termArray.length; i+=1) {
            instance.mark(termArray[i],options);  // Use Mark.js to mark all terms in termArray
            }    
          var firstMark = document.querySelector("mark");
          firstMark.scrollIntoView(true);
          //      console.log($("mark").first().text()); // Trying to scroll to first Mark element. 
        }
            }
    }
  });
</script>

<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />

<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<!-- Lunr search results -->
<div id="lunrResultBox" style="
        position: fixed;
        border: 1px solid black;
        background-color: WhiteSmoke;  
        padding: 10px;
        width: 500px;
        height: 500px;
        top: 30;
        right: 0;
        overflow: auto;
        display: none">
    <button onclick="closeLunrResults()" style="float: right;">X</button>
    <div class="resultCount" id="resultCount"></div>
    <div id="searchResults"></div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Renesas Secure IP (r_rsip_e51a_protected_cavp)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a> &raquo; <a class="el" href="group___r_e_n_e_s_a_s___s_e_c_u_r_i_t_y___m_o_d_u_l_e_s.html">Security</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>Driver for the CAVP Certified Renesas Secure IP (RSIP-E51A) on RA MPUs. This module implements the <a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html">RSIP Interface</a>. </p>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-version"></a>
Version</h1>
<p>v1.5.0</p>
<p>The version that appears on the Components tab of the FSP Configuration editor is v1.5.0+fsp.&lt;fsp_version&gt;. The &lt;fsp_version&gt; metadata reflects tooling support files only and does not indicate any changes to the CAVP certified code. See <a class="el" href="_f_s_p__a_r_c_h_i_t_e_c_t_u_r_e.html#module-versioning">Module Versioning</a> for more information about component versioning in FSP.</p>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-functions"></a>
Functions</h1>
<p>The user documentation for the functions in this module.<br />
</p><ul>
<li><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html">Renesas Secure IP (r_rsip_protected)</a></li>
</ul>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-overview"></a>
Overview</h1>
<p>This module provides RSIP-E51A CAVP Certified functions.</p>
<h2>HW Overview</h2>
<p>RSIP-E51A Protected Mode CAVP certification has been obtained using the RA8M1 as the target processor. </p><table class="doxtable">
<tr>
<th>Crypto Peripheral version </th><th>Devices  </th></tr>
<tr>
<td>RSIP-E51A </td><td>RA8M1, RA8D1, RA8T1 </td></tr>
</table>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-features"></a>
Features</h2>
<p>The RSIP module supports for the following features.</p>
<ul>
<li>Cryptography<ul>
<li>Symmetric Encryption/Decryption<ul>
<li>AES<a class="anchor" id="um_rsip_e51a_protected_cavp_aes"></a><ul>
<li>ECB 128/256bit</li>
<li>CBC 128/256bit</li>
<li>CTR 128/256bit</li>
<li>GCM 128/256bit</li>
<li>CCM 128/256bit</li>
<li>XTS 128/256bit</li>
</ul>
</li>
</ul>
</li>
<li>Asymmetric Encryption/Decryption<ul>
<li>RSA<a class="anchor" id="um_rsip_e51a_protected_cavp_rsa"></a><ul>
<li>RSAES-PKCS1-V1_5 2048/3072/4096bit</li>
<li>RSAES-OAEP 2048/3072/4096bit</li>
<li>RSASSA-PKCS1-V1_5 2048/3072/4096bit</li>
<li>RSASSA-PSS 2048/3072/4096bit</li>
</ul>
</li>
<li>ECC<ul>
<li>ECDSA<a class="anchor" id="um_rsip_e51a_protected_cavp_ecc_ecdsa"></a><ul>
<li>secp256r1/secp384r1/secp521r1</li>
<li>secp256k1</li>
<li>brainpool P256r1/P384r1/P512r1</li>
</ul>
</li>
<li>ECDH<a class="anchor" id="um_rsip_e51a_protected_cavp_ecc_ecdh"></a><ul>
<li>secp256r1/secp384r1/secp521r1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Hash Functions<ul>
<li>SHA-2<ul>
<li>SHA-256/384/512<a class="anchor" id="um_rsip_e51a_protected_cavp_sha"></a></li>
</ul>
</li>
</ul>
</li>
<li>RFC3394 Key Wrap/Unwrap<a class="anchor" id="um_rsip_e51a_protected_cavp_keywrap"></a></li>
</ul>
</li>
<li>Message Authentication Code<ul>
<li>HMAC-SHA256/384/512bit<a class="anchor" id="um_rsip_e51a_protected_cavp_sha_hmac"></a></li>
<li>AES-CMAC 128/256bit</li>
</ul>
</li>
<li>Key Manage<a class="anchor" id="um_rsip_e51a_protected_cavp_key_manage"></a><ul>
<li>Key Support<ul>
<li>AES 128/256bit</li>
<li>RSA 2048/3072/4096bit</li>
<li>ECC<ul>
<li>secp256r1/secp384r1/secp521r1</li>
<li>secp256k1</li>
<li>brainpool P256r1/P384r1/P512r1</li>
</ul>
</li>
<li>HMAC-SHA256/384/512bit</li>
</ul>
</li>
</ul>
</li>
<li>Random Number Generate<a class="anchor" id="um_rsip_e51a_protected_cavp_drbg"></a> </li>
</ul>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-supported-algorithms"></a>
Supported algorithms</h2>
<p>The following algorithms are available on each devices.</p>
<ul>
<li>RSIP-E51A: RA8M1, RA8D1, RA8T1</li>
</ul>
<h3><a class="anchor" id="r-rsip-e51a-protected-cavp-supported-algorithms-symmetric-key"></a>
Symmetric Key</h3>
<table class="doxtable">
<tr>
<th>Key type (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga123baeaebf3b0eb3092b446a3aeed533">rsip_key_type_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a86a9d2eba8d8e913beb35a9ef77719ea">RSIP_KEY_TYPE_AES_128</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a4beb2565f4b4850148f7b01d386486fd">RSIP_KEY_TYPE_XTS_AES_128</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a3f737c0cfc1b94bfdcee4c7e13c29039">RSIP_KEY_TYPE_XTS_AES_256</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533aa0ea2d8e02d46a57d4529a6a823af475">RSIP_KEY_TYPE_HMAC_SHA224</a> </td><td>Not Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ad06544b015f3cb6936a8edb30fd76795">RSIP_KEY_TYPE_HMAC_SHA256</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533abf2c534a5b4e38bdd3e03578026cab80">RSIP_KEY_TYPE_HMAC_SHA384</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac0d24ca2cee6665e07acc3e48d3f176f">RSIP_KEY_TYPE_HMAC_SHA512</a> </td><td>Supported </td></tr>
</table>
<h3><a class="anchor" id="r-rsip-e51a-protected-cavp-supported-algorithms-asymmetric-key"></a>
Asymmetric Key</h3>
<table class="doxtable">
<tr>
<th>Key pair type (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga4ed61c073c7b98245fd8e1c21410b083">rsip_key_pair_type_t</a>) </th><th>Public key type (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga123baeaebf3b0eb3092b446a3aeed533">rsip_key_type_t</a>) </th><th>Private key type (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga123baeaebf3b0eb3092b446a3aeed533">rsip_key_type_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a3509c1b5ab13e53a4cf354b2b1650118">RSIP_KEY_PAIR_TYPE_ECC_SECP256R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a48e3440c58cc26b43b80e4e5470e3d7c">RSIP_KEY_TYPE_ECC_SECP256R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533aa2ac1e64ebfecb3c833d3e65cebe2356">RSIP_KEY_TYPE_ECC_SECP256R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a800470bf58821170f4d1ca0a1e69fc4a">RSIP_KEY_PAIR_TYPE_ECC_SECP384R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a107be1be1d58a60280fabd53ce7346e0">RSIP_KEY_TYPE_ECC_SECP384R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a128974b2708ca0c26fdab1b711760c7c">RSIP_KEY_TYPE_ECC_SECP384R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083aef00b44e30c4afcccb8c5515295e9d2e">RSIP_KEY_PAIR_TYPE_ECC_SECP521R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ab85762518f245876807fd698000e1726">RSIP_KEY_TYPE_ECC_SECP521R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a92e720540b32b7ba8d024726f66477ac">RSIP_KEY_TYPE_ECC_SECP521R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a670e9faa3c490ebaadad9499f05ea582">RSIP_KEY_PAIR_TYPE_ECC_SECP256K1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a6996bc07c13b7000227ac9a8c9184ab7">RSIP_KEY_TYPE_ECC_SECP256K1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533aaafe6f7272586c45d06037755a4e1fdb">RSIP_KEY_TYPE_ECC_SECP256K1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083af618da4a0cf7b6870423dd88c144c04e">RSIP_KEY_PAIR_TYPE_ECC_BRAINPOOLP256R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a0dab958d7e42944db5ae9d3cc6dbb171">RSIP_KEY_TYPE_ECC_BRAINPOOLP256R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533aa1283a39ddf31e2151a858b9adbe33ba">RSIP_KEY_TYPE_ECC_BRAINPOOLP256R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083abce4cdc2b3b2a481fda13a0c71ac3e23">RSIP_KEY_PAIR_TYPE_ECC_BRAINPOOLP384R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533adc74be12d6057717fa42f6aaca9a928a">RSIP_KEY_TYPE_ECC_BRAINPOOLP384R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a450d667fbef7c24a4cb217b8532d62c5">RSIP_KEY_TYPE_ECC_BRAINPOOLP384R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083afa2184274ee180495305104cb5a7a0ab">RSIP_KEY_PAIR_TYPE_ECC_BRAINPOOLP512R1</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a303f33724bf2ddbac8b8a75d28e6d23b">RSIP_KEY_TYPE_ECC_BRAINPOOLP512R1_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533af3fff2339f53b87c403c5d7e5daf2b12">RSIP_KEY_TYPE_ECC_BRAINPOOLP512R1_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083aa0cd2ab30ec0148ad600f992ce927aa3">RSIP_KEY_PAIR_TYPE_RSA_2048</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a42373d227654ba94eaf9bd837915e282">RSIP_KEY_TYPE_RSA_2048_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a5c3eee3902dcd6f2161a40c2b9ff081b">RSIP_KEY_TYPE_RSA_2048_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a4dcc7fec49147dce7515509226eedf6a">RSIP_KEY_PAIR_TYPE_RSA_3072</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a3fb4b7a6660681c87ef8416bc8ef116d">RSIP_KEY_TYPE_RSA_3072_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a19f0822cd6c1399de2bc15e8a46913fe">RSIP_KEY_TYPE_RSA_3072_PRIVATE</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a579b04ccf5fa9a785775229ea6860273">RSIP_KEY_PAIR_TYPE_RSA_4096</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a52e55e5000f62bf6258d188c2c86983d">RSIP_KEY_TYPE_RSA_4096_PUBLIC</a> </td><td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533a58dc7de7d13a8f3b4fa46aac0f637181">RSIP_KEY_TYPE_RSA_4096_PRIVATE</a> </td><td>Supported </td></tr>
</table>
<h3><a class="anchor" id="r-rsip-e51a-protected-cavp-supported-algorithms-aes-mode"></a>
AES Block Cipher Mode of Operation</h3>
<table class="doxtable">
<tr>
<th>Cipher mode (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga7c66b456dbaadee4c68a3afe29f52fc9">rsip_aes_cipher_mode_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a4655147cc61a0a32a9aa8693ad18128b">RSIP_AES_CIPHER_MODE_ECB_ENC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a3d5b122b6aa8dd7520de5e10e9624abb">RSIP_AES_CIPHER_MODE_ECB_DEC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a356b777231c0c4441ae6c19023f55936">RSIP_AES_CIPHER_MODE_CBC_ENC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a01d10224aee2c030ef37eeaee23f1d38">RSIP_AES_CIPHER_MODE_CBC_DEC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9ac0134f0da2a88744fae6c5f06b2a26fb">RSIP_AES_CIPHER_MODE_CTR</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a9df951e82bc8e5574a9f30b29ab1100a">RSIP_AES_CIPHER_MODE_XTS_ENC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a66f7070c99b3243380254ddf0de5baa6">RSIP_AES_CIPHER_MODE_XTS_DEC</a> </td><td>Supported </td></tr>
</table>
<table class="doxtable">
<tr>
<th>AEAD mode (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga245b0a15ea6b2cca7b56224fda3e7522">rsip_aes_aead_mode_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522a1bab5a424536f86e1018a8a7850763e7">RSIP_AES_AEAD_MODE_GCM_ENC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522acfd3da023dadee53250613781a84cdb7">RSIP_AES_AEAD_MODE_GCM_DEC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522ad98f5576a60c4c5670989ec6ccbb9a6a">RSIP_AES_AEAD_MODE_CCM_ENC</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522a469cae63939ce2dae196af69502fd1b7">RSIP_AES_AEAD_MODE_CCM_DEC</a> </td><td>Supported </td></tr>
</table>
<table class="doxtable">
<tr>
<th>MAC mode (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gadccd218cdf9941b64b6b13b949a2985c">rsip_aes_mac_mode_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggadccd218cdf9941b64b6b13b949a2985cae82c4ed8936f022e9bd689f557a6e240">RSIP_AES_MAC_MODE_CMAC</a> </td><td>Supported </td></tr>
</table>
<h3><a class="anchor" id="r-rsip-e51a-protected-cavp-supported-algorithms-hash-function"></a>
Hash Function</h3>
<table class="doxtable">
<tr>
<th>Hash Function (<a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ga3820283ceb2beb99656e71bbb3ba4f89">rsip_hash_type_t</a>) </th><th>RSIP-E51A  </th></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89af64c98e1df3a92f08a6e68b20216b2d2">RSIP_HASH_TYPE_SHA224</a> </td><td>Not Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89a5d99501259f33a56446b2e924bce8dff">RSIP_HASH_TYPE_SHA384</a> </td><td>Supported </td></tr>
<tr>
<td><a class="el" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa3336966c98485838aef21db86b4c9c4">RSIP_HASH_TYPE_SHA512</a> </td><td>Supported </td></tr>
</table>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for r_rsip_e51a_protected_cavp</h2>
The following build time configurations are defined in fsp_cfg/r_rsip_cavp_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> Selection of algorithms to enable  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-128</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-256</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-ECB CBC CTR</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">XTS-AES-128</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">XTS-AES-256</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">XTS-AES</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-GCM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-CCM</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">AES-CMAC</td><td>Enabled</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC SECP256R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC SECP384R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC SECP521R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC SECP256K1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC BRAINPOOLP256R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC BRAINPOOLP384R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">ECC BRAINPOOLP512R1</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">RSA-2048</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">RSA-3072</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">RSA-4096</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-1</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-224</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-256</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-384</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-512</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-512_224</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">SHA-512_256</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">HMAC_SHA1</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">HMAC_SHA224</td><td>Disabled</td><td>Disabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">HMAC_SHA256</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">HMAC_SHA384</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">HMAC_SHA512</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>If the application uses only some of the algorithm in the function, the code size can be reduced by disabling the unused algorithms. This configuration is provided only for the functions for which it works effectively. </td></tr>
<tr class="tree_none">
<td>Parameter Checking</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Default (BSP)</li>
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Default (BSP) </td><td>If selected code for parameter checking is included in the build. </td></tr>
</table>
 <h2>Configurations for Security &gt; RSIP-E51A Protected Mode (CAVP Certified)</h2>
This module can be added to the Stacks tab via New Stack &gt; Security &gt; RSIP-E51A Protected Mode (CAVP Certified).<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr class="tree_lvl_1">
<td class="tree_lvl_1" colspan="4"><span class="chevron-collapsed"></span> General  </td></tr>
<tr class="tree_lvl_1_item">
<td class="tree_lvl_1_cell">Name</td><td>Name must be a valid C symbol</td><td>g_rsip </td><td>Module name. </td></tr>
</table>
</p>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-clock-configuration"></a>
Clock Configuration</h2>
<p>This module does not require a specific clock configuration.</p>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-pin-configuration"></a>
Pin Configuration</h2>
<p>This module does not use I/O pins.</p>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-usage_notes"></a>
Usage Notes</h1>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-getting-started"></a>
Getting Started: Creating a RSIP Protected Mode Project</h2>
<p>Start by creating a new project in e&sup2; studio or RASC. On the Stacks tab, add New &gt; Security &gt; RSIP-E51A Protected Mode (CAVP Certified).</p>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-state-transition"></a>
State Transition</h2>
<p>This driver has the following states.</p>
<table class="doxtable">
<tr>
<th>State Name </th><th>Details  </th></tr>
<tr>
<td>STATE_INITIAL </td><td>Driver is not open. </td></tr>
<tr>
<td>STATE_MAIN </td><td>Ready to Compute. </td></tr>
<tr>
<td>STATE_AES </td><td>Computing AES (unauthenticated cipher) </td></tr>
<tr>
<td>STATE_AES_AEAD </td><td>Computing AES (AEAD). </td></tr>
<tr>
<td>STATE_AES_MAC </td><td>Computing AES (MAC). </td></tr>
<tr>
<td>STATE_SHA </td><td>Computing SHA. </td></tr>
<tr>
<td>STATE_HMAC </td><td>Computing HMAC. </td></tr>
<tr>
<td>STATE_KDF_HMAC </td><td>Computing KDF HMAC. </td></tr>
</table>
<p>There are two types of APIs provided by the RSIP driver for accelerating cryptographic operations: those that provide cryptographic operations in a single API and those that provide them in multiple APIs. In this document, the former is referred to as single-part operations and the latter as multi-part operations. Each corresponds to the following algorithms:</p>
<ul>
<li>Single-part operations: DRBG, Key management, ECC, RSA, SHA, HMAC</li>
<li>Multi-part operations: AES, SHA, HMAC</li>
</ul>
<p>Multi-part operations are APIs which split a single cryptographic operation into a sequence of separate steps (e.g. Init-Update-Finish). This enables fine control over the configuration of the cryptographic operation, and allows the message data to be processed in fragments instead of all at once.</p>
<p>Due to the above characteristics, it is necessary to manage the operational states in the multi-part operations.</p>
<h1><a class="anchor" id="r-rsip-e51a-protected-cavp-examples"></a>
Examples</h1>
<h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-aes"></a>
AES cipher Example</h2>
<p>This is an example of AES-CBC encryption/decryption.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_aes ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>            err;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t plain[RSIP_PRV_BYTE_SIZE_AES_BLOCK * 2] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x52, 0x65, 0x6e, 0x65, 0x73, 0x61, 0x73, 0x20, 0x45, 0x6c, 0x65, 0x63, 0x74, 0x72, 0x6f, 0x6e,</div><div class="line">        0x69, 0x63, 0x73, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x00</div><div class="line">    };</div><div class="line"></div><div class="line">    uint8_t iv[RSIP_PRV_BYTE_SIZE_AES_BLOCK] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t cipher_calculated[RSIP_PRV_BYTE_SIZE_AES_BLOCK * 2] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t plain_calculated[RSIP_PRV_BYTE_SIZE_AES_BLOCK * 2]  BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235acc7cfcba1a5e5944e566276062d4ff54">RSIP_BYTE_SIZE_WRAPPED_KEY_AES_256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a aes 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a nonce */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga004e5a8c7361e446809f4cba8fb4a493">R_RSIP_RandomNumberGenerate</a>(&amp;g_rsip_ctrl, iv);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plaintext */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6d1e1bf59e74091501ab2fb9966bd9bd">R_RSIP_AES_Cipher_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a356b777231c0c4441ae6c19023f55936">RSIP_AES_CIPHER_MODE_CBC_ENC</a>, p_wrapped_key, iv);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8890be1a775477f1b77ec2b7fb64d5fc">R_RSIP_AES_Cipher_Update</a>(&amp;g_rsip_ctrl, plain, cipher_calculated, RSIP_PRV_BYTE_SIZE_AES_BLOCK * 2);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga1bcde7066a27a84d804a806762be64a7">R_RSIP_AES_Cipher_Finish</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a ciphertext using the same key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6d1e1bf59e74091501ab2fb9966bd9bd">R_RSIP_AES_Cipher_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga7c66b456dbaadee4c68a3afe29f52fc9a01d10224aee2c030ef37eeaee23f1d38">RSIP_AES_CIPHER_MODE_CBC_DEC</a>, p_wrapped_key, iv);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8890be1a775477f1b77ec2b7fb64d5fc">R_RSIP_AES_Cipher_Update</a>(&amp;g_rsip_ctrl, cipher_calculated, plain_calculated, RSIP_PRV_BYTE_SIZE_AES_BLOCK);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8890be1a775477f1b77ec2b7fb64d5fc">R_RSIP_AES_Cipher_Update</a>(&amp;g_rsip_ctrl,</div><div class="line">                                   cipher_calculated + RSIP_PRV_BYTE_SIZE_AES_BLOCK,</div><div class="line">                                   plain_calculated + RSIP_PRV_BYTE_SIZE_AES_BLOCK,</div><div class="line">                                   RSIP_PRV_BYTE_SIZE_AES_BLOCK);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga1bcde7066a27a84d804a806762be64a7">R_RSIP_AES_Cipher_Finish</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare plain and plain_calculated */</span></div><div class="line">    assert(0 == memcmp(plain, plain_calculated, RSIP_PRV_BYTE_SIZE_AES_BLOCK * 2));</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-gcm"></a>
AES-GCM Example</h2>
<p>This is an example of AES-GCM encryption/decryption.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define GCM_BLOCK_LEN    (16)</span></div><div class="line"><span class="preprocessor">#define GCM_TEXT_LEN     (31)</span></div><div class="line"><span class="preprocessor">#define GCM_NONCE_LEN    (12)</span></div><div class="line"><span class="preprocessor">#define GCM_AAD_LEN      (8)</span></div><div class="line"><span class="preprocessor">#define GCM_TAG_LEN      (8)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_gcm ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a>            err;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t plain[GCM_TEXT_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x52, 0x65, 0x6e, 0x65, 0x73, 0x61, 0x73, 0x20, 0x45, 0x6c, 0x65, 0x63, 0x74, 0x72, 0x6f, 0x6e,</div><div class="line">        0x69, 0x63, 0x73, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e,</div><div class="line">    };</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t aad[GCM_AAD_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07</div><div class="line">    };</div><div class="line"></div><div class="line">    uint8_t  nonce[GCM_BLOCK_LEN] BSP_ALIGN_VARIABLE(4)                 = {0};</div><div class="line">    uint8_t  tag[GCM_BLOCK_LEN] BSP_ALIGN_VARIABLE(4)                   = {0};</div><div class="line">    uint8_t  cipher_calculated[GCM_BLOCK_LEN * 2] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t  plain_calculated[GCM_BLOCK_LEN * 2] BSP_ALIGN_VARIABLE(4)  = {0};</div><div class="line">    uint32_t input_length      = 0;</div><div class="line">    uint32_t output_length     = 0;</div><div class="line">    uint32_t input_length_tmp  = 0;</div><div class="line">    uint32_t output_length_tmp = 0;</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235acc7cfcba1a5e5944e566276062d4ff54">RSIP_BYTE_SIZE_WRAPPED_KEY_AES_256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a aes 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a nonce */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga004e5a8c7361e446809f4cba8fb4a493">R_RSIP_RandomNumberGenerate</a>(&amp;g_rsip_ctrl, nonce);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plaintext */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522a1bab5a424536f86e1018a8a7850763e7">RSIP_AES_AEAD_MODE_GCM_ENC</a>, p_wrapped_key, nonce, GCM_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, aad, GCM_AAD_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input plaintext (one-shot) */</span></div><div class="line">    err            = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga93cd87b9549f0642f2f324c2148f427b">R_RSIP_AES_AEAD_Update</a>(&amp;g_rsip_ctrl, plain, GCM_TEXT_LEN, cipher_calculated, &amp;output_length_tmp);</div><div class="line">    output_length += output_length_tmp;</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Output remaining text and generate a tag */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga921493392513ac29379f71d7d229c6f1">R_RSIP_AES_AEAD_Finish</a>(&amp;g_rsip_ctrl, cipher_calculated + output_length, &amp;output_length_tmp, tag);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a ciphertext using the same key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522acfd3da023dadee53250613781a84cdb7">RSIP_AES_AEAD_MODE_GCM_DEC</a>, p_wrapped_key, nonce, GCM_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, aad, GCM_AAD_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    input_length  = 0;</div><div class="line">    output_length = 0;</div><div class="line"></div><div class="line">    <span class="comment">/* Input ciphertext (multi-shot) */</span></div><div class="line">    input_length_tmp = 10;</div><div class="line">    err              = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga93cd87b9549f0642f2f324c2148f427b">R_RSIP_AES_AEAD_Update</a>(&amp;g_rsip_ctrl,</div><div class="line">                                              cipher_calculated + input_length,</div><div class="line">                                              input_length_tmp,</div><div class="line">                                              plain_calculated + output_length,</div><div class="line">                                              &amp;output_length_tmp);</div><div class="line">    input_length  += input_length_tmp;</div><div class="line">    output_length += output_length_tmp;</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    input_length_tmp = GCM_TEXT_LEN - input_length;</div><div class="line">    err              = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga93cd87b9549f0642f2f324c2148f427b">R_RSIP_AES_AEAD_Update</a>(&amp;g_rsip_ctrl,</div><div class="line">                                              cipher_calculated + input_length,</div><div class="line">                                              input_length_tmp,</div><div class="line">                                              plain_calculated + output_length,</div><div class="line">                                              &amp;output_length_tmp);</div><div class="line">    input_length  += input_length_tmp;</div><div class="line">    output_length += output_length_tmp;</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * Output remaining text and verify the tag</span></div><div class="line"><span class="comment">     * Attention: Do not use the output plaintext by R_RSIP_AES_Cipher_DecryptUpdate()</span></div><div class="line"><span class="comment">     * before R_RSIP_AES_Cipher_DecryptFinal() returns FSP_SUCCESS.</span></div><div class="line"><span class="comment">     * The integrity is checked in this function.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2457eb05ec376f7d7aca17c93e626eeb">R_RSIP_AES_AEAD_Verify</a>(&amp;g_rsip_ctrl, plain_calculated + output_length, &amp;output_length_tmp, tag, GCM_TAG_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare plain and plain_calculated */</span></div><div class="line">    assert(0 == memcmp(plain, plain_calculated, GCM_TEXT_LEN));</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-gmac"></a>
AES-GMAC Example</h2>
<p>This is an example of AES-GMAC signature/verification.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define GMAC_NONCE_LEN    (12)</span></div><div class="line"><span class="preprocessor">#define GMAC_AAD_LEN      (8)</span></div><div class="line"><span class="preprocessor">#define GMAC_TAG_LEN      (16)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_gmac ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t aad[GMAC_AAD_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07</div><div class="line">    };</div><div class="line"></div><div class="line">    uint8_t  nonce[GMAC_NONCE_LEN] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t  tag[GMAC_TAG_LEN] BSP_ALIGN_VARIABLE(4)     = {0};</div><div class="line">    uint8_t  output_dummy_buf[1]                         = {0};</div><div class="line">    uint32_t output_length                               = 0;</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235acc7cfcba1a5e5944e566276062d4ff54">RSIP_BYTE_SIZE_WRAPPED_KEY_AES_256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a aes 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a nonce */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga004e5a8c7361e446809f4cba8fb4a493">R_RSIP_RandomNumberGenerate</a>(&amp;g_rsip_ctrl, nonce);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize GMAC signature */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522a1bab5a424536f86e1018a8a7850763e7">RSIP_AES_AEAD_MODE_GCM_ENC</a>, p_wrapped_key, nonce, GMAC_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, aad, GMAC_AAD_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Finalize GMAC generation */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga921493392513ac29379f71d7d229c6f1">R_RSIP_AES_AEAD_Finish</a>(&amp;g_rsip_ctrl, output_dummy_buf, &amp;output_length, tag);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/*Initialize GMAC verification*/</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522acfd3da023dadee53250613781a84cdb7">RSIP_AES_AEAD_MODE_GCM_DEC</a>, p_wrapped_key, nonce, GMAC_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, aad, GMAC_AAD_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Finalize GMAC verification*/</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2457eb05ec376f7d7aca17c93e626eeb">R_RSIP_AES_AEAD_Verify</a>(&amp;g_rsip_ctrl, output_dummy_buf, &amp;output_length, tag, GMAC_TAG_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-ccm"></a>
AES-CCM Example</h2>
<p>This is an example of AES-CCM encryption/decryption.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define CCM_NONCE_LEN         (12)</span></div><div class="line"><span class="preprocessor">#define CCM_ADATA_LEN         (20)</span></div><div class="line"><span class="preprocessor">#define CCM_INPUT_DATA_LEN    (24)</span></div><div class="line"><span class="preprocessor">#define CCM_MAC_LEN           (8)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_ccm ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t nonce[CCM_NONCE_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B};</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t adata[CCM_ADATA_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,</div><div class="line">        0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10, 0x11, 0x12, 0x13</div><div class="line">    };</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t plain[CCM_INPUT_DATA_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29,</div><div class="line">        0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F, 0x30, 0x31, 0x32, 0x33,</div><div class="line">        0x34, 0x35, 0x36, 0x37</div><div class="line">    };</div><div class="line"></div><div class="line">    uint8_t   cipher_calculated[CCM_INPUT_DATA_LEN * 2] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t   plain_calculated[CCM_INPUT_DATA_LEN * 2] BSP_ALIGN_VARIABLE(4)  = {0};</div><div class="line">    uint8_t   mac[CCM_MAC_LEN] BSP_ALIGN_VARIABLE(4)                          = {0};</div><div class="line">    uint32_t  output_length_tmp                                               = 0;</div><div class="line">    uint8_t * p_output                                                        = NULL;</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235acc7cfcba1a5e5944e566276062d4ff54">RSIP_BYTE_SIZE_WRAPPED_KEY_AES_256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a aes 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plaintext */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522ad98f5576a60c4c5670989ec6ccbb9a6a">RSIP_AES_AEAD_MODE_CCM_ENC</a>, p_wrapped_key, nonce, CCM_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Set text and tag length. */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gab2032f95ca00ce78a703e5c546aa051c">R_RSIP_AES_AEAD_LengthsSet</a>(&amp;g_rsip_ctrl, CCM_ADATA_LEN, CCM_INPUT_DATA_LEN, CCM_MAC_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, adata, CCM_ADATA_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input plaintext */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga93cd87b9549f0642f2f324c2148f427b">R_RSIP_AES_AEAD_Update</a>(&amp;g_rsip_ctrl, plain, CCM_INPUT_DATA_LEN, cipher_calculated, &amp;output_length_tmp);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    p_output = &amp;(cipher_calculated[output_length_tmp]);</div><div class="line"></div><div class="line">    <span class="comment">/* Output remaining text and generate a tag */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga921493392513ac29379f71d7d229c6f1">R_RSIP_AES_AEAD_Finish</a>(&amp;g_rsip_ctrl, p_output, &amp;output_length_tmp, mac);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a ciphertext using the same key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga6e031d3978cadcdaf691cefbaadcfcf8">R_RSIP_AES_AEAD_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga245b0a15ea6b2cca7b56224fda3e7522a469cae63939ce2dae196af69502fd1b7">RSIP_AES_AEAD_MODE_CCM_DEC</a>, p_wrapped_key, nonce, CCM_NONCE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Set text and tag length. */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gab2032f95ca00ce78a703e5c546aa051c">R_RSIP_AES_AEAD_LengthsSet</a>(&amp;g_rsip_ctrl, CCM_ADATA_LEN, CCM_INPUT_DATA_LEN, CCM_MAC_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input AAD */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4468ffdd2b83785f74e565394b686f45">R_RSIP_AES_AEAD_AADUpdate</a>(&amp;g_rsip_ctrl, adata, CCM_ADATA_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input plaintext */</span></div><div class="line"></div><div class="line">    <span class="comment">// err = R_RSIP_AES_AEAD_Update(&amp;g_rsip_ctrl, plain, CCM_INPUT_DATA_LEN, plain_calculated, &amp;output_length_tmp);</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga93cd87b9549f0642f2f324c2148f427b">R_RSIP_AES_AEAD_Update</a>(&amp;g_rsip_ctrl,</div><div class="line">                                 cipher_calculated,</div><div class="line">                                 CCM_INPUT_DATA_LEN,</div><div class="line">                                 plain_calculated,</div><div class="line">                                 &amp;output_length_tmp);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">    p_output = &amp;(plain_calculated[output_length_tmp]);</div><div class="line"></div><div class="line">    <span class="comment">/* Output remaining text and verify the tag */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2457eb05ec376f7d7aca17c93e626eeb">R_RSIP_AES_AEAD_Verify</a>(&amp;g_rsip_ctrl, p_output, &amp;output_length_tmp, mac, CCM_MAC_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-cmac"></a>
AES-CMAC Example</h2>
<p>This is an example of AES-CMAC signature/verification.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define CMAC_MESSAGE_LEN    (10)</span></div><div class="line"><span class="preprocessor">#define CMAC_MAC_LEN        (16)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_cmac ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t message[CMAC_MESSAGE_LEN] BSP_ALIGN_VARIABLE(4) = {0xf0, 0x8f, 0x89, 0x08, 0x75, 0xe1, 0x39, 0x48, 0x04, 0x89};</div><div class="line"></div><div class="line">    uint8_t mac[CMAC_MAC_LEN] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235acc7cfcba1a5e5944e566276062d4ff54">RSIP_BYTE_SIZE_WRAPPED_KEY_AES_256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a aes 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ac73d8d9299a235cdd03315cc8d4cf10c">RSIP_KEY_TYPE_AES_256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* CMAC initialize for encrypt */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga83401019c81ec83aa6136aa68f3d0969">R_RSIP_AES_MAC_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggadccd218cdf9941b64b6b13b949a2985cae82c4ed8936f022e9bd689f557a6e240">RSIP_AES_MAC_MODE_CMAC</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input message */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gae455be55ddb6f75aafc1ced23bc06bb5">R_RSIP_AES_MAC_Update</a>(&amp;g_rsip_ctrl, message, CMAC_MESSAGE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Output remaining text and generate a tag */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac8350b33f0576e1725fb737e987c37c4">R_RSIP_AES_MAC_SignFinish</a>(&amp;g_rsip_ctrl, mac);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* CMAC initialize for decrypt */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga83401019c81ec83aa6136aa68f3d0969">R_RSIP_AES_MAC_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggadccd218cdf9941b64b6b13b949a2985cae82c4ed8936f022e9bd689f557a6e240">RSIP_AES_MAC_MODE_CMAC</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Input message */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gae455be55ddb6f75aafc1ced23bc06bb5">R_RSIP_AES_MAC_Update</a>(&amp;g_rsip_ctrl, message, CMAC_MESSAGE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the tag */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga03a14baf02e7c3d714930361e384d43b">R_RSIP_AES_MAC_VerifyFinish</a>(&amp;g_rsip_ctrl, mac, CMAC_MAC_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-ecc"></a>
ECC Example</h2>
<p>This is an example of ECDSA signature generation/verification.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define SECP256R1_KEY_SIZE    (32)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_ecc ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t message[] BSP_ALIGN_VARIABLE(4) = <span class="stringliteral">&quot;sample&quot;</span>;</div><div class="line"></div><div class="line">    uint8_t hash[SECP256R1_KEY_SIZE] BSP_ALIGN_VARIABLE(4)          = {0};</div><div class="line">    uint8_t signature[SECP256R1_KEY_SIZE * 2] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_public_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235ac452e3e78ca6a66d2bbad44b88c6b2cb">RSIP_BYTE_SIZE_WRAPPED_KEY_ECC_SECP256R1_PUBLIC</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    uint8_t              wrapped_private_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235ae40b3553b653c9ceaa574cc81a2c5719">RSIP_BYTE_SIZE_WRAPPED_KEY_ECC_SECP256R1_PRIVATE</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_public_key  = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_public_key;</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_private_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_private_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a key pair of secp256r1 */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gacbc429a31f21d4a409d40ef7c8704c96">R_RSIP_KeyPairGenerate</a>(&amp;g_rsip_ctrl,</div><div class="line">                                 <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083a3509c1b5ab13e53a4cf354b2b1650118">RSIP_KEY_PAIR_TYPE_ECC_SECP256R1</a>,</div><div class="line">                                 p_wrapped_public_key,</div><div class="line">                                 p_wrapped_private_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the message hash */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8517124a32ed6bea90f2d0c82885eed7">R_RSIP_SHA_Compute</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>, message, <span class="keyword">sizeof</span>(message), hash);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the signature */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga51b427c5ed2f8d2980d6c29a68951f3c">R_RSIP_ECDSA_Sign</a>(&amp;g_rsip_ctrl, p_wrapped_private_key, hash, signature);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature*/</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga4001cf997810be799f9873f7f19f515c">R_RSIP_ECDSA_Verify</a>(&amp;g_rsip_ctrl, p_wrapped_public_key, hash, signature);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-rsa"></a>
RSA Example</h2>
<p>This is an example of RSA encryption/decryption (RSAES-OAEP) and RSA signature generation/verification (RSASSA-PSS).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define SHA256_HASH_SIZE     (32)</span></div><div class="line"><span class="preprocessor">#define RSA_2048_KEY_SIZE    (256)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_rsa ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t message[] BSP_ALIGN_VARIABLE(4) = <span class="stringliteral">&quot;sample&quot;</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t label[] BSP_ALIGN_VARIABLE(4)   = <span class="stringliteral">&quot;label&quot;</span>;</div><div class="line"></div><div class="line">    uint8_t  cipher_calculated[RSA_2048_KEY_SIZE] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t  plain_calculated[RSA_2048_KEY_SIZE] BSP_ALIGN_VARIABLE(4)  = {0};</div><div class="line">    uint32_t plain_calculated_length                                    = 0;</div><div class="line">    uint8_t  hash[SHA256_HASH_SIZE] BSP_ALIGN_VARIABLE(4)               = {0};</div><div class="line">    uint8_t  signature[RSA_2048_KEY_SIZE] BSP_ALIGN_VARIABLE(4)         = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_public_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235ad099a7dfd6a0563b3cb22778395075b4">RSIP_BYTE_SIZE_WRAPPED_KEY_RSA_2048_PUBLIC</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    uint8_t              wrapped_private_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235a1ba4097e9e7f15e1f2ad11e22c1bfe36">RSIP_BYTE_SIZE_WRAPPED_KEY_RSA_2048_PRIVATE</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_public_key  = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_public_key;</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_private_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_private_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a key pair of RSA-2048 */</span></div><div class="line">    err =</div><div class="line">        <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gacbc429a31f21d4a409d40ef7c8704c96">R_RSIP_KeyPairGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga4ed61c073c7b98245fd8e1c21410b083aa0cd2ab30ec0148ad600f992ce927aa3">RSIP_KEY_PAIR_TYPE_RSA_2048</a>, p_wrapped_public_key, p_wrapped_private_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * RSAES-OAEP</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Encrypt a plaintext */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga1e2bb479037a936aac115f73fcc6788f">R_RSIP_RSAES_OAEP_Encrypt</a>(&amp;g_rsip_ctrl,</div><div class="line">                                    p_wrapped_public_key,</div><div class="line">                                    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>,</div><div class="line">                                    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggaed858ab9713b13797a5e7e50589fbf52a706f017dd80223a4b21e3344a81b8188">RSIP_MGF_TYPE_MGF1_SHA256</a>,</div><div class="line">                                    label,</div><div class="line">                                    <span class="keyword">sizeof</span>(label),</div><div class="line">                                    message,</div><div class="line">                                    <span class="keyword">sizeof</span>(message),</div><div class="line">                                    cipher_calculated);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Decrypt a ciphertext using the same key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga212e1d21390f8ea72bd91c844375399f">R_RSIP_RSAES_OAEP_Decrypt</a>(&amp;g_rsip_ctrl,</div><div class="line">                                    p_wrapped_private_key,</div><div class="line">                                    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>,</div><div class="line">                                    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggaed858ab9713b13797a5e7e50589fbf52a706f017dd80223a4b21e3344a81b8188">RSIP_MGF_TYPE_MGF1_SHA256</a>,</div><div class="line">                                    label,</div><div class="line">                                    <span class="keyword">sizeof</span>(label),</div><div class="line">                                    cipher_calculated,</div><div class="line">                                    plain_calculated,</div><div class="line">                                    &amp;plain_calculated_length,</div><div class="line">                                    <span class="keyword">sizeof</span>(plain_calculated));</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Verify calculated plaintext */</span></div><div class="line">    assert(<span class="keyword">sizeof</span>(message) == plain_calculated_length);</div><div class="line">    assert(0 == memcmp(message, plain_calculated, plain_calculated_length));</div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * RSASSA-PSS</span></div><div class="line"><span class="comment">     */</span></div><div class="line"></div><div class="line">    <span class="comment">/* Generate the message hash */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8517124a32ed6bea90f2d0c82885eed7">R_RSIP_SHA_Compute</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>, message, <span class="keyword">sizeof</span>(message), hash);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the signature */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gabe59603c1aaaab0ba9f92cd2dcc45748">R_RSIP_RSASSA_PSS_Sign</a>(&amp;g_rsip_ctrl,</div><div class="line">                                 p_wrapped_private_key,</div><div class="line">                                 <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>,</div><div class="line">                                 <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggaed858ab9713b13797a5e7e50589fbf52a706f017dd80223a4b21e3344a81b8188">RSIP_MGF_TYPE_MGF1_SHA256</a>,</div><div class="line">                                 <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga25b0d42a8c06f2010d6f6561e1bc3ad6af85df0509e6d214fa15a0aaccd9e9745">RSIP_RSA_SALT_LENGTH_AUTO</a>,</div><div class="line">                                 hash,</div><div class="line">                                 signature);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Verify the signature*/</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gaf98dfd64d040136e639ce594a2cdc01c">R_RSIP_RSASSA_PSS_Verify</a>(&amp;g_rsip_ctrl,</div><div class="line">                                   p_wrapped_public_key,</div><div class="line">                                   <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>,</div><div class="line">                                   <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#ggaed858ab9713b13797a5e7e50589fbf52a706f017dd80223a4b21e3344a81b8188">RSIP_MGF_TYPE_MGF1_SHA256</a>,</div><div class="line">                                   <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga25b0d42a8c06f2010d6f6561e1bc3ad6af85df0509e6d214fa15a0aaccd9e9745">RSIP_RSA_SALT_LENGTH_AUTO</a>,</div><div class="line">                                   hash,</div><div class="line">                                   signature);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-hash"></a>
HASH Example</h2>
<p>This is an example of calculating the SHA-256 message digest.</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#define SHA256_HASH_SIZE    (32)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_hash ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t message[] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div><div class="line">        0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,</div><div class="line">    };</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t hash[] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x63, 0x0d, 0xcd, 0x29, 0x66, 0xc4, 0x33, 0x66, 0x91, 0x12, 0x54, 0x48, 0xbb, 0xb2, 0x5b, 0x4f,</div><div class="line">        0xf4, 0x12, 0xa4, 0x9c, 0x73, 0x2d, 0xb2, 0xc8, 0xab, 0xc1, 0xb8, 0x58, 0x1b, 0xd7, 0x10, 0xdd</div><div class="line">    };</div><div class="line"></div><div class="line">    uint8_t digest_single[SHA256_HASH_SIZE] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t digest_multi[SHA256_HASH_SIZE] BSP_ALIGN_VARIABLE(4)  = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* (1) Calculate SHA-256 digests with single-part API */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga8517124a32ed6bea90f2d0c82885eed7">R_RSIP_SHA_Compute</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>, message, <span class="keyword">sizeof</span>(message), digest_single);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare digest and hash */</span></div><div class="line">    assert(0 == memcmp(digest_single, hash, SHA256_HASH_SIZE));</div><div class="line"></div><div class="line">    <span class="comment">/* (2) Calculate SHA-256 digests with multi-part API */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga70236a428848b22141eff00c1439b69f">R_RSIP_SHA_Init</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga3820283ceb2beb99656e71bbb3ba4f89aa9b386d1b29869e511efd8d28f95cf06">RSIP_HASH_TYPE_SHA256</a>);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga012783c5832bd6d30c67171c4d2dcbc2">R_RSIP_SHA_Update</a>(&amp;g_rsip_ctrl, message, <span class="keyword">sizeof</span>(message));</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga02b7c3b4bcb40220b3517994917c1f50">R_RSIP_SHA_Finish</a>(&amp;g_rsip_ctrl, digest_multi);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare digest and hash */</span></div><div class="line">    assert(0 == memcmp(digest_multi, hash, SHA256_HASH_SIZE));</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="r-rsip-e51a-protected-cavp-examples-hmac"></a>
HMAC Example</h2>
<p>This is an example of HMAC signature/verification.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define HMAC_MESSAGE_LEN    (34)</span></div><div class="line"><span class="preprocessor">#define HMAC_HASH_LEN       (32)</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> r_rsip_example_hmac ()</div><div class="line">{</div><div class="line">    <a class="code" href="group___r_e_n_e_s_a_s___e_r_r_o_r___c_o_d_e_s.html#gadfb1288da0fcc7ae1dc88c58601374f8">fsp_err_t</a> err;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> uint8_t message[HMAC_MESSAGE_LEN] BSP_ALIGN_VARIABLE(4) =</div><div class="line">    {</div><div class="line">        0x53, 0x61, 0x6D, 0x70, 0x6C, 0x65, 0x20, 0x6D,</div><div class="line">        0x65, 0x73, 0x73, 0x61, 0x67, 0x65, 0x20, 0x66,</div><div class="line">        0x6F, 0x72, 0x20, 0x6B, 0x65, 0x79, 0x6C, 0x65,</div><div class="line">        0x6E, 0x3C, 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x6C,</div><div class="line">        0x65, 0x6E</div><div class="line">    };</div><div class="line">    uint8_t hash_1[HMAC_HASH_LEN] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line">    uint8_t hash_2[HMAC_HASH_LEN] BSP_ALIGN_VARIABLE(4) = {0};</div><div class="line"></div><div class="line">    <span class="comment">/* Prepare wrapped key data area */</span></div><div class="line">    uint8_t              wrapped_key[<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga385f2388cc3e87db6a1f385351b47235ad302f44eb6bb360373f2c52ce0172993">RSIP_BYTE_SIZE_WRAPPED_KEY_HMAC_SHA256</a>] BSP_ALIGN_VARIABLE(4);</div><div class="line">    <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> * p_wrapped_key = (<a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#structrsip__wrapped__key__t">rsip_wrapped_key_t</a> *) wrapped_key;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga0f3222e34aedf16a9eeba214db0aeeac">R_RSIP_Open</a>(&amp;g_rsip_ctrl, &amp;g_rsip_cfg);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Generate a HMAC-SHA 256-bit key */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga2dc3a8de5422978d001750fa120df176">R_RSIP_KeyGenerate</a>(&amp;g_rsip_ctrl, <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d___a_p_i.html#gga123baeaebf3b0eb3092b446a3aeed533ad06544b015f3cb6936a8edb30fd76795">RSIP_KEY_TYPE_HMAC_SHA256</a>, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* (1) Calculate HMAC-SHA-256 hash with single-part API */</span></div><div class="line">    <span class="comment">/* HMAC initialize to finish */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gafd208f1c55bdd1e5c6f6ef8e09f61e3f">R_RSIP_HMAC_Compute</a>(&amp;g_rsip_ctrl, p_wrapped_key, message, HMAC_MESSAGE_LEN, hash_1);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* (2) Verify HMAC-SHA-256 hash with single-part API */</span></div><div class="line">    <span class="comment">/* HMAC initialize to verify */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga601bce8a7997bfad866e278d1b0133c4">R_RSIP_HMAC_Verify</a>(&amp;g_rsip_ctrl, p_wrapped_key, message, HMAC_MESSAGE_LEN, hash_1, HMAC_HASH_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* (3) Calculate HMAC-SHA-256 hash with multi-part API */</span></div><div class="line">    <span class="comment">/* HMAC initialize */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gae4cd917f80c66afaab97ec0590a3dd4a">R_RSIP_HMAC_Init</a>(&amp;g_rsip_ctrl, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Inputs message */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gaa4b5a4977424dedf43dc3470f5ccb6c5">R_RSIP_HMAC_Update</a>(&amp;g_rsip_ctrl, message, HMAC_MESSAGE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Finalizes a HMAC generation */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga5aa0d78a4d2f6b29da5fa7f96ce09e3a">R_RSIP_HMAC_SignFinish</a>(&amp;g_rsip_ctrl, hash_2);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* (4) Verify HMAC-SHA-256 hash with multi-part API */</span></div><div class="line">    <span class="comment">/* HMAC initialize */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gae4cd917f80c66afaab97ec0590a3dd4a">R_RSIP_HMAC_Init</a>(&amp;g_rsip_ctrl, p_wrapped_key);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Inputs message */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gaa4b5a4977424dedf43dc3470f5ccb6c5">R_RSIP_HMAC_Update</a>(&amp;g_rsip_ctrl, message, HMAC_MESSAGE_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Finalizes a HMAC verification */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#ga19c282224fe07a16cebefab86f14ac6e">R_RSIP_HMAC_VerifyFinish</a>(&amp;g_rsip_ctrl, hash_2, HMAC_HASH_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Close the driver */</span></div><div class="line">    err = <a class="code" href="group___r_s_i_p___p_r_o_t_e_c_t_e_d.html#gac7848f48d9f8484cb17e156e299046fe">R_RSIP_Close</a>(&amp;g_rsip_ctrl);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line"></div><div class="line">    <span class="comment">/* Compare hash_1 and hash_2 */</span></div><div class="line">    err = memcmp(hash_1, hash_2, HMAC_HASH_LEN);</div><div class="line">    assert(FSP_SUCCESS == err);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v5.8.0 User's Manual Copyright  (2025) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
